{
  "title": "strncpy和strcpy(被遗忘的角落)",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"color: rgb(0, 0, 0); line-height: 1.7; font-size: 14px; font-family: arial;\"><div class=\"multicntwrap\" style=\"color: rgb(76, 76, 76); font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 12px; line-height: normal; background-color: rgb(246, 246, 246);\"><div class=\"multicnt\"><h3 class=\"title pre fs1\" style=\"overflow: hidden; word-wrap: break-word; word-break: break-all; font-size: 16px; margin: 34px 0px 10px; padding: 0px;\"><span style=\"font-family: arial, simsun;\">在C环境下经常用到的strcpy和strncpy, 不要以为strncpy只比strcpy多了一个限制复制字符的个数。</span><br></h3></div></div><div class=\"bct fc05 fc11 nbw-blog ztag\" data-find=\"_3\" style=\"line-height: 28px; font-size: 16px; word-wrap: break-word; color: rgb(76, 76, 76); margin: 15px 0px; padding: 5px 0px; overflow: hidden; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; background-color: rgb(246, 246, 246);\"><span style=\"line-height: 21px; font-family: arial, simsun;\">char * strncpy(char *s1,char *s2,size_t n);<br _extended=\"true\" style=\"line-height: 28px;\">将字符串s2中最多n个字符复制到字符数组s1中，返回指向s1的指针。<br _extended=\"true\" style=\"line-height: 28px;\">注意：如果源串长度大于n，则strncpy不复制最后的'\\0'结束符，所以是不安全的，复制完后需要手动添加字符串的结束符才行。</span><div data-find=\"_2\"><span data-find=\"_1\" style=\"line-height: 21px; font-family: arial, simsun;\"><hr style=\"line-height: 28px;\">Strcpy和Strncpy的区别- -&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">第一种情况：&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">char* p=\"how are you ?\";&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">char name[20]=\"ABCDEFGHIJKLMNOPQRS\";&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">strcpy(name,p); //name改变为\"how are you ? \"====&gt;正确！&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">strncpy(name,p,sizeof(name)); //name改变为\"how are you ? \" ====&gt;正确！&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">第二种情况：&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">char* p=\"how are you ?\";&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">char name[10];&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">strcpy(name,p); //目标串长度小于源串,错误！&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">name[sizeof(name)-1]='\\0'; //和上一步组合，弥补结果，但是这种做法并不可取，因为上一步出错处理方式并不确定<br _extended=\"true\" style=\"line-height: 28px;\">strncpy(name,p,sizeof(name)); //源串长度大于指定拷贝的长度sizeof(name)，注意在这种情况下不会自动在目标串后面加'\\0'&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">name[sizeof(name)-1]='\\0'; //和上一步组合，弥补结果<br _extended=\"true\" style=\"line-height: 28px;\"><hr style=\"line-height: 28px;\">总结：strcpy&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">源字串全部拷贝到目标字串中,包括'\\0'，但是程序员必须保证目标串长度足够，且不与源串重叠。<br _extended=\"true\" style=\"line-height: 28px;\">strncpy&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">如果目标长&gt;=指定长&gt;源长，则将源串全部拷贝到目标串，连同'\\0'&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">如果指定长&lt;源长，则将截取源串中按指定长度拷贝到目标字符串，不包括'\\0'&nbsp;<br _extended=\"true\" style=\"line-height: 28px;\">如果指定长&gt;目标长，错误!</span></div></div></div><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span title=\"neteasefooter\" style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span id=\"netease_mail_footer\"><div id=\"netease_mail_footer\"><div style=\"border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); padding: 10px 5px; color: rgb(102, 102, 102); line-height: 22px;\">来自网易手机号码邮箱<a id=\"mobile_set\" sys=\"1\" log=\"1\" logid=\"free_sms_20120504\" href=\"http://shouji.163.com/\" target=\"_blank\" style=\"color: rgb(0, 0, 255);\">了解更多</a></div></div></span></span>"
    }
  ]
}
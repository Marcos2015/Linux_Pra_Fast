{
  "title": "位域的sizeof问题",
  "cells": [
    {
      "type": "text",
      "data": "<span class=\"Apple-style-span\" style=\"font-family: Arial; font-size: 14px; color: rgb(255, 1, 2);\">位域:</span><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(255, 1, 2);\">&nbsp;&nbsp; &nbsp;关于位域的目的，用法，定义就不多说了，主要说一下位域的存储问题。</span><hr>&nbsp;&nbsp; &nbsp;1.一个位域的大小可以超过一个字节，大小不要超过其声明的类型大小即可:</div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\">&nbsp;&nbsp; &nbsp; &nbsp;如：&nbsp;</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">int name:31;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\">&nbsp;&nbsp; &nbsp;2.<span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">如果相邻位域的类型相同，且其位宽之和小于等于类型的sizeof大小，则两位域放入一个字段存储:</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;如： &nbsp;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">char name1 : 2;</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char name2 : 6;&nbsp;</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;&nbsp;则这2个字段放入一个字节存储, sizeof结果为 1.</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; 3.如果相邻位域的类型相同，且其位宽之和大于类型的sizeof大小,则第二个位段从下一个对齐开始存储:</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;如 ：</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>&nbsp;&nbsp; &nbsp;&nbsp;<span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">char name1 : 5;</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char name2 : 4;</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;&nbsp;则这2个字段放入两个字节存储,sizeof结果为 2.</span></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; 4.如果相邻位域的类型不同，则这多个位段会存储在类型sizeof大的位段中，如果所有位段大小之和</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;小于等于最大类型的sizeof,则可以全部装下,否则,整个位域的存储空间会以最大类型的sizeof长度</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"font-family: verdana; line-height: 18px;\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;来进行扩充 :</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(255, 1, 2);\">&nbsp;&nbsp; &nbsp; &nbsp;</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2);\">如 ：</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">struct str{</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;char name1 :1;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;int &nbsp;name2 :30;<br></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;char name3 :x;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;};</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp;当 x = 1时, sizeof(str) = 4;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp;当 x = 2时, sizeof(str) = 8;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2); font-size: 12px;\">&nbsp;&nbsp; &nbsp;5.如果你要使用位域,你应该很清楚每个字段的大小,从而有序的安排位域的顺序,最小化总字段空间:</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2); font-size: 12px;\">&nbsp;&nbsp; &nbsp; &nbsp;如 ：</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2); font-size: 12px;\">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;</span><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">struct str{</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">struct str{</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; char name1 : 4;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;char name1 : 4;</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; char name2 : 5;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;char name3 : 4;<br></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; char name3 : 4;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;char name2 : 5;<br></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp; };</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">};</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;</span></span><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">sizeof(str) = 3;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">sizeof(str) = 2;</span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 1, 2); font-size: 12px;\"><hr></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span>关于空域：</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t\t\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">站位域：</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">struct str{</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t\t\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">struct str{</span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;int name1 : 5;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;int name1 : 5;<br></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;int :0;<span class=\"Apple-style-span\" style=\"white-space: pre;\">&nbsp;                        </span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">int :2;<br></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-style-span\" style=\"font-size: 12px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;char name2 : 5;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">&nbsp;&nbsp; &nbsp;char name2 : 5;<br></span></span></div><div style=\"caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">};</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">\t\t\t\t</span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">};<br></span></div><span class=\"Apple-style-span\" style=\"font-family: Arial; font-size: 14px; color: rgb(255, 1, 2);\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">sizeof(str) = 8;</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\"><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">\t\t</span></span><span class=\"Apple-style-span\" style=\"color: rgb(0, 128, 255);\">sizeof(str) = 4;</span></span>"
    }
  ]
}
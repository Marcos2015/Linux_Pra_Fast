{
  "title": "C运行时库函数和API函数区别",
  "cells": [
    {
      "type": "text",
      "data": "<div><br></div><div><div style=\"color: rgb(0, 0, 0); line-height: 1.7; font-size: 14px; font-family: Arial;\"><div id=\"article_content\" class=\"article_content\" style=\"margin: 20px 0px 0px; line-height: 26px; color: rgb(51, 51, 51);\"><p>C运行时库函数 &nbsp;是指 C语言本身支持的一些基本函数，通常是汇编直接实现的。。。。 &nbsp;</p><p>&nbsp;API函数是操作系统提供给用户方便设计应用程序的函数，实现一些特定的功能，API函数也是C语言的函数实现的。&nbsp;</p><p>他们之间区别是：API函数是针对操作系统的，C语言运行时函数则是针对C语言本身的</p><p>1)运行时库就是 C run-time library，是C而非C++语言世界的概念:取这个名字就是因为你的C程序运行时需要这些库中的函数. &nbsp;&nbsp;</p><p>2)C语言是所谓的“小内核”语言，就其语言本身来说很小（不多的关键字，程序流程控制，数据类型等）；所以，C语言内核开发出来之后，Dennis &nbsp; Ritchie和Brian Kernighan就用C本身重写了90%以上的UNIX系统函数，并且把其中最常用的部分独立出来，形成头文件和对应的LIBRARY，Crun-time Library就是这样形成的。 &nbsp; &nbsp;&nbsp;</p><p>3)随后，随着C语言的流行，各个C编译器的生产商/个体/团体都遵循老的传统，在不同平台上都有相对应的Standard Library，但大部分实现都是与各个平台有关的。由于各个C编译器对C的支持和理解有很多分歧和微妙的差别，所以就有了ANSI C；ANSI C（主观意图上）详细的规定了C语言各个要素的具体含义和编译器实现要求，引进了新的函数声明方式，同时订立了Standard Library的标准形式。所以C运行时库由编译器生产商提供。至于由其他厂商/个人/团体提供的头文件和库函数，应当称为第三方C运行库（Third party C runtime &nbsp; libraries）</p><p>4)C run-time library里面含有初始化代码，还有错误处理代码(例如divide by zero处理)。你写的程序可以没有math库，程序照样运行，只是不能处理复杂的数学运算，不过如果没有了C run-time库，main()就不会被调用，exit()也不能被响应。因为C run-time Library包含了C程序运行的最基本和最常用的函数。&nbsp;</p><p>5)到了C++世界里，有另外一个概念:Standard C ++ Library,它包括了上面所说的C run-time Library和STL。包含C run-time Library的原因很明显，C++是C的超集，没有理由再重新来一个C++ run-time Library.VC针对C++加入的Standard C ++ Library主要包括：LIBCP.LIB,LIBCPMT.LIB和MSVCPRT.LIB&nbsp;<br></p><p>6)Windows环境下，VC提供的 C run-time Library又分为动态运行时库和静态运行时库<br></p><p>动态运行时库主要是DLL库文件msvcrt.dll(or MSVCRTD.DLL for debug build),对应的Import Library文件是MSVCRT.LIB(MSVCRTD.LIB for debug build) &nbsp; &nbsp;静态运行时库(release版)对应的主要文件是： &nbsp; &nbsp;LIBC.LIB(Single thread static library, retail version) &nbsp; &nbsp;LIBCMT.LIB(Multithread static library, retail version) &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>msvcrt.dll提供几千个C函数，即使是像printf这么低级的函数都在msvcrt.dll里。其实你的程序运行时，很大一部分时间是在这些运行库里运行。在你的程序(release版)被编译时，VC会根据你的编译选项(单线程、多线程或DLL)自动将相应的运行时库文件(libc.lib,libcmt.lib或Import Library msvcrt.lib)链接进来。 &nbsp; &nbsp; &nbsp;&nbsp;</p><p>编译时到底哪个C run-time library联入你的程序取决于编译选项：/MD,/ML, /MT,/LD (Use Run-Time Library) 你可以VC中通过以下方法设置选择哪个C run-time library联入你的程序： To find these options in the development environment,click Settings on &nbsp; the Project menu.Then click the C/C++ tab,and click Code Generation in the Category box.See the Use Run-Time Library drop-down box.&nbsp;<br></p><p>&nbsp;从程序可移植性考虑,如果两函数都可完成一种功能，选运行时库函数好,因为各个C编译器的生产商对标准C &nbsp;Run-time Library提供了统一的支持.&nbsp;<br></p><p>怎么样链接C运行库,而不需要DllMain()? &nbsp;MSDN &nbsp; 说可以不实现DLLMAIN(),而链接运行库,怎么弄? &nbsp;在编译设置中加入 &nbsp; /ENTRY:_CRT_INIT@12 &nbsp; ，或者使用 &nbsp; #pragma #pragma &nbsp; comment(linker, &nbsp; \"/ENTRY:_CRT_INIT@12\")Top</p></div></div><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span title=\"neteasefooter\" style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span id=\"netease_mail_footer\"><div id=\"netease_mail_footer\"><div style=\"border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); padding: 10px 5px; color: rgb(102, 102, 102); line-height: 22px;\">来自网易手机号码邮箱<a id=\"mobile_set\" sys=\"1\" log=\"1\" logid=\"free_sms_20120504\" href=\"http://shouji.163.com/\" target=\"_blank\" style=\"color: rgb(0, 0, 255);\">了解更多</a></div></div></span></span></div>"
    }
  ]
}
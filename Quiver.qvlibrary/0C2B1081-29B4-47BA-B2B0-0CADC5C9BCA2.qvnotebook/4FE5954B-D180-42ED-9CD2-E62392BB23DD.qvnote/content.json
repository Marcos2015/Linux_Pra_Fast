{
  "title": "CentOS7创建本地YUM源的三种方法",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">本文中的“本地YUM源”包括三种类型：一是直接使用CentOS光盘作为本地yum源，优点是简单便捷，缺点是光盘软件包可能不完整 (centos 7 Everything 总共才6.57G)；二是同步CentOS官方源到本地（相当于创建了一个公共镜像），优点是最靠谱，缺点是占空间费流量；三是创建完全自定义的本地源， 优点是灵活性最大，缺点是只是作为其他源的补充。</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><strong>一、使用CentOS光盘作为本地yum源</strong></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">(1) 实体机上直接放入光盘<br>(2) VMware Workstation 虚拟机：虚拟机--&gt;可移动设备--&gt;CD/DVD--&gt;连接<br><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode27\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>mkdir /mnt/cdrom #创建目录<br>mount /dev/cdrom /mnt/cdrom #挂载<br>umount /mnt/cdrom #卸载<br>若不想每次都要放光盘，那就复制光盘文件到本地硬盘吧<br>[code]<br>cp -avf /mnt/cdrom /yum # -a：该选项保留链接、文件属性，并递归地复制目录<br></div><br style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">2、创建repo文件</span><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode28\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>cat &gt;&gt;/etc/yum.repos.d/CentOS-Local.repo&lt;&lt;-EOF<br>[Local]<br>name=Local Yum<br>baseurl=<a href=\"file:///yum/\">file:///yum/</a><br>gpgcheck=1<br>gpgkey=<a href=\"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\">file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</a><br>enabled=1<br></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">问：为什么连createrepo软件都不用安装？</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">createrepo 的作用是创建索引文件的(位于repodata文件夹)，光盘中连GPG-KEY都有了。</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><strong>二、如何为CentOS创建公共镜像</strong></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">详细说明见官方中文文档：</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><a href=\"http://wiki.centos.org/zh/HowTos/CreatePublicMirrors\">http://wiki.centos.org/zh/HowTos/CreatePublicMirrors</a></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">提供一个SHELL脚本，然后cron自动运行~~</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">脚本稍作修改，换成中科大的镜像源。可用镜像列表见：<a href=\"http://www.centos.org/download/mirrors/\">http://www.centos.org/download/mirrors/</a></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode29\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>localpath=\"/mirrors/CentOS\"<br>mirror=\"<a href=\"http://mirrors.hustunique.com/\">mirrors.hustunique.com</a>::centos\"<br>rsync=\"rsync -avzH --delete\"&lt;/p&gt; &lt;p&gt;verlist=\"7\"<br>baselist=\"centosplus extras fasttrack os updates\"<br>archlist=\"x86_64\"&lt;/p&gt; &lt;p&gt;for ver in $verlist<br>do<br>for base in $baselist<br>do<br>for arch in $archlist<br>do<br>remote=$mirror/$ver/$base/$arch/<br>mkdir -pv $localpath/$ver/$base/$arch/<br>$rsync $remote $localpath/$ver/$base/$arch/<br>done<br>done<br>done&lt;/p&gt; &lt;p&gt;</div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><strong>三、创建完全自定义的本地源</strong></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">把平时收藏的一些RPM软件包放在一个目录里，就变成一个自定义源了，可以用YUM来管理，灵活性相当大。</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">官方教程：<a target=\"_blank\" href=\"http://yum.baseurl.org/wiki/RepoCreate\">How to setup your own package repository&nbsp;&nbsp;</a></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">1、创建本地yum仓库<br><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode30\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>mkdir -p /yum/local #可以有N级目录<br>cp ... #复制RPM包到上述目录<br></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">2、创建repo文件<br><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode31\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>cat &gt;&gt;/etc/yum.repos.d/CentOS-Local.repo&lt;&lt;-EOF<br>[Local]<br>name=Local Yum<br>baseurl=<a href=\"file:///yum/\">file:///yum/</a><br>gpgcheck=1<br>gpgkey=<a href=\"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\">file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</a><br>enabled=1<br></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">3、安装createrepo</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><div class=\"msgborder\" id=\"phpcode32\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br>yum install createrepo #使用yum安装createrepo<br>rpm -ivh &lt;a href=\"<a href=\"http://mirror.centos.org/centos/7/os/x86_64/Packages/createrepo-0.9.9-23.el7.noarch.rpm\">http://mirror.centos.org/centos/7/os/x86_64/Packages/createrepo-0.9.9-23.el7.noarch.rpm</a>\"&gt;<a href=\"http://mirror.centos.org/centos/7/os/x86_64/Packages/createrepo-0.9.9-23.el7.noarch.rpm\">http://mirror.centos.org/centos/7/os/x86_64/Packages/createrepo-0.9.9-23.el7.noarch.rpm</a>&lt;/a&gt;<br></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">4、创建索引</p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><br></p><div class=\"msgheader\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"right\"><span style=\"cursor: pointer;\"><u>复制代码</u></span></div>代码如下:</div><br style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">createrepo /yum&nbsp;</span><br style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\">yum makecache #更新缓存</span>"
    }
  ]
}
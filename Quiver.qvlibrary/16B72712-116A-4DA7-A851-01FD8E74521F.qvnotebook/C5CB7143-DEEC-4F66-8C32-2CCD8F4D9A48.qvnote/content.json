{
  "title": "git checkout -f 实例|Git打包压缩方法",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">像android一样的源码，一个源码就有10G，如果要想发送或者刻录，这么大的代码很难传输。因此，可以这样做：</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">0.先在根目录使用：git init。(注意，1.不要用--bare参数，纯版本仓库也会报错，说是没有work tree。2.也不要在命令后面加上目录，如：git init ../notbare。)</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">然后,提交commit</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">git add .&nbsp;<br style=\"box-sizing: border-box;\"></p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">git commit -am \"new\"</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">不做这一步，相当于没有提交过commit给git仓库，.git实际还是一个空空如也的仓库，也就不会有branch，在checkout的时候会报错，说没有branch。第一次提交commit后，会产生master分支（branch）。后面在实例会展示这个操作。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">同样道理，对.git的要求是有提交过commit的branch，如果你是从别的地方clone下一个git库，自然会有一个已经提交过commit的branch。这样，就不需要再次提交commit了，直接就可以进行下面的操作。<br style=\"box-sizing: border-box;\"></p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">1.根目录下的.git复制一份。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">2.压缩这个.git文件夹。linux中可以tar -cjf .git 会打包成一个v名字的文件，把它重命名为git.bz2。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">3.发送给别人</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">4.别人获得git.bz2后，解压缩，得到.git。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">5.在linux下看不到.开头的文件，因此要把.git放在一个工作路径下，可以先创建一个文件夹，把压缩包放在里面，然后在当前路径解压缩。或者使用tar -xjf git.bz2解压缩，我是图形界面解压缩，所以没验证这个指令的选项对不对。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">6.在.git的同级目录下执行git checkout -f&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">记得不要进入.git目录，否则它会报错，fatal this operation must be run in a work tree。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">&nbsp;</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">整个过程中，压缩包只有2.3G，这样可以刻录到4G大小的光盘发送给别人了。</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box;\"></p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">完整实例，copy两个文件Screentshot-1.png , Screenshot.png到新建的test2文件夹，然后通过git checkout -f在另一个文件夹new_dir复原：</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">&nbsp;</p><pre code_snippet_id=\"434481\" snippet_file_name=\"blog_20140724_1_3977697\" name=\"code\" class=\"cpp\" style=\"box-sizing: border-box; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; white-space: pre-wrap; padding: 0px; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;\">norton@norton-laptop:~/work$ mkdir test2\nnorton@norton-laptop:~/work$ cp Screenshot* test2\nnorton@norton-laptop:~/work$ cd test2\nnorton@norton-laptop:~/work/test2$ ls\nScreenshot-1.png  Screenshot.png\nnorton@norton-laptop:~/work/test2$ git init\nInitialized empty Git repository in /home/norton/work/test2/.git/\nnorton@norton-laptop:~/work/test2$ git add .\nnorton@norton-laptop:~/work/test2$ git commit -am \"first commit\"\n[master (root-commit) ed37726] first commit\n 2 files changed, 0 insertions(+), 0 deletions(-)\n create mode 100644 Screenshot-1.png\n create mode 100644 Screenshot.png\nnorton@norton-laptop:~/work/test2$ git branch\n* master\nnorton@norton-laptop:~/work/test2$ ls\nScreenshot-1.png  Screenshot.png\nnorton@norton-laptop:~/work/test2$ mkdir new_dir\nnorton@norton-laptop:~/work/test2$ mv .git/ new_dir/\nnorton@norton-laptop:~/work/test2$ cd new_dir/\nnorton@norton-laptop:~/work/test2/new_dir$ ll\ntotal 12\ndrwxr-xr-x 3 norton norton 4096 2014-07-24 17:17 ./\ndrwxr-xr-x 3 norton norton 4096 2014-07-24 17:17 ../\ndrwxr-xr-x 8 norton norton 4096 2014-07-24 17:16 .git/\nnorton@norton-laptop:~/work/test2/new_dir$ git checkout -f\nnorton@norton-laptop:~/work/test2/new_dir$ ll\ntotal 172\ndrwxr-xr-x 3 norton norton  4096 2014-07-24 17:17 ./\ndrwxr-xr-x 3 norton norton  4096 2014-07-24 17:17 ../\ndrwxr-xr-x 8 norton norton  4096 2014-07-24 17:17 .git/\n-rw-r--r-- 1 norton norton 78788 2014-07-24 17:17 Screenshot-1.png\n-rw-r--r-- 1 norton norton 79088 2014-07-24 17:17 Screenshot.png\nnorton@norton-laptop:~/work/test2/new_dir$ \n</pre><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">然后，我创建纯版本仓库，示范下错误</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><pre code_snippet_id=\"434481\" snippet_file_name=\"blog_20140724_2_8433022\" name=\"code\" class=\"cpp\" style=\"box-sizing: border-box; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; white-space: pre-wrap; padding: 0px; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;\">norton@norton-laptop:~/work/test2/new_dir$ rm .git/ -r\nnorton@norton-laptop:~/work/test2/new_dir$ ls\nScreenshot-1.png  Screenshot.png\nnorton@norton-laptop:~/work/test2/new_dir$ git init --bare .git\nInitialized empty Git repository in /home/norton/work/test2/new_dir/.git/\nnorton@norton-laptop:~/work/test2/new_dir$ ll\ntotal 172\ndrwxr-xr-x 3 norton norton  4096 2014-07-24 17:31 ./\ndrwxr-xr-x 3 norton norton  4096 2014-07-24 17:17 ../\ndrwxr-xr-x 7 norton norton  4096 2014-07-24 17:31 .git/\n-rw-r--r-- 1 norton norton 78788 2014-07-24 17:17 Screenshot-1.png\n-rw-r--r-- 1 norton norton 79088 2014-07-24 17:17 Screenshot.png\nnorton@norton-laptop:~/work/test2/new_dir$ mkdir test\nnorton@norton-laptop:~/work/test2/new_dir$ mv .git/ test/\nnorton@norton-laptop:~/work/test2/new_dir$ cd test/\nnorton@norton-laptop:~/work/test2/new_dir/test$ ls\nnorton@norton-laptop:~/work/test2/new_dir/test$ ll\ntotal 12\ndrwxr-xr-x 3 norton norton 4096 2014-07-24 17:31 ./\ndrwxr-xr-x 3 norton norton 4096 2014-07-24 17:31 ../\ndrwxr-xr-x 7 norton norton 4096 2014-07-24 17:31 .git/\nnorton@norton-laptop:~/work/test2/new_dir/test$ git checkout -f\nfatal: This operation must be run in a work tree\n</pre><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">因为纯版本仓库是没有work tree的，我在.git的目录下测试结果如下：</p><p style=\"box-sizing: border-box; margin: 0px 0px 0.5em; padding: 0px; line-height: 2; font-family: &quot;Microsoft Yahei&quot;; font-size: 14px; color: rgb(86, 95, 105); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><pre code_snippet_id=\"434481\" snippet_file_name=\"blog_20140724_3_5382515\" name=\"code\" class=\"cpp\" style=\"box-sizing: border-box; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; white-space: pre-wrap; padding: 0px; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;\">norton@norton-laptop:~/work/test2/new_dir$ git add .\nfatal: This operation must be run in a work tree</pre>"
    }
  ]
}
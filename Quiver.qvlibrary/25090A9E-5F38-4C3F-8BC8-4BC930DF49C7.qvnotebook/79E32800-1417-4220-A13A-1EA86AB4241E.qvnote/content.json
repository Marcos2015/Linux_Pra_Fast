{
  "title": "CMake的简单例子",
  "cells": [
    {
      "type": "text",
      "data": "<div id=\"blog_content\" class=\"blog_content\" style=\"color: rgb(0, 0, 0); font-size: 14px; line-height: 1.8em; font-family: Helvetica, Tahoma, Arial, sans-serif;\"><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\"><a name=\"1.CMake%20%E7%AE%80%E4%BB%8B%7Coutline\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><span class=\"atitle\"><span style=\"font-size: large;\">CMake 简介</span></span></a></h2><p style=\"margin: 0px; padding: 0px;\">CMake是一个跨平台的自动化建构系统，他使用一个名为CMakeLists.txt的文件来描述构建过程，可以产生标准的构建文件，如Unix的Makefile或Windows Visual C++的projects/workspaces。文件CMakeLists.txt需要手工编写，也可以通过编写脚本进行半自动的生成。CMake提供了比autoconfig更简洁的语法。在Linux平台下使用CMake生成Makefile并编译的流程如下：</p><p style=\"margin: 0px; padding: 0px;\">1、编写CMakeLists.txt</p><p style=\"margin: 0px; padding: 0px;\">2、执行命令：\"cmake PATH\"生成Makefile（PATH是CMakeLists.txt所在的目录）。</p><p style=\"margin: 0px; padding: 0px;\">3、使用Make命令进行编译。</p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><h1 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\"><span style=\"font-size: large;\">应用</span></h1><p style=\"margin: 0px; padding: 0px;\">源代码的目录结构</p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Java代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=--CMakeSample%0A%20%20%20%20%7C%0A%20%20%20%20%2B--CMakeLists.txt%0A%20%20%20%20%7C%0A%20%20%20%20%2B--cmake%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%2B--modules%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2BFindTHREAD_DB.cmake%0A%20%20%20%20%2B--src%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%2B--CMakeLists.txt%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%2B--hello%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B--CMakeLists.txt%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B--hello.h%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B--hello.cpp%0A%20%20%20%20%20%20%20%20%20%2B--sample%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2B--CMakeLists.txt%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2B--main.cpp\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-j\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--CMakeSample&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;+--CMakeLists.txt&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;+--cmake&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--modules&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+FindTHREAD_DB.cmake&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;+--src&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--CMakeLists.txt&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--hello&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--CMakeLists.txt&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--hello.h&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--hello.cpp&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--sample&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--CMakeLists.txt&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+--main.cpp&nbsp;&nbsp;</span></li></ol></div><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><p style=\"margin: 0px; padding: 0px;\">在这个例子我模拟以下情况</p><p style=\"margin: 0px; padding: 0px;\">1、在一个目录下生成一个静态库</p><p style=\"margin: 0px; padding: 0px;\">2、在另一个目录中生成一个可执行程序，并引用了前一个静态库。</p><p style=\"margin: 0px; padding: 0px;\">3、查找外部库，（这里例子是在系统的默认路径下查找，这是不必要的，纯粹是为介绍而设的，实际也没有使用）。</p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\">首先来编写根目录下的CMakeLists.txt</h2><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=PROJECT(cmakesample)%0ACMAKE_MINIMUM_REQUIRED(VERSION%202.6)%0A%23Appends%20the%20cmake%2Fmodules%20path%20inside%20the%20MAKE_MODULE_PATH%20variable%20which%20stores%20the%0A%23%20directories%20of%20additional%20CMake%20modules%20%0ASET(CMAKE_MODULE_PATH%20%24%7BPROJECT_SOURCE_DIR%7D%2Fcmake%2Fmodules%20%24%7BCMAKE_MODULE_PATH%7D)%0A%0AADD_SUBDIRECTORY(src)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">PROJECT(cmakesample)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">CMAKE_MINIMUM_REQUIRED(VERSION&nbsp;<span class=\"number\" style=\"color: rgb(192, 0, 0);\">2.6</span>)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#Appends&nbsp;the&nbsp;cmake/modules&nbsp;path&nbsp;inside&nbsp;the&nbsp;MAKE_MODULE_PATH&nbsp;variable&nbsp;which&nbsp;stores&nbsp;the&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;directories&nbsp;of&nbsp;additional&nbsp;CMake&nbsp;modules&nbsp;&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET(CMAKE_MODULE_PATH&nbsp;${PROJECT_SOURCE_DIR}/cmake/modules&nbsp;${CMAKE_MODULE_PATH})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_SUBDIRECTORY(src)&nbsp;&nbsp;</span></li></ol></div><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><p style=\"margin: 0px; padding: 0px;\"><span style=\"white-space: pre;\">1、PROJECT(cmakesample)命名项目的名称。</span></p><p style=\"margin: 0px; padding: 0px;\"><span style=\"white-space: pre;\">2、CMAKE_MINIMUM_REQUIRED(VERSION 2.6)声明了CMake的版本要求。</span></p><p style=\"margin: 0px; padding: 0px;\">3、SET(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake/modules ${CMAKE_MODULE_PATH})指定了一些自己写的CMake模版所存放的地址，比如<span style=\"white-space: pre;\">FindTHREAD_DB.cmake。其中</span>PROJECT_SOURCE_DIR是代码的根目录，也可以使用cmakesample_SOURCE_DIR来替代，cmakesample就是项目名称。</p><p style=\"margin: 0px; padding: 0px;\">4、<span style=\"white-space: pre;\">ADD_SUBDIRECTORY(src)指定了代码所在的子目录。</span></p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\">接着来编写src的CMakeLists.txt</h2><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=INCLUDE_DIRECTORIES(hello)%0ASUBDIRS(hello%20sample)%0A\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">INCLUDE_DIRECTORIES(hello)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SUBDIRS(hello&nbsp;sample)&nbsp;&nbsp;</span></li></ol></div><p style=\"margin: 0px; padding: 0px;\">&nbsp;1、INCLUDE_DIRECTORIES(hello)指定了头文件所在的目录，只有src下的子目录中的 CMakeLists.txt可用，假设外面还有一层跟src同一级别的目录，那么这句话对另一个目录下的CMakeLists.txt无效。其实这句话可以放在sample里的CMakeLists.txt里，不过此时需要改成INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/src/hello)。</p><p style=\"margin: 0px; padding: 0px;\">2、SUBDIRS(hello sample)相当于分别写<span style=\"white-space: pre;\">ADD_SUBDIRECTORY(</span>hello<span style=\"white-space: pre;\">)，</span><span style=\"white-space: pre;\">ADD_SUBDIRECTORY(</span>sample<span style=\"white-space: pre;\">)</span></p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\">接着我们写hello下的CMakeLists.txt</h2><div><span style=\"font-family: monospace; font-size: x-small;\"><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=AUX_SOURCE_DIRECTORY(.%20DIR_HELLO_SRCS)%0AADD_LIBRARY(hello%20STATIC%20%24%7BDIR_HELLO_SRCS%7D)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">AUX_SOURCE_DIRECTORY(.&nbsp;DIR_HELLO_SRCS)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_LIBRARY(hello&nbsp;STATIC&nbsp;${DIR_HELLO_SRCS})&nbsp;&nbsp;</span></li></ol></div></span></div><div>1、AUX_SOURCE_DIRECTORY(. DIR_HELLO_SRCS)把当天目录下的所有源码文件名赋给变量DIR_HELLO_SRCS。</div><div>2、ADD_LIBRARY(hello STATIC ${DIR_HELLO_SRCS})指定生成一个静态库。那如果要生成一个动态库呢，只要把STATIC改为SHARED就可以了。不过如果我们想同时生成静态库和动态库呢？直接把两句话放在一起？这是不行的，因为在CMake中每个target都必须有一个唯一的命名，于是我们把两个语句放在一起就在命名上冲突了。那么如何解决呢，其实CMake的target名并不一定要和输出文件一致的，于是我们可以通过为静态库和动态库设不同的target名，但把输出文件名设成一样来解决这个问题（其实文件名也是不完全一样的，一个是.a结尾，另一个是.so结尾）。于是我们可以这样来写：</div><div><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=ADD_LIBRARY(hello_static%20STATIC%20%24%7BDIR_HELLO_SRCS%7D)%0ASET_TARGET_PROPERTIES(hello_static%20PROPERTIES%20OUTPUT_NAME%20%22hello%22)%0ASET_TARGET_PROPERTIES(hello_static%20PROPERTIES%20CLEAN_DIRECT_OUTPUT%201)%0A%0AADD_LIBRARY(hello_shared%20SHARED%20%24%7BDIR_HELLO_SRCS%7D)%0ASET_TARGET_PROPERTIES(hello_shared%20PROPERTIES%20OUTPUT_NAME%20%22hello%22)%0ASET_TARGET_PROPERTIES(hello_shared%20PROPERTIES%20CLEAN_DIRECT_OUTPUT%201)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_LIBRARY(hello_static&nbsp;STATIC&nbsp;${DIR_HELLO_SRCS})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET_TARGET_PROPERTIES(hello_static&nbsp;PROPERTIES&nbsp;OUTPUT_NAME&nbsp;<span class=\"string\" style=\"color: blue;\">\"hello\"</span>)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET_TARGET_PROPERTIES(hello_static&nbsp;PROPERTIES&nbsp;CLEAN_DIRECT_OUTPUT&nbsp;<span class=\"number\" style=\"color: rgb(192, 0, 0);\">1</span>)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_LIBRARY(hello_shared&nbsp;SHARED&nbsp;${DIR_HELLO_SRCS})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET_TARGET_PROPERTIES(hello_shared&nbsp;PROPERTIES&nbsp;OUTPUT_NAME&nbsp;<span class=\"string\" style=\"color: blue;\">\"hello\"</span>)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET_TARGET_PROPERTIES(hello_shared&nbsp;PROPERTIES&nbsp;CLEAN_DIRECT_OUTPUT&nbsp;<span class=\"number\" style=\"color: rgb(192, 0, 0);\">1</span>)&nbsp;&nbsp;</span></li></ol></div></div><div>&nbsp;</div><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\">接下来我们来写sample下CMakeLists.txt</h2><div><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=SET(DIR_SRCS%20main.cpp)%0AADD_EXECUTABLE(sample%20%24%7BDIR_SRCS%7D)%0ATARGET_LINK_LIBRARIES(sample%20hello)%0A%0AINSTALL(TARGETS%20sample%20RUNTIME%20DESTINATION%20bin)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET(DIR_SRCS&nbsp;main.cpp)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_EXECUTABLE(sample&nbsp;${DIR_SRCS})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">TARGET_LINK_LIBRARIES(sample&nbsp;hello)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">INSTALL(TARGETS&nbsp;sample&nbsp;RUNTIME&nbsp;DESTINATION&nbsp;bin)&nbsp;&nbsp;</span></li></ol></div>1、SET(DIR_SRCS&nbsp;main.cpp)把变量DIR_SRCS赋值为\"main.cpp\"。也是通过AUX_SOURCE_DIRECTORY(.&nbsp;DIR_SRCS)来实现。</div><div>2、ADD_EXECUTABLE(sample ${DIR_SRCS})声明要生成一个叫sample的可执行程序。</div><div>3、TARGET_LINK_LIBRARIES(sample hello)声明需要链接libhello.a库（因为我上面把hello声明为静态库了）。</div><div>4、INSTALL(TARGETS sample RUNTIME DESTINATION bin)声明当运行make insall时把可执行程序安装在${PREFIX}/bin下。其中PREFIX的默认值为/usr/local/，也可以通过在运行cmake时指定<span style=\"line-height: 24px; white-space: pre-wrap;\">-DCMAKE_INSTALL_PREFIX:PATH=\"${CMAKE_INSTALL_PREFIX}\"</span></div><div><br></div><h2 style=\"line-height: 1.5em; margin: 0px 0px 0.5em; padding: 0px;\">最后我们写一下<span style=\"white-space: pre;\">FindTHREAD_DB.cmake</span></h2><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=%23%0A%23%20configuration%20to%20find%20DB_CXX%20library%0A%23%0A%0A%23%20Include%20dir%0Afind_path(THREAD_DB_INCLUDE_DIR%0A%20%20NAMES%20thread_db.h%0A%20%20PATHS%20%2Fusr%2Finclude%2F%20%2Fusr%2Flocal%2Finclude%2F%0A)%0A%0A%23%20Finally%20the%20library%20itself%0Afind_library(THREAD_DB_LIBRARY%0A%20%20NAMES%20%20thread_db%0A%20%20PATHS%20%2Fusr%2Flib%2F%20%2Fusr%2Flocal%2Flib%2F%0A)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;configuration&nbsp;to&nbsp;find&nbsp;DB_CXX&nbsp;library&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;Include&nbsp;dir&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">find_path(THREAD_DB_INCLUDE_DIR&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;NAMES&nbsp;thread_db.h&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;PATHS&nbsp;/usr/include/&nbsp;/usr/local/include/&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">#&nbsp;Finally&nbsp;the&nbsp;library&nbsp;itself&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">find_library(THREAD_DB_LIBRARY&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;NAMES&nbsp;&nbsp;thread_db&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;PATHS&nbsp;/usr/lib/&nbsp;/usr/local/lib/&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">)&nbsp;&nbsp;</span></li></ol></div><p style=\"margin: 0px; padding: 0px;\">1、find_path(THREAD_DB_INCLUDE_DIR&nbsp;NAMES thread_db.h&nbsp;PATHS /usr/include/ /usr/local/include/)在目录“/usr/include\"和\"/usr/local/include\"下查找thread_db.h，如果找到则把目录名赋给THREAD_DB_INCLUDE_DIR</p><p style=\"margin: 0px; padding: 0px;\">2、find_library(THREAD_DB_LIBRARY&nbsp;NAMES &nbsp;thread_db&nbsp;PATHS /usr/lib/ /usr/local/lib/)在目录\"/usr/lib\"和\"/usr/local/lib\"下查找libthread_db.so，如果找到则把库文件的绝对路径赋给THREAD_DB_LIBRARY</p><p style=\"margin: 0px; padding: 0px;\">为了纯粹测试，我们就修改./src/sample/CMakeLists.txt为：</p><p style=\"margin: 0px; padding: 0px;\">&nbsp;</p><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Cmake代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=FIND_PACKAGE(THREAD_DB%20REQUIRED)%0AMARK_AS_ADVANCED(%0ATHREAD_DB_INCLUDE_DIR%0ATHREAD_DB_LIBRARY%0A)%0AMESSAGE(STATUS%20%24%7BTHREAD_DB_INCLUDE_DIR%7D%2C%20%24%7BTHREAD_DB_LIBRARY%7D)%0A%0ASET(DIR_SRCS%0A%20%20%20%20main.cpp)%0AADD_EXECUTABLE(sample%20%24%7BDIR_SRCS%7D)%0ATARGET_LINK_LIBRARIES(sample%20hello)%0A%0AINSTALL(TARGETS%20sample%20RUNTIME%20DESTINATION%20bin)\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">FIND_PACKAGE(THREAD_DB&nbsp;REQUIRED)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">MARK_AS_ADVANCED(&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">THREAD_DB_INCLUDE_DIR&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">THREAD_DB_LIBRARY&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">MESSAGE(STATUS&nbsp;${THREAD_DB_INCLUDE_DIR},&nbsp;${THREAD_DB_LIBRARY})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">SET(DIR_SRCS&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;main.cpp)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">ADD_EXECUTABLE(sample&nbsp;${DIR_SRCS})&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">TARGET_LINK_LIBRARIES(sample&nbsp;hello)&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">INSTALL(TARGETS&nbsp;sample&nbsp;RUNTIME&nbsp;DESTINATION&nbsp;bin)&nbsp;&nbsp;</span></li></ol></div>&nbsp;<div>接着我们在项目的根目录下建立一个文件夹build。</div><div>进入build运行\"cmake ..\"。有如下输出：</div><div><div class=\"dp-highlighter\" id=\"\" style=\"font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word;\"><div class=\"bar\"><div class=\"tools\" style=\"padding: 3px; margin: 0px; font-weight: bold;\">Output代码&nbsp;<embed wmode=\"transparent\" src=\"http://dylanwu.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf\" width=\"14\" height=\"15\" flashvars=\"clipboard=--%20The%20C%20compiler%20identification%20is%20GNU%0A--%20The%20CXX%20compiler%20identification%20is%20GNU%0A--%20Check%20for%20working%20C%20compiler%3A%20%2Fusr%2Fbin%2Fgcc%0A--%20Check%20for%20working%20C%20compiler%3A%20%2Fusr%2Fbin%2Fgcc%20--%20works%0A--%20Detecting%20C%20compiler%20ABI%20info%0A--%20Detecting%20C%20compiler%20ABI%20info%20-%20done%0A--%20Check%20for%20working%20CXX%20compiler%3A%20%2Fusr%2Fbin%2Fc%2B%2B%0A--%20Check%20for%20working%20CXX%20compiler%3A%20%2Fusr%2Fbin%2Fc%2B%2B%20--%20works%0A--%20Detecting%20CXX%20compiler%20ABI%20info%0A--%20Detecting%20CXX%20compiler%20ABI%20info%20-%20done%0A--%20%2Fhome%2Fdylan%2FPublic%2FCMakeSample%0A--%20%3Cspan%20style%3D%22color%3A%20%23ff0000%3B%22%3E%2Fusr%2Finclude%2C%2Fusr%2Flib%2Flibthread_db.so%3C%2Fspan%3E%0A--%20Configuring%20done%0A--%20Generating%20done%0A--%20Build%20files%20have%20been%20written%20to%3A%20%2Fhome%2Fdylan%2FPublic%2FCMakeSample%2Fbuild\" quality=\"high\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">&nbsp;<a title=\"收藏这段代码\" style=\"color: rgb(16, 138, 198); text-decoration: underline;\"><img class=\"star\" src=\"quiver-image-url/55EB9A99292517E853B6A4F5EF4C4E57.png\" alt=\"收藏代码\" style=\"border: 0px;\" width=\"3\" height=\"3\"></a></div></div><ol start=\"1\" class=\"dp-default\" style=\"font-size: 1em; line-height: 1.4em; margin: 0px 0px 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);\"><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;The&nbsp;C&nbsp;compiler&nbsp;identification&nbsp;is&nbsp;GNU&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;The&nbsp;CXX&nbsp;compiler&nbsp;identification&nbsp;is&nbsp;GNU&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Check&nbsp;for&nbsp;working&nbsp;C&nbsp;compiler:&nbsp;/usr/bin/gcc&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Check&nbsp;for&nbsp;working&nbsp;C&nbsp;compiler:&nbsp;/usr/bin/gcc&nbsp;--&nbsp;works&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Detecting&nbsp;C&nbsp;compiler&nbsp;ABI&nbsp;info&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Detecting&nbsp;C&nbsp;compiler&nbsp;ABI&nbsp;info&nbsp;-&nbsp;done&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Check&nbsp;for&nbsp;working&nbsp;CXX&nbsp;compiler:&nbsp;/usr/bin/c++&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Check&nbsp;for&nbsp;working&nbsp;CXX&nbsp;compiler:&nbsp;/usr/bin/c++&nbsp;--&nbsp;works&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Detecting&nbsp;CXX&nbsp;compiler&nbsp;ABI&nbsp;info&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Detecting&nbsp;CXX&nbsp;compiler&nbsp;ABI&nbsp;info&nbsp;-&nbsp;done&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;/home/dylan/Public/CMakeSample&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;&lt;span&nbsp;style=<span class=\"string\" style=\"color: blue;\">\"color:&nbsp;#ff0000;\"</span>&gt;/usr/include,/usr/lib/libthread_db.so&lt;/span&gt;&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Configuring&nbsp;done&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Generating&nbsp;done&nbsp;&nbsp;</span></li><li style=\"font-size: 1em; margin: 0px 0px 0px 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); background-color: rgb(250, 250, 250); line-height: 18px;\"><span style=\"color: black;\">--&nbsp;Build&nbsp;files&nbsp;have&nbsp;been&nbsp;written&nbsp;to:&nbsp;/home/dylan/Public/CMakeSample/build&nbsp;&nbsp;</span></li></ol></div></div><div>&nbsp;其中\"<span style=\"white-space: pre;\">/usr/include,/usr/lib/libthread_db.so</span>\"就是MESSAGE(STATUS ${THREAD_DB_INCLUDE_DIR}, ${THREAD_DB_LIBRARY})的输出。</div><div>还有一点我要先建立build，然后再运行cmake ..的主要原因是这样就不会污染源代码，如果我不想要这些自动生成的文件时只要简单的删除build文件夹就可以了， 这也是我喜欢cmake的一个原因。</div><div>最后我们运行make。这时就会在./build/src/sample下生成一个可执行文件，./build/src/hello下生成一个静态库。</div><div><br></div></div><div class=\"attachments\" style=\"color: rgb(0, 0, 0); border-top-width: 1px; border-top-style: solid; border-top-color: rgb(153, 153, 153); margin-top: 10px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 12px; line-height: 18px;\"></div>"
    }
  ]
}
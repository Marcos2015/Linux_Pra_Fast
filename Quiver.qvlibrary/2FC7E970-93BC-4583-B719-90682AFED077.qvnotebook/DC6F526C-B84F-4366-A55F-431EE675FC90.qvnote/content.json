{
  "title": "C++连接mysql数据库的两种方法",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"position: relative;\"><div style=\"color: rgb(0, 0, 0); line-height: 1.7; font-size: 14px; font-family: arial;\"><div class=\"brief bgF8F8F8\" style=\"background-color: rgb(248, 248, 248); width: 597px; padding: 12px 18px 0px; margin-top: 10px; border-top-color: rgb(216, 217, 217); border-right-color: rgb(216, 217, 217); border-left-color: rgb(216, 217, 217); border-top-width: 1px; border-right-width: 1px; border-left-width: 1px; border-style: solid solid none; color: rgb(51, 51, 51); font-family: 宋体; font-size: 12px; line-height: 18px;\"><h1 style=\"margin: 0px; padding: 12px 0px 0px; color: rgb(0, 0, 0); height: 45px; font-size: 22px; line-height: 42px; text-align: center; border-bottom-color: rgb(216, 217, 217); border-bottom-width: 1px; border-bottom-style: solid;\"></h1></div><div class=\"content bgF8F8F8 f14\" style=\"background-color: rgb(248, 248, 248); padding: 12px 18px 0px; border-right-color: rgb(216, 217, 217); border-bottom-color: rgb(216, 217, 217); border-left-color: rgb(216, 217, 217); border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-style: none solid solid; line-height: 28px; margin-bottom: 10px; position: relative; min-height: 500px; color: rgb(51, 51, 51); font-family: 宋体;\"><div id=\"content\"><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">现在正做一个接口，通过不同的连接字符串操作不同的数据库。要用到<strong style=\"text-align: center;\">mysql</strong>数据库，以前没用过这个数据库，用access和sql server比较多。通过网上的一些资料和自己的摸索，大致清楚了<strong style=\"text-align: center;\">C++</strong>连接mysql的方法。可以通过2种方法实现。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">第一种方法是利用ADO连接，</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">第二种方法是利用mysql自己的api函数进行连接。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">第一种方法可以实现我当前的需求，通过连接不同的字符串来连接不同的数据库。暂时只连接了mysql,sqlserver,oracle，access。对于access,因为它创建表的SQL语句不太兼容标准SQL语句，需要做一些处理，这里暂时不说。第二种方法只能针对于mysql数据库的连接，不过用这种方法不用安装MyODBC服务器程序。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">不管用哪种方法，首先需要安装Mysql数据库，安装方法请看“mysql安装及一些注意点”。最好安装一个Navicat for mysql，方便操作mysql数据库。下面分别说下这两种方法：</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">（一）通过ADO连接MySql数据库</strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">1、通过ADO连接MySql数据库，首先得安装MyODBC服务器程序。</strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">MyODBC版本要和MySql的版本对应上，否则会连接不上数据库。我用的版本分别是mysql-5.1.48-win32.msi和mysql-connector-odbc-5.1.5-win32.msi。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">安装好后，点击开始菜单－&gt;设置－&gt;控制面板－&gt;管理工具－&gt;数据源(ODBC)－&gt;用户DSN－&gt;添加－&gt;选择MySQL ODBC 5.1 Driver。如下图：</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px; text-align: center;\"><a target=\"_blank\" href=\"http://images.51cto.com/files/uploadimg/20110425/1014130.jpg\" style=\"color: rgb(0, 66, 118);\"><img class=\"fit-image\" border=\"0\" alt=\"\" width=\"183\" height=\"152\" src=\"quiver-image-url/C76051833323D5CE9245FA1CE020F591.jpg\" style=\"border: 0px; width: 284px; height: 218px;\"></a></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">然后双击MySQL ODBC 5.1 Driver进行配置。配置好可以点Test进行下测试（如下图），如果能连上会弹出connection successful对话框。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px; text-align: center;\"><a target=\"_blank\" href=\"http://images.51cto.com/files/uploadimg/20110425/1014131.jpg\" style=\"color: rgb(0, 66, 118);\"><img class=\"fit-image\" border=\"0\" alt=\"\" width=\"183\" height=\"158\" src=\"quiver-image-url/2A68D75810836788A4233C96414EF3A5.jpg\" style=\"border: 0px; width: 274px; height: 224px;\"></a></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">上图中的Data Source Name:中的内容就是代码里DSN所对应的值。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">例如：\"DSN=MySqlODBC;server=localhost;database=test\"。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">2、配置好后，就可以开始编码了。<br style=\"clear: both; width: 0px; height: 0px;\"></strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">（1）首先导入ADO类型库。#import \"c:\\program files\\common files\\system\\ado\\msado15.dll\" no_namespace rename(\"EOF\",\"adoEOF\")。您的环境中msado15.dll不一定在这个目录下，请按实际情况修改。或者把msado15.dll这个文件拷贝到你的工程目录下，直接#import \"msado15.dll\" \\ no_namespace \\rename (\"EOF\", \"adoEOF\")包含进来。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">（2 ）创建Connection对象并连接数据库</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-cpp\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">CoInitialize(NULL);&nbsp; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">m_pConnection.CreateInstance(__uuidof(Connection));&nbsp; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">try</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//设置连接时间 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">m_pConnection-&gt;ConnectionTimeout&nbsp;=&nbsp;5; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//打开数据库连接 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"datatypes\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">HRESULT</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;hr&nbsp;=&nbsp;m_pConnection-&gt;Open(</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"DSN=MySqlODBC;server=localhost;database=test\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"root\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"root\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,adModeUnknown); &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">} &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">catch</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(_com_error&nbsp;&amp;e) &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">MessageBox(NULL,&nbsp;e.Description(),&nbsp;_T(</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">),&nbsp;MB_OK); &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;FALSE; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;TRUE; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">(3)执行SQL语句</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-cpp\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">BOOL</span><span style=\"margin: 0px; padding: 0px; border: none;\">&nbsp;CDBManagerSub::ExecuteSQL(&nbsp;_bstr_t&nbsp;bstrSQL&nbsp;) &nbsp;</span></span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;_variant_t&nbsp;RecordsAffected; </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">try</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;是否已经连接数据库 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(m_pConnection&nbsp;==&nbsp;NULL) &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//重新连接数据库 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">Open(m_dbType,&nbsp;m_strServer,&nbsp;m_strUserName,&nbsp;m_strPasswor,&nbsp;m_strDBName); &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">} &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;Connection对象的Execute方法:(_bstr_t&nbsp;CommandText,&nbsp; </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;VARIANT&nbsp;*&nbsp;RecordsAffected,&nbsp;long&nbsp;Options&nbsp;)&nbsp; </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;其中CommandText是命令字串，通常是SQL命令。 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;参数RecordsAffected是操作完成后所影响的行数,&nbsp; </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;参数Options表示CommandText的类型：adCmdText-文本命令；adCmdTable-表名 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;adCmdProc-存储过程；adCmdUnknown-未知 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">_RecordsetPtr&nbsp;hr&nbsp;=&nbsp;m_pConnection-&gt;Execute(bstrSQL,NULL,adCmdText); &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">} &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">catch</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(_com_error&nbsp;e) &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">MessageBox(NULL,&nbsp;e.Description(),&nbsp;_T(</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">),&nbsp;MB_OK); &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">} &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">_bstr_t bstrSQL为输入的SQL语句，如果返回TRUE，则执行成功，返回FLASH则会报对应的错误提示。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">例如：下面的创建testTable表的SQL语句：</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-sql\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">char</span><span style=\"margin: 0px; padding: 0px; border: none;\">*&nbsp;pQuery&nbsp;=&nbsp;</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"create&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;testTable(&nbsp;ID&nbsp;VARCHAR(10),&nbsp;Name&nbsp;VARCHAR(255),Descs&nbsp;VARCHA(255),PRIMARY&nbsp;KEY&nbsp;(ID))\"</span><span style=\"margin: 0px; padding: 0px; border: none;\">; &nbsp;</span></span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">ExecuteSQL(pQuery);&nbsp;&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">&nbsp;3、附上mysql数据库的操作，方便没有安装Navicat for mysql的朋友参考。</strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">打开“开始-&gt;所有程序-&gt;MySQL-&gt;MySQL Server 5.0-&gt;MySQL Command Line Client.exe”，如果没有设置密码就直接按回车，会提示服务器启动成功。</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-sql\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql&gt;&nbsp;SHOW&nbsp;DATABASES;//显示所有的数据库，注意一定要&nbsp;敲“;”后再按回车 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql&gt;&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">CREATE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">DATABASE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;mydb;//创建数据库 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mydbmysql&gt;&nbsp;USE&nbsp;mydb;//选择你所创建的数据库 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mydbmysql&gt;&nbsp;SHOW&nbsp;TABLES;&nbsp;//显示数据库中的表 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql&gt;&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">CREATE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">TABLE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;mytable&nbsp;(username&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">VARCHAR</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(100),&nbsp;visitelist&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">VARCHAR</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(200),remark&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">VARCHAR</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(200),</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">PRIMARY</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">KEY</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(username));//创建一个表mytable:&nbsp;用户名；访问列表,主键为username &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql&gt;&nbsp;DESCRIBE&nbsp;mytable;//显示表的结构</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">（二）通过MySQL自己的API函数进行连接<br style=\"clear: both; width: 0px; height: 0px;\"></strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">1、使用API的方式连接，需要加载mysql的头文件和lib文件。</strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">在VS2010的附加包含目录中添加\\MySQL\\MySQL Server 5.1\\include。在安装MySql的目录下找。 把libmysql.dll和libmysql.lib文件拷贝到所建的工程目录下。然后在头文件里包含以下内容：</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-sql\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">//mysql所需的头文件和库文件 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">#include&nbsp;</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"winsock.h\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">#include&nbsp;</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"mysql.h\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">#pragma&nbsp;comment(lib,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"libmySQL.lib\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">)&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\"><strong style=\"text-align: center;\">2、进行编码<br style=\"clear: both; width: 0px; height: 0px;\"></strong></p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">（1）连接mysql数据库</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">头文件里定义数据源指针 MYSQL m_sqlCon;</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">//连接MySql数据库</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-cpp\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">try</span><span style=\"margin: 0px; padding: 0px; border: none;\">&nbsp;</span></span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_init(&amp;m_sqlCon); &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"comment\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//&nbsp;localhost:服务器&nbsp;root为账号密码&nbsp;test为数据库名&nbsp;3306为端口 </span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(!mysql_real_connect(&amp;m_sqlCon,&nbsp;</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"localhost\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"root\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"root\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"test\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">,3306,NULL,0)) &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">AfxMessageBox(_T(</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"数据库连接失败!\"</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">)); &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;FALSE; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;TRUE; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">} &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">catch</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(...) &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{ &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;FALSE; &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">（2）关闭数据库</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-cpp\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_close(&amp;m_sqlCon);&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">（3）创建表</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-cpp\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"margin: 0px; padding: 0px; border: none;\">*&nbsp;pQuery&nbsp;=&nbsp;</span><span class=\"string\" style=\"margin: 0px; padding: 0px; border: none; color: blue;\">\"create&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;DS_Building(&nbsp;ID&nbsp;VARCHAR(10),Name&nbsp;VARCHAR(255),Descs&nbsp;VARCHAR(255),PRIMARY&nbsp;KEY&nbsp;(ID))\"</span><span style=\"margin: 0px; padding: 0px; border: none;\">&nbsp; &nbsp;</span></span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">(mysql_real_query(&amp;m_sqlCon,pQuery,(</span><span class=\"datatypes\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">UINT</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">)strlen(pQuery))!=0) &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">const</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"datatypes\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">*&nbsp;pCh&nbsp;=&nbsp;mysql_error(&amp;m_sqlCon); &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;FALSE; &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">附MySQL的API接口：</p><pre style=\"margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 591px; overflow: auto; background-color: rgb(230, 230, 230);\"><ol class=\"dp-sql\" style=\"margin-left: 55px; padding: 5px 0px; color: rgb(92, 92, 92); list-style-position: initial; list-style-image: initial; word-wrap: break-word; word-break: normal; border: none; background-color: rgb(247, 247, 247); margin-top: 0px !important; margin-right: 0px !important; margin-bottom: 1px !important;\"><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\"><span style=\"margin: 0px; padding: 0px; border: none;\">mysql_affected_rows()&nbsp;返回被最新的</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">UPDATE</span><span style=\"margin: 0px; padding: 0px; border: none;\">,&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">DELETE</span><span style=\"margin: 0px; padding: 0px; border: none;\">或</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">INSERT</span><span style=\"margin: 0px; padding: 0px; border: none;\">查询影响的行数。 &nbsp;</span></span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_close()&nbsp;关闭一个服务器连接。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_connect()&nbsp;连接一个MySQL服务器。该函数不推荐；使用mysql_real_connect()代替。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_change_user()&nbsp;改变在一个打开的连接上的用户和数据库。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_create_db()&nbsp;创建一个数据库。该函数不推荐；而使用SQL命令</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">CREATE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">DATABASE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_data_seek()&nbsp;在一个查询结果集合中搜寻一任意行。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_debug()&nbsp;用给定字符串做一个DBUG_PUSH。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_drop_db()&nbsp;抛弃一个数据库。该函数不推荐；而使用SQL命令</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">DROP</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">DATABASE</span><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_dump_debug_info()&nbsp;让服务器将调试信息写入日志文件。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_eof()&nbsp;确定是否已经读到一个结果集合的最后一行。这功能被反对;&nbsp;mysql_errno()或mysql_error()可以相反被使用。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_errno()&nbsp;返回最近被调用的MySQL函数的出错编号。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_error()&nbsp;返回最近被调用的MySQL函数的出错消息。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_escape_string()&nbsp;用在SQL语句中的字符串的转义特殊字符。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_fetch_field()&nbsp;返回下一个表字段的类型。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_fetch_field_direct&nbsp;()&nbsp;返回一个表字段的类型，给出一个字段编号。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_fetch_fields()&nbsp;返回一个所有字段结构的数组。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_fetch_lengths()&nbsp;返回当前行中所有列的长度。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_fetch_row()&nbsp;从结果集合中取得下一行。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_field_seek()&nbsp;把列光标放在一个指定的列上。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_field_count()&nbsp;返回最近查询的结果列的数量。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_field_tell()&nbsp;返回用于最后一个mysql_fetch_field()的字段光标的位置。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_free_result()&nbsp;释放一个结果集合使用的内存。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_get_client_info()&nbsp;返回客户版本信息。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_get_host_info()&nbsp;返回一个描述连接的字符串。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_get_proto_info()&nbsp;返回连接使用的协议版本。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_get_server_info()&nbsp;返回服务器版本号。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_info()&nbsp;返回关于最近执行得查询的信息。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_init()&nbsp;获得或初始化一个MYSQL结构。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_insert_id()&nbsp;返回有前一个查询为一个AUTO_INCREMENT列生成的ID。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_kill()&nbsp;杀死一个给定的线程。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_list_dbs()&nbsp;返回匹配一个简单的正则表达式的数据库名。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_list_fields()&nbsp;返回匹配一个简单的正则表达式的列名。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_list_processes()&nbsp;返回当前服务器线程的一张表。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_list_tables()&nbsp;返回匹配一个简单的正则表达式的表名。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_num_fields()&nbsp;返回一个结果集合重的列的数量。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_num_rows()&nbsp;返回一个结果集合中的行的数量。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_options()&nbsp;设置对mysql_connect()的连接选项。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_ping()&nbsp;检查对服务器的连接是否正在工作，必要时重新连接。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_query()&nbsp;执行指定为一个空结尾的字符串的SQL查询。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_real_connect()&nbsp;连接一个MySQL服务器。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_real_query()&nbsp;执行指定为带计数的字符串的SQL查询。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_reload()&nbsp;告诉服务器重装授权表。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_row_seek()&nbsp;搜索在结果集合中的行，使用从mysql_row_tell()返回的值。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_row_tell()&nbsp;返回行光标位置。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_select_db()&nbsp;连接一个数据库。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_shutdown()&nbsp;关掉数据库服务器。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_stat()&nbsp;返回作为字符串的服务器状态。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_store_result()&nbsp;检索一个完整的结果集合给客户。 &nbsp;</span></li><li class=\"alt\" style=\"color: inherit; list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_thread_id()&nbsp;返回当前线程的ID。 &nbsp;</span></li><li style=\"list-style: none; word-wrap: break-word; word-break: normal; border: none; background-image: url(http://images.51cto.com/images/art1105/images/0.gif); background-attachment: scroll; line-height: 18px; margin: 0px !important; padding: 0px 3px 0px 10px !important; background-position: -498px -70px; background-repeat: no-repeat repeat;\"><span style=\"margin: 0px; padding: 0px; border: none; color: black;\">mysql_use_result()&nbsp;初始化一个一行一行地结果集合的检索。&nbsp;</span></li></ol></pre><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">通过本文的介绍，希望你对C++连接mysql数据库的两种方法有所了解，供参考。</p><p style=\"margin: 10px 0px; padding: 0px; text-indent: 28px;\">【编辑推荐】</p></div></div></div><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span title=\"neteasefooter\" style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span id=\"netease_mail_footer\"><div id=\"netease_mail_footer\"><div style=\"border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); padding: 10px 5px; color: rgb(102, 102, 102); line-height: 22px;\">来自网易手机号码邮箱<a id=\"mobile_set\" sys=\"1\" log=\"1\" logid=\"free_sms_20120504\" href=\"http://shouji.163.com/\" target=\"_blank\" style=\"color: rgb(0, 0, 255);\">了解更多</a></div></div></span></span></div>"
    }
  ]
}
{
  "title": "阻塞和非阻塞read/write",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\">read函数</span></p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\">调用read函数从打开文件中读数据。</span></p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"></span></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 292px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_1\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_1\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=1&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&lt;unistd.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">ssize_t&nbsp;read(<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;filedes,</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;*buf,</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">size_t</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;nbytes);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回值：若成功则返回读到的字节数，若已到文件结尾则返回<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">，若出错则返回-</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">并设置errno&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><span style=\"color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px; background-color: rgb(255, 255, 255);\">如read成功，则返回读到的字节数。如已到达文件结尾，则返回0.</span><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"></span></p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">参数<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">count</code>是请求读取的字节数，读上来的数据保存在缓冲区<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">buf</code>中，同时文件的当前读写位置向后移。注意这个读写位置和使用C标准I/O库时的读写位置有可能不同，这个读写位置是记在内核中的，而使用C标准I/O库时的读写位置是用户空间I/O缓冲区中的位置。比如用<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">fgetc</code>读一个字节，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">fgetc</code>有可能从内核中预读1024个字节到I/O缓冲区中，再返回第一个字节，这时该文件在内核中记录的读写位置是1024，而在<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">FILE</code>结构体中记录的读写位置是1。注意返回值类型是<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">ssize_t</code>，表示有符号的<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">size_t</code>，这样既可以返回正的字节数、0（表示到达文件末尾）也可以返回负值-1（表示出错）。<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>函数返回时，返回值说明了<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">buf</code>中前多少个字节是刚读上来的。有些情况下，实际读到的字节数（返回值）会小于请求读的字节数<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">count</code>，例如：</p><div class=\"itemizedlist\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-family: arial, helvetica, sans-serif; font-size: 14px;\"><ul type=\"disc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style: none;\"><li style=\"margin: 8px 0px 0px 32px; padding: 0px; box-sizing: border-box; list-style: disc;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">读常规文件时，在读到<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">count</code>个字节之前已到达文件末尾。例如，距文件末尾还有30个字节而请求读100个字节，则<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>返回30，下次<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>将返回0。</p></li><li style=\"margin: 8px 0px 0px 32px; padding: 0px; box-sizing: border-box; list-style: disc;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">从终端设备读，通常以行为单位，读到换行符就返回了。</p></li><li style=\"margin: 8px 0px 0px 32px; padding: 0px; box-sizing: border-box; list-style: disc;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">从网络读，根据不同的传输层协议和内核缓存机制，返回值可能小于请求的字节数，后面socket编程部分会详细讲解。</p></li></ul></div><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\"><code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">write</code>函数向打开的设备或文件中写数据。</p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 923px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_2\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_2\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=2&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&lt;unistd.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">ssize_t&nbsp;write(<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;filedes,</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">const</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;*buf,</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">size_t</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;nbytes);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回值：若成功则返回已写的字节数，若出错则返回-<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">并设置errno&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">写常规文件时，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">write</code>的返回值通常等于请求写的字节数<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">count</code>，而向终端设备或网络写则不一定。</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">读常规文件是不会阻塞的，不管读多少字节，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>一定会在有限的时间内返回。从终端设备或网络读则不一定，如果从终端输入的数据没有换行符，调用<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>读终端设备就会阻塞，如果网络上没有接收到数据包，调用<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>从网络读就会阻塞，至于会阻塞多长时间也是不确定的，如果一直没有数据到达就一直阻塞在那里。同样，写常规文件是不会阻塞的，而向终端设备或网络写则不一定。</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">现在明确一下阻塞（Block）<a id=\"id2852343\" class=\"indexterm\" target=\"_blank\" style=\"color: rgb(0, 0, 255); outline: 0px; margin: 0px; padding: 0px; box-sizing: border-box; text-decoration: underline;\"></a>这个概念。当进程调用一个阻塞的系统函数时，该进程被置于睡眠（Sleep）<a id=\"id2852352\" class=\"indexterm\" target=\"_blank\" style=\"color: rgb(0, 0, 255); outline: 0px; margin: 0px; padding: 0px; box-sizing: border-box; text-decoration: underline;\"></a>状态，这时内核调度其它进程运行，直到该进程等待的事件发生了（比如网络上接收到数据包，或者调用<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">sleep</code>指定的睡眠时间到了）它才有可能继续运行。与睡眠状态相对的是运行（Running）<a id=\"id2852368\" class=\"indexterm\" target=\"_blank\" style=\"color: rgb(0, 0, 255); outline: 0px; margin: 0px; padding: 0px; box-sizing: border-box; text-decoration: underline;\"></a>状态，在Linux内核中，处于运行状态的进程分为两种情况：</p><div class=\"itemizedlist\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-family: arial, helvetica, sans-serif; font-size: 14px;\"><ul type=\"disc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style: none;\"><li style=\"margin: 8px 0px 0px 32px; padding: 0px; box-sizing: border-box; list-style: disc;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">正在被调度执行。CPU处于该进程的上下文环境中，程序计数器（<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">eip</code>）里保存着该进程的指令地址，通用寄存器里保存着该进程运算过程的中间结果，正在执行该进程的指令，正在读写该进程的地址空间。</p></li><li style=\"margin: 8px 0px 0px 32px; padding: 0px; box-sizing: border-box; list-style: disc;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">就绪状态。该进程不需要等待什么事件发生，随时都可以执行，但CPU暂时还在执行另一个进程，所以该进程在一个就绪队列中等待被内核调度。系统中可能同时有多个就绪的进程，那么该调度谁执行呢？内核的调度算法是基于优先级和时间片的，而且会根据每个进程的运行情况动态调整它的优先级和时间片，让每个进程都能比较公平地得到机会执行，同时要兼顾用户体验，不能让和用户交互的进程响应太慢。</p></li></ul></div><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">下面这个小程序从终端读数据再写回终端。</p><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-size: 16px; font-family: arial, helvetica, sans-serif;\"><span style=\"box-sizing: border-box; font-weight: 700;\">阻塞读终端</span></span><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-family: arial, helvetica, sans-serif; font-size: 16px;\"></span></span></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 1683px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_3\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_3\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=3&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;unistd.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;stdlib.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;main(</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">char</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;buf[</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;n;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;read(STDIN_FILENO,&nbsp;buf,&nbsp;<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;(n&nbsp;&lt;&nbsp;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perror(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"read&nbsp;STDIN_FILENO\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;buf,&nbsp;n);&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">return</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-family: arial, helvetica, sans-serif; font-size: 14px;\">执行结果如下：</span><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"></span></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 2069px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_4\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_4\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=4&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">[root</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">@localhost</span><span class=\"vars\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(221, 0, 0);\">&nbsp;apue2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">]#&nbsp;./a</span><span class=\"xcodeconstants\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">.out</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">hello&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">hello&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">[root<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">@localhost</span><span class=\"vars\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(221, 0, 0);\">&nbsp;apue2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">]#&nbsp;./a</span><span class=\"xcodeconstants\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">.out</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">hello&nbsp;world&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">hello&nbsp;worl[root<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">@localhost</span><span class=\"vars\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(221, 0, 0);\">&nbsp;apue2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">]#&nbsp;d&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">bash:<span class=\"vars\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(221, 0, 0);\">&nbsp;d</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">:&nbsp;command&nbsp;not&nbsp;found&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">[root<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">@localhost</span><span class=\"vars\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(221, 0, 0);\">&nbsp;apue2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">]#&nbsp;&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-family: arial, helvetica, sans-serif;\"></span></p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">第一次执行<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>的结果很正常，而第二次执行的过程有点特殊，现在分析一下：</p><div class=\"orderedlist\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-family: arial, helvetica, sans-serif; font-size: 14px;\"><ol type=\"1\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style: none;\"><li style=\"margin: 8px 0px 0px 40px; padding: 0px; box-sizing: border-box; list-style: decimal;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\">Shell进程创建<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>进程，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>进程开始执行，而Shell进程睡眠等待<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>进程退出。</p></li><li style=\"margin: 8px 0px 0px 40px; padding: 0px; box-sizing: border-box; list-style: decimal;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\"><code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>调用<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>时睡眠等待，直到终端设备输入了换行符才从<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>返回，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>只读走10个字符，剩下的字符仍然保存在内核的终端设备输入缓冲区中。</p></li><li style=\"margin: 8px 0px 0px 40px; padding: 0px; box-sizing: border-box; list-style: decimal;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify;\"><code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">a.out</code>进程打印并退出，这时Shell进程恢复运行，Shell继续从终端读取用户输入的命令，于是读走了终端设备输入缓冲区中剩下的字符d和换行符，把它当成一条命令解释执行，结果发现执行不了，没有d这个命令。</p></li></ol></div><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">如果在<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">open</code>一个设备时指定了<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">O_NONBLOCK</code>标志，<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>/<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">write</code>就不会阻塞。以<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>为例，如果设备暂时没有数据可读就返回-1，同时置<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">errno</code>为<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">EWOULDBLOCK</code>（或者<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">EAGAIN</code>，这两个宏定义的值相同），表示本来应该阻塞在这里（would block，虚拟语气），事实上并没有阻塞而是直接返回错误，调用者应该试着再读一次（again）。这种行为方式称为轮询（Poll）<a id=\"id2852596\" class=\"indexterm\" target=\"_blank\" style=\"color: rgb(0, 0, 255); outline: 0px; margin: 0px; padding: 0px; box-sizing: border-box; text-decoration: underline;\"></a>，调用者只是查询一下，而不是阻塞在这里死等，这样可以同时监视多个设备：</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\"></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 2678px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_5\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_5\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=5&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">while</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;非阻塞read(设备<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(设备</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">有数据到达)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;处理数据;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;非阻塞read(设备<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(设备</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">有数据到达)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;处理数据;&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">如果<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read(设备1)</code>是阻塞的，那么只要设备1没有数据到达就会一直阻塞在设备1的<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">read</code>调用上，即使设备2有数据到达也不能处理，使用非阻塞I/O就可以避免设备2得不到及时处理。</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">非阻塞I/O有一个缺点，如果所有设备都一直没有数据到达，调用者需要反复查询做无用功，如果阻塞在那里，操作系统可以调度别的进程执行，就不会做无用功了。在使用非阻塞I/O时，通常不会在一个<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">while</code>循环中一直不停地查询（这称为Tight Loop<a id=\"id2852646\" class=\"indexterm\" target=\"_blank\" style=\"color: rgb(0, 0, 255); outline: 0px; margin: 0px; padding: 0px; box-sizing: border-box; text-decoration: underline;\"></a>），而是每延迟等待一会儿来查询一下，以免做太多无用功，在延迟等待的时候可以调度其它进程执行。</p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 3103px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_6\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_6\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=6&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">while</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;非阻塞read(设备<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(设备</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">有数据到达)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;处理数据;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;非阻塞read(设备<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(设备</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">2</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">有数据到达)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;处理数据;&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;sleep(n);&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">这样做的问题是，设备1有数据到达时可能不能及时处理，最长需延迟n秒才能处理，而且反复查询还是做了很多无用功。以后要学习的<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">select(2)</code>函数可以阻塞地同时监视多个设备，还可以设定阻塞等待的超时时间，从而圆满地解决了这个问题。</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">以下是一个非阻塞I/O的例子。目前我们学过的可能引起阻塞的设备只有终端，所以我们用终端来做这个实验。程序开始执行时在0、1、2文件描述符上自动打开的文件就是终端，但是没有<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">O_NONBLOCK</code>标志。读标准输入是阻塞的。我们可以重新打开一遍设备文件<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">/dev/tty</code>（表示当前终端），在打开时指定<code class=\"literal\" style=\"box-sizing: border-box; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;\">O_NONBLOCK</code>标志。</p><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(69, 69, 69); font-size: 16px; font-family: arial, helvetica, sans-serif;\"><span style=\"box-sizing: border-box; font-weight: 700;\">非阻塞读终端</span></span><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\"><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-family: arial, helvetica, sans-serif; font-size: 16px;\"></span></span></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 3587px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_7\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_7\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=7&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;unistd.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;fcntl.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;errno.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;string.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;stdlib.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#define&nbsp;MSG_TRY&nbsp;\"try&nbsp;again\\n\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;main(</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">char</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;buf[</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">];&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;fd,&nbsp;n;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;fd&nbsp;=&nbsp;open(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">,&nbsp;O_RDONLY|O_NONBLOCK);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(fd&lt;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perror(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"open&nbsp;/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">tryagain:&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;read(fd,&nbsp;buf,&nbsp;<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;(n&nbsp;&lt;&nbsp;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;(errno&nbsp;==&nbsp;EAGAIN)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;MSG_TRY,&nbsp;strlen(MSG_TRY));&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">goto</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;tryagain;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perror(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"read&nbsp;/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;buf,&nbsp;n);&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;close(fd);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">return</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">}&nbsp;&nbsp;</span></li></ol></div><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-size: 14px;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; font-family: arial, helvetica, sans-serif; font-size: 16px;\"><br style=\"box-sizing: border-box;\"></span></span></p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\">以下是用非阻塞I/O实现等待超时的例子。既保证了超时退出的逻辑又保证了有数据到达时处理延迟较小。</p><p style=\"margin: 0px 0px 16px; padding: 0px; box-sizing: border-box; font-size: 14px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; font-family: arial, helvetica, sans-serif;\"><span style=\"margin: 0px; padding: 0px; font-weight: bold; box-sizing: border-box; font-size: 16px;\">非阻塞读终端和等待超时</span></p><div class=\"dp-highlighter bg_objc\" style=\"margin: 0px 0px 24px; padding: 1px 0px 0px; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 693px; color: rgb(69, 69, 69);\"><div class=\"bar\" style=\"margin: 0px; padding: 0px 0px 0px 45px; box-sizing: border-box;\"><div class=\"tools\" style=\"margin: 0px; padding: 3px 8px 10px 10px; box-sizing: border-box; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box;\">[objc]</b>&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"ViewSource\" title=\"view plain\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span class=\"tracking-ad\" data-mod=\"popu_168\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\">&nbsp;<a href=\"http://blog.csdn.net/u012317833/article/details/39343915#\" class=\"CopyToClipboard\" title=\"copy\" style=\"color: rgb(103, 149, 181); outline: 0px; margin: 0px 10px 0px 0px; padding: 1px; box-sizing: border-box; text-decoration: none; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"margin: 0px; padding: 0px; box-sizing: border-box; position: absolute; left: 287px; top: 4341px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_8\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_8\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=8&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box;\"></div></span><span class=\"tracking-ad\" data-mod=\"popu_169\" style=\"margin: 0px; padding: 0px; box-sizing: border-box;\"></span></div></div><ol start=\"1\" class=\"dp-objc\" style=\"margin: 0px 0px 24px; padding: 0px; box-sizing: border-box; list-style-position: initial; list-style-image: initial; border-right-width: 1px; border-style: none solid none none; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92);\"><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;unistd.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;fcntl.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;errno.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;string.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#include&nbsp;&lt;stdlib.h&gt;</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#define&nbsp;MSG_TRY&nbsp;\"try&nbsp;again\\n\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"xcodepreprocessor\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">#define&nbsp;MSG_TIMEOUT&nbsp;\"timeout\\n\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\"><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;main(</span><span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">void</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">char</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;buf[</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">int</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;fd,&nbsp;n,&nbsp;i;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;fd&nbsp;=&nbsp;open(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">,&nbsp;O_RDONLY|O_NONBLOCK);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(fd&lt;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perror(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"open&nbsp;/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">for</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(i=</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;i&lt;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">5</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;read(fd,&nbsp;buf,&nbsp;<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(n&gt;=</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">break</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(errno!=EAGAIN)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perror(<span class=\"string\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 255);\">\"read&nbsp;/dev/tty\"</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(<span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">1</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;MSG_TRY,&nbsp;strlen(MSG_TRY));&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">if</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">(i==</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">5</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;MSG_TIMEOUT,&nbsp;strlen(MSG_TIMEOUT));&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">else</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO,&nbsp;buf,&nbsp;n);&nbsp;&nbsp;</span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;close(fd);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"margin: 0px; padding: 0px; font-weight: 700; box-sizing: border-box; color: rgb(0, 102, 153); font-size: 14px; border-top-left-radius: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px; border-bottom-left-radius: 2px; word-wrap: normal; border: none;\">return</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">&nbsp;</span><span class=\"xcodenumber\" style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">0</span><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"margin-top: 8px; margin-left: 40px; box-sizing: border-box; list-style: decimal outside; border-left-width: 3px; border-style: none none none solid; border-left-color: rgb(108, 226, 108); background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; margin-right: 0px !important; margin-bottom: 0px !important; padding: 0px 3px 0px 10px !important;\"><span style=\"margin: 0px; padding: 0px; box-sizing: border-box; border: none; color: rgb(0, 0, 0);\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; color: rgb(69, 69, 69); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 16px;\">"
    }
  ]
}
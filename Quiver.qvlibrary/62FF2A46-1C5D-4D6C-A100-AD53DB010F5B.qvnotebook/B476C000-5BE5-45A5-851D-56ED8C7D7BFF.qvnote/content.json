{
  "title": "epoll模型详解",
  "cells": [
    {
      "type": "text",
      "data": "\n\n\n\n\n\n\n<!--[if gte mso 9]><xml>\n <o:OfficeDocumentSettings>\n  <o:RelyOnVML/>\n  <o:AllowPNG/>\n </o:OfficeDocumentSettings>\n</xml><![endif]-->\n\n<!--[if gte mso 9]><xml>\n <w:WordDocument>\n  <w:View>Normal</w:View>\n  <w:Zoom>0</w:Zoom>\n  <w:TrackMoves/>\n  <w:TrackFormatting/>\n  <w:PunctuationKerning/>\n  <w:DrawingGridVerticalSpacing>10 磅</w:DrawingGridVerticalSpacing>\n  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>\n  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>\n  <w:ValidateAgainstSchemas/>\n  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>\n  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>\n  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>\n  <w:DoNotPromoteQF/>\n  <w:LidThemeOther>EN-US</w:LidThemeOther>\n  <w:LidThemeAsian>ZH-CN</w:LidThemeAsian>\n  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>\n  <w:Compatibility>\n   <w:SpaceForUL/>\n   <w:BalanceSingleByteDoubleByteWidth/>\n   <w:DoNotLeaveBackslashAlone/>\n   <w:ULTrailSpace/>\n   <w:DoNotExpandShiftReturn/>\n   <w:AdjustLineHeightInTable/>\n   <w:BreakWrappedTables/>\n   <w:SnapToGridInCell/>\n   <w:WrapTextWithPunct/>\n   <w:UseAsianBreakRules/>\n   <w:DontGrowAutofit/>\n   <w:SplitPgBreakAndParaMark/>\n   <w:EnableOpenTypeKerning/>\n   <w:DontFlipMirrorIndents/>\n   <w:OverrideTableStyleHps/>\n   <w:UseFELayout/>\n  </w:Compatibility>\n  <m:mathPr>\n   <m:mathFont m:val=\"Cambria Math\"/>\n   <m:brkBin m:val=\"before\"/>\n   <m:brkBinSub m:val=\"&#45;-\"/>\n   <m:smallFrac m:val=\"off\"/>\n   <m:dispDef/>\n   <m:lMargin m:val=\"0\"/>\n   <m:rMargin m:val=\"0\"/>\n   <m:defJc m:val=\"centerGroup\"/>\n   <m:wrapIndent m:val=\"1440\"/>\n   <m:intLim m:val=\"subSup\"/>\n   <m:naryLim m:val=\"undOvr\"/>\n  </m:mathPr></w:WordDocument>\n</xml><![endif]--><!--[if gte mso 9]><xml>\n <w:LatentStyles DefLockedState=\"false\" DefUnhideWhenUsed=\"false\"\n  DefSemiHidden=\"false\" DefQFormat=\"false\" DefPriority=\"99\"\n  LatentStyleCount=\"382\">\n  <w:LsdException Locked=\"false\" Priority=\"0\" QFormat=\"true\" Name=\"Normal\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" QFormat=\"true\" Name=\"heading 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 7\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 8\"/>\n  <w:LsdException Locked=\"false\" Priority=\"9\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"heading 9\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 6\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 7\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 8\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index 9\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 7\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 8\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"toc 9\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Normal Indent\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"footnote text\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"annotation text\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"header\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"footer\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"index heading\"/>\n  <w:LsdException Locked=\"false\" Priority=\"35\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"caption\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"table of figures\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"envelope address\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"envelope return\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"footnote reference\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"annotation reference\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"line number\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"page number\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"endnote reference\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"endnote text\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"table of authorities\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"macro\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"toa heading\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Bullet\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Number\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Bullet 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Bullet 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Bullet 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Bullet 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Number 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Number 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Number 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Number 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"10\" QFormat=\"true\" Name=\"Title\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Closing\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Signature\"/>\n  <w:LsdException Locked=\"false\" Priority=\"1\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"Default Paragraph Font\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text Indent\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Continue\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Continue 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Continue 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Continue 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"List Continue 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Message Header\"/>\n  <w:LsdException Locked=\"false\" Priority=\"11\" QFormat=\"true\" Name=\"Subtitle\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Salutation\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Date\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text First Indent\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text First Indent 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Heading\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text Indent 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Body Text Indent 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Block Text\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"Hyperlink\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"FollowedHyperlink\"/>\n  <w:LsdException Locked=\"false\" Priority=\"22\" QFormat=\"true\" Name=\"Strong\"/>\n  <w:LsdException Locked=\"false\" Priority=\"20\" QFormat=\"true\" Name=\"Emphasis\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Document Map\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Plain Text\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"E-mail Signature\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Top of Form\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Bottom of Form\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"Normal (Web)\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Acronym\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Address\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Cite\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Code\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Definition\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Keyboard\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Preformatted\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Sample\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Typewriter\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"HTML Variable\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Normal Table\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"annotation subject\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"No List\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Outline List 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Outline List 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Outline List 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Simple 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Simple 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Simple 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Classic 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Classic 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Classic 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Classic 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Colorful 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Colorful 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Colorful 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Columns 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Columns 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Columns 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Columns 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Columns 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 6\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 7\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Grid 8\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 6\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 7\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table List 8\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table 3D effects 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table 3D effects 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table 3D effects 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Contemporary\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Elegant\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Professional\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Subtle 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Subtle 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Web 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Web 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Web 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Balloon Text\"/>\n  <w:LsdException Locked=\"false\" Priority=\"0\" Name=\"Table Grid\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Table Theme\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 2\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 3\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 4\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 5\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 6\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 7\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 8\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Note Level 9\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" Name=\"Placeholder Text\"/>\n  <w:LsdException Locked=\"false\" Priority=\"1\" QFormat=\"true\" Name=\"No Spacing\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 1\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" Name=\"Revision\"/>\n  <w:LsdException Locked=\"false\" Priority=\"34\" QFormat=\"true\"\n   Name=\"List Paragraph\"/>\n  <w:LsdException Locked=\"false\" Priority=\"29\" QFormat=\"true\" Name=\"Quote\"/>\n  <w:LsdException Locked=\"false\" Priority=\"30\" QFormat=\"true\"\n   Name=\"Intense Quote\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"60\" Name=\"Light Shading Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"61\" Name=\"Light List Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"62\" Name=\"Light Grid Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"63\" Name=\"Medium Shading 1 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"64\" Name=\"Medium Shading 2 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"65\" Name=\"Medium List 1 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"66\" Name=\"Medium List 2 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"67\" Name=\"Medium Grid 1 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"68\" Name=\"Medium Grid 2 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"69\" Name=\"Medium Grid 3 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"70\" Name=\"Dark List Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"71\" Name=\"Colorful Shading Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"72\" Name=\"Colorful List Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"73\" Name=\"Colorful Grid Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"19\" QFormat=\"true\"\n   Name=\"Subtle Emphasis\"/>\n  <w:LsdException Locked=\"false\" Priority=\"21\" QFormat=\"true\"\n   Name=\"Intense Emphasis\"/>\n  <w:LsdException Locked=\"false\" Priority=\"31\" QFormat=\"true\"\n   Name=\"Subtle Reference\"/>\n  <w:LsdException Locked=\"false\" Priority=\"32\" QFormat=\"true\"\n   Name=\"Intense Reference\"/>\n  <w:LsdException Locked=\"false\" Priority=\"33\" QFormat=\"true\" Name=\"Book Title\"/>\n  <w:LsdException Locked=\"false\" Priority=\"37\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" Name=\"Bibliography\"/>\n  <w:LsdException Locked=\"false\" Priority=\"39\" SemiHidden=\"true\"\n   UnhideWhenUsed=\"true\" QFormat=\"true\" Name=\"TOC Heading\"/>\n  <w:LsdException Locked=\"false\" Priority=\"41\" Name=\"Plain Table 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"42\" Name=\"Plain Table 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"43\" Name=\"Plain Table 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"44\" Name=\"Plain Table 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"45\" Name=\"Plain Table 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"40\" Name=\"Grid Table Light\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\" Name=\"Grid Table 1 Light\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\" Name=\"Grid Table 6 Colorful\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\" Name=\"Grid Table 7 Colorful\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"Grid Table 1 Light Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"Grid Table 2 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"Grid Table 3 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"Grid Table 4 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"Grid Table 5 Dark Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"Grid Table 6 Colorful Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"Grid Table 7 Colorful Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\" Name=\"List Table 1 Light\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\" Name=\"List Table 6 Colorful\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\" Name=\"List Table 7 Colorful\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 1\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 2\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 3\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 4\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 5\"/>\n  <w:LsdException Locked=\"false\" Priority=\"46\"\n   Name=\"List Table 1 Light Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"47\" Name=\"List Table 2 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"48\" Name=\"List Table 3 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"49\" Name=\"List Table 4 Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"50\" Name=\"List Table 5 Dark Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"51\"\n   Name=\"List Table 6 Colorful Accent 6\"/>\n  <w:LsdException Locked=\"false\" Priority=\"52\"\n   Name=\"List Table 7 Colorful Accent 6\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Mention\"/>\n  <w:LsdException Locked=\"false\" SemiHidden=\"true\" UnhideWhenUsed=\"true\"\n   Name=\"Smart Hyperlink\"/>\n </w:LatentStyles>\n</xml><![endif]-->\n\n<!--[if gte mso 10]>\n<style>\n /* Style Definitions */\ntable.MsoNormalTable\n\t{mso-style-name:普通表格;\n\tmso-tstyle-rowband-size:0;\n\tmso-tstyle-colband-size:0;\n\tmso-style-noshow:yes;\n\tmso-style-priority:99;\n\tmso-style-parent:\"\";\n\tmso-padding-alt:0cm 5.4pt 0cm 5.4pt;\n\tmso-para-margin:0cm;\n\tmso-para-margin-bottom:.0001pt;\n\tmso-pagination:widow-orphan;\n\tfont-size:10.5pt;\n\tmso-bidi-font-size:11.0pt;\n\tfont-family:\"Calibri\",sans-serif;\n\tmso-ascii-font-family:Calibri;\n\tmso-ascii-theme-font:minor-latin;\n\tmso-hansi-font-family:Calibri;\n\tmso-hansi-theme-font:minor-latin;\n\tmso-font-kerning:1.0pt;}\n</style>\n<![endif]-->\n\n\n\n<!--StartFragment-->\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">linux</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的网络编程中，很长的时间都在使用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">来做事件触发。在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">linux</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">新的内核中，有了一种替换它的机制，就是</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">。</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">相比于</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">最大的好处在于它不会随着监听</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">数目的增长而降低效率。因为在内核中的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">实现中，它是采用轮询来处理的，轮询的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">数目越多，自然耗时越多。并且，在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">linux/posix_types.h</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">头文件有这样的声明：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define __FD_SETSIZE&nbsp;&nbsp;&nbsp;\n1024<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">表示</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">最多同时监听</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">1024</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">个</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">，当然，可以通过修改头文件再重编译内核来扩大这个数目，但这似乎并不治本。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">的接口非常简单，一共就三个函数：</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\">1. int\nepoll_create(int size);<o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">创建一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的句柄，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">size</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">用来告诉内核这个监听的数目一共有多大。这个参数不同于</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">中的第一个参数，给出最大监听的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd+1</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的值。需要注意的是，当创建好</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">句柄后，它就是会占用一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">值，在</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">linux</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">下如果查看</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">/proc/</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">进程</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">id/fd/</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，是能够看到这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">的，所以在使用完</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">后，必须调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">close()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">关闭，否则可能导致</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">被耗尽。</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\">2. int\nepoll_ctl(int epfd, int op, int fd, struct epoll_event *event);<o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">的事件注册函数，它不同与</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">是在监听事件时告诉内核要监听什么类型的事件，而是在这里先注册要监听的事件类型。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">第一个</span></b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">参数是</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_create()</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">的返回值，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">第二个</span></b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">参数表示动作，用三个宏来表示：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLL_CTL_ADD</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：注册新的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">到</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epfd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">中；</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLL_CTL_MOD</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：修改已经注册的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的监听事件；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLL_CTL_DEL</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：从</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epfd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">中删除一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">；</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">第三个</span></b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">参数是需要监听的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">第四个</span></b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">参数是告诉内核需要监听什么事，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct epoll_event</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">结构如下：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct epoll_event\n{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; __uint32_t events;&nbsp; /* Epoll events */<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; epoll_data_t data;&nbsp; /* User data variable */<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">};<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">events</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">可以是以下几个宏的集合：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLIN </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">表示对应的文件描述符可以读（包括对端</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">SOCKET</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">正常关闭）；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLOUT</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">表示对应的文件描述符可以写；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLPRI</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">表示对应的文件描述符有紧急的数据可读（这里应该表示有带外数据到来）；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLERR</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">表示对应的文件描述符发生错误；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLHUP</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">表示对应的文件描述符被挂断；</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLET</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">将</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLL</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">设为边缘触发</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(Edge Triggered)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">模式，这是相对于水平触发</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(Level Triggered)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">来说的。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLONESHOT</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">：</span><span style=\"font-size:16.0pt\"> </span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">只监听一次事件，当监听完这次事件之后，如果还需要继续监听这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的话，需要再次把这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">加入到</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">EPOLL</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">队列里</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\">3. int\nepoll_wait(int epfd, struct epoll_event * events, int maxevents, int timeout);<o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">等待事件的产生，类似于</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">调用。参数</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">events</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">用来从内核得到事件的集合，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">maxevents</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">告之内核这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">events</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">有多大，这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">maxevents</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的值不能大于创建</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_create()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">时的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">size</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，参数</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">timeout</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">是超时时间（毫秒，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">0</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">会立即返回，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">-1</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">将不确定，也有说法说是永久阻塞）。该函数返回需要处理的事件数目，如返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">0</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">表示已超时。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">从</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">man</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">手册中，得到</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">和</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">LT</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">的具体描述如下</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLL</span></b><b><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">事件有两种模型：</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\">Edge Triggered (ET)&nbsp; </span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:red\">边缘触发</span></b><b><span style=\"font-size:16.0pt;color:red\"> </span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:red\">只有数据到来，才触发，不管缓存区中是否还有数据。</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;color:red\">Level Triggered (LT)&nbsp; </span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:red\">水平触发</span></b><b><span style=\"font-size:16.0pt;color:red\"> </span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:red\">只要有数据都会触发。</span></b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">假如有这样一个例子：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">1. </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">我们已经把一个用来从管道中读取数据的文件句柄</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(RFD)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">添加到</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">描述符</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">2. </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">这个时候从管道的另一端被写入了</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">2KB</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的数据</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">3. </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_wait(2)</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">，并且它会返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">RFD</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，说明它已经准备好读取操作</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">4. </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">然后我们读取了</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">1KB</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的数据</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">5. </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_wait(2)......<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt\">Edge Triggered </span></b><b><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">工作模式：</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">如果我们在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">1</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">步将</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">RFD</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">添加到</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">描述符的时候使用了</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLET</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">标志，那么在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">5</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">步调用</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">epoll_wait(2)</span><span style=\"font-size:16.0pt;font-family:宋体;\nmso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">之后将有可能会挂起，因为剩余的数据还存在于文件的输入缓冲区内，而且数据发出端还在等待一个针对已经发出数据的反馈信息。只有在监视的文件句柄上发生了某个事件的时候</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"> ET </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">工作模式才会汇报事件。因此在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">5</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">步的时候，调用者可能会放弃等待仍在存在于文件输入缓冲区内的剩余数据。在上面的例子中，会有一个事件产生在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">RFD</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">句柄上，因为在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">2</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">步执行了一个写操作，然后，事件将会在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">3</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">步被销毁。因为第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">4</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">步的读取操作没有读空文件输入缓冲区内的数据，因此我们在第</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">5</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">步调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"> epoll_wait(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">完成后，是否挂起是不确定的。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">工作在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">模式的时候，必须使用非阻塞套接口，以避免由于一个文件句柄的阻塞读</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">/</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">阻塞写操作把处理多个文件描述符的任务饿死。最好以下面的方式调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">模式的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">接口，在后面会介绍避免可能的缺陷。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; i&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">基于非阻塞文件句柄</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; ii&nbsp;&nbsp; </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">只有当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">read(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">或者</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">write(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EAGAIN</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">时才需要挂起，等待。但这并不是说每次</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">read()</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">时都需要循环读，直到读到产生一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EAGAIN</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">才认为此次事件处理完成，当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">read()</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">返回的读到的数据长度小于请求的数据长度时，就可以确定此时缓冲中已没有数据了，也就可以认为此事读事件已处理完成。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt\">Level Triggered </span></b><b><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">工作模式</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">相反的，以</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">LT</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">方式调用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">接口的时候，它就相当于一个速度比较快的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">poll(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">，并且无论后面的数据是否被使用，因此他们具有同样的职能。因为即使使用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">模式的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，在收到多个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">chunk</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">的数据的时候仍然会产生多个事件。调用者可以设定</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLONESHOT</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">标志，在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"> epoll_wait(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">收到事件后</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">会与事件关联的文件句柄从</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">描述符中禁止掉。因此当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLONESHOT</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">设定后，使用带有</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"> EPOLL_CTL_MOD</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">标志的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_ctl(2)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">处理文件句柄就成为调用者必须作的事情。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">然后详细解释</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET,\nLT:</span></b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;\ncolor:blue\">LT(level triggered)</span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:blue\">是</span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:red\">缺省</span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:blue\">的工作方式</span></b><span style=\"font-size:16.0pt;font-family:宋体;\nmso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，并且同时支持</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">block</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">和</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">no-block socket.</span><span style=\"font-size:16.0pt;font-family:宋体;\nmso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">在这种做法中，内核告诉你一个文件描述符是否就绪了，然后你可以对这个就绪的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">进行</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">IO</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">操作。如果你不作任何操作，内核还是会继续通知你的，所以，这种模式编程出错误可能性要小一点。传统的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select/poll</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">都是这种模型的代表．</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><b><span lang=\"EN-US\" style=\"font-size:16.0pt;\ncolor:blue\">ET(edge-triggered)</span></b><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;\ncolor:blue\">是高速工作方式</span></b><span style=\"font-size:16.0pt;font-family:宋体;\nmso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，只支持</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">no-block socket</span><span style=\"font-size:16.0pt;font-family:宋体;\nmso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">。在这种模式下，当描述符从未就绪变为就绪时，内核通过</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">告诉你。然后它会假设你知道文件描述符已经就绪，并且不会再为那个文件描述符发送更多的就绪通知，直到你做了某些操作导致那个文件描述符不再为就绪状态了</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">比如，你在发送，接收或者接收请求，或者发送接收的数据少于一定量时导致了一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EWOULDBLOCK </span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">错误）。但是请注意，如果一直不对这个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">fd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">作</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">IO</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">操作</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">(</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">从而导致它再次变成未就绪</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">)</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">，内核不会发送更多的通知</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(only once),</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">不过在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">TCP</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">协议中，</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">ET</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">模式的加速效用仍需要更多的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">benchmark</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">确认（这句话不理解）。</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">在许多测试中我们会看到如果没有大量的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">idle -connection</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">或者</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">dead-connection</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的效率并不会比</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select/poll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">高很多，但是当我们遇到大量的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">idle- connection(</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">例如</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">WAN</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">环境中存在大量的慢速连接</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">)</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">，就会发现</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">的效率大大高于</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">select/poll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">。（未测试）</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:32.0pt;mso-char-indent-count:2.0\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">另外，当使用</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ET</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">模型来工作时，当产生了一个</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLIN</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">事件后，</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">读数据的时候需要考虑的是当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">recv()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">返回的大小如果等于请求的大小，那么很有可能是缓冲区还有数据未读完，也意味着该次事件还没有处理完，所以还需要再次读取：</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">while(rs)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; buflen = recv(activeevents[i].data.fd, buf,\nsizeof(buf), 0);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; if(buflen &lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">由于是非阻塞的模式</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">所以当</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">errno</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">为</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EAGAIN</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">时</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">表示当前缓冲区已无数据可读</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">在这里就当作是该次事件已处理处</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; if(errno == EAGAIN)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; break;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; return;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; else if(buflen == 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">这里表示对端的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">已正常关闭</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; if(buflen == sizeof(buf)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; rs = 1;&nbsp;&nbsp;\n// </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">需要再次读取</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp; else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; rs = 0;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">}<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\" style=\"text-indent:24.0pt;mso-char-indent-count:1.5\"><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">还有，假如发送端流量大于接收端的流量</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">意思是</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">所在的程序读比转发的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">要快</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">),</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">由于是非阻塞的</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket,</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">那么</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">send()</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">函数虽然返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">但实际缓冲区的数据并未真正发给接收端</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">这样不断的读和发，当缓冲区满后会产生</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EAGAIN</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">错误</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">(</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">参考</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">man send),</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">同时</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">不理会这次请求发送的数据</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">所以</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">需要封装</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket_send()</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">的函数用来处理这种情况</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">该函数会尽量将数据写完再返回，返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">-1</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">表示出错。在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket_send()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">内部</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">当写缓冲已满</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">(send()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">-1,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">且</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">errno</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">为</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EAGAIN),</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">那么会等待后再重试</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">这种方式并不很完美</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">在理论上可能会长时间的阻塞在</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket_send()</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">内部</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">但暂没有更好的办法</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">ssize_t\nsocket_send(int sockfd, const char* buffer, size_t buflen)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; ssize_t tmp;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; size_t total = buflen;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; const char *p = buffer;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; while(1)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; tmp = send(sockfd, p, total, 0);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; if(tmp &lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">send</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">收到信号时</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">可以继续写</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">但这里返回</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">-1.<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(errno == EINTR)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">当</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">是非阻塞时</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">如返回此错误</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">表示写缓冲队列已满</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // </span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">在这里做延时后再重试</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">.<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(errno == EAGAIN)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; usleep(1000);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; if((size_t)tmp == total)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return buflen;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; total -= tmp;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp; p += tmp;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp; return tmp;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">}<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\" align=\"center\" style=\"text-align:center\"><b><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">代码：</span></b><b><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></b></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;iostream&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;sys/socket.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;sys/epoll.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;netinet/in.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;arpa/inet.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;fcntl.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;unistd.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;stdio.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;pthread.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#include\n&lt;errno.h&gt;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define MAXLINE 10<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define OPEN_MAX\n100<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define LISTENQ 20<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define SERV_PORT\n5555<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">#define INFTIM\n1000<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">//</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">线程池任务队列结构体</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct task<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; int fd; //</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">需要读写的文件描述符</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct task *next; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">下一个任务</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">};<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">//</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">用于读写两个的两个方面传递参数</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct user_data<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; int fd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; unsigned int n_size;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; char line[MAXLINE];<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">};<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">//</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">线程的任务函数</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">void *\nreadtask(void *args);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">void *\nwritetask(void *args);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">//</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">声明</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll_event</span><span style=\"font-size:\n16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">结构体的变量</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,ev</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">用于注册事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">,</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">数组用于回传要处理的事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct epoll_event\nev, events[20];<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">int epfd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">pthread_mutex_t\nmutex;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">pthread_cond_t\ncond1;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">struct task\n*readhead = NULL, *readtail = NULL, *writehead = NULL;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">void\nsetnonblocking(int sock)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; int opts;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; opts = fcntl(sock, F_GETFL);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; if (opts &lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror(\"fcntl(sock,GETFL)\");<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(1);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; opts = opts | O_NONBLOCK;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; if (fcntl(sock, F_SETFL, opts) &lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror(\"fcntl(sock,SETFL,opts)\");<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(1);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">}<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">int main()<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; int i, maxi, listenfd, connfd, sockfd,\nnfds;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; pthread_t tid1, tid2;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct task *new_task = NULL;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct user_data *rdata = NULL;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; socklen_t clilen;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_init(&amp;mutex, NULL);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; pthread_cond_init(&amp;cond1, NULL);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">初始化用于读线程池的线程</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; pthread_create(&amp;tid1, NULL, readtask,\nNULL);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; pthread_create(&amp;tid2, NULL, readtask,\nNULL);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">生成用于处理</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">accept</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">的</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:\nCalibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">专用的文件描述符</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; epfd = epoll_create(256);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p>&nbsp;</o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct sockaddr_in clientaddr;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct sockaddr_in serveraddr;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; listenfd = socket(AF_INET, SOCK_STREAM, 0);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">把</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">socket</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">设置为非阻塞方式</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; setnonblocking(listenfd);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">设置与要处理的事件相关的文件描述符</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; ev.data.fd = listenfd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">设置要处理的事件类型</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; ev.events = EPOLLIN | EPOLLET;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">注册</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">事件</span><span lang=\"EN-US\" style=\"font-size:\n16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; epoll_ctl(epfd, EPOLL_CTL_ADD, listenfd,\n&amp;ev);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; bzero(&amp;serveraddr, sizeof(serveraddr));<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; serveraddr.sin_family = AF_INET;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; char *local_addr =\n\"200.200.200.222\";<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; inet_aton(local_addr,\n&amp;(serveraddr.sin_addr));//htons(SERV_PORT);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; serveraddr.sin_port = htons(SERV_PORT);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; bind(listenfd, (sockaddr *)\n&amp;serveraddr, sizeof(serveraddr));<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; listen(listenfd, LISTENQ);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; maxi = 0;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; for (;;)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">等待</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">epoll</span><span style=\"font-size:16.0pt;font-family:\n宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:\n宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;\nmso-hansi-theme-font:minor-latin\">事件的发生</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nfds = epoll_wait(epfd, events, 20,\n500);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">处理所发生的所有事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; nfds; ++i)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (events[i].data.fd ==\nlistenfd)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connfd = accept(listenfd,\n(sockaddr *) &amp;clientaddr, &amp;clilen);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (connfd &lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror(\"connfd&lt;0\");<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(1);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setnonblocking(connfd);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char *str =\ninet_ntoa(clientaddr.sin_addr);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt;\n\"connec_ from &gt;&gt;\" &lt;&lt; str &lt;&lt; std::endl;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置用于读操作的文件描述符</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.data.fd = connfd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置用于注测的读操作事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.events = EPOLLIN |\nEPOLLET;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">注册</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">ev<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epoll_ctl(epfd,\nEPOLL_CTL_ADD, connfd, &amp;ev);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\nelse<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (events[i].events &amp;\nEPOLLIN)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(\"reading!\\n\");<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ((sockfd =\nevents[i].data.fd) &lt; 0) continue;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_task = new task();<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_task-&gt;fd =\nsockfd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_task-&gt;next =\nNULL;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">添加新的读任务</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_lock(&amp;mutex);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (readhead == NULL)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readhead =\nnew_task;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readtail =\nnew_task;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readtail-&gt;next\n= new_task;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readtail =\nnew_task;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">唤醒所有等待</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">cond1</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">条件的线程</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_cond_broadcast(&amp;cond1);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_unlock(&amp;mutex);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\nelse<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (events[i].events\n&amp; EPOLLOUT)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rdata = (struct\nuser_data *) events[i].data.ptr;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sockfd =\nrdata-&gt;fd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; write(sockfd,\nrdata-&gt;line, rdata-&gt;n_size);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete rdata;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置用于读操作的文件描述符</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.data.fd =\nsockfd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置用于注测的读操作事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.events =\nEPOLLIN | EPOLLET;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">修改</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">sockfd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">上要处理的事件为</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLIN<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epoll_ctl(epfd,\nEPOLL_CTL_MOD, sockfd, &amp;ev);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">}<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">void *\nreadtask(void *args)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">{<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; int fd = -1;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; unsigned int n;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">用于把读出来的数据传递出去</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; struct user_data *data = NULL;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; while (1)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_lock(&amp;mutex);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">等待到任务队列不为空</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (readhead == NULL)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_cond_wait(&amp;cond1,\n&amp;mutex);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd = readhead-&gt;fd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">从任务队列取出一个读任务</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struct task *tmp = readhead;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readhead = readhead-&gt;next;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete tmp;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_unlock(&amp;mutex);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data = new user_data();<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data-&gt;fd = fd;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ((n = read(fd, data-&gt;line, MAXLINE))\n&lt; 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (errno == ECONNRESET)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close(fd);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt;\n\"readline error\" &lt;&lt; std::endl;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data != NULL) delete data;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (n == 0)<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close(fd);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(\"Client close\nconnect!\\n\");<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data != NULL) delete\ndata;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data-&gt;n_size = n;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置需要传递出去的数据</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.data.ptr = data;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">设置用于注测的写操作事件</span><span lang=\"EN-US\" style=\"font-size:16.0pt\"><o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ev.events = EPOLLOUT |\nEPOLLET;<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style=\"font-size:16.0pt;font-family:宋体;mso-ascii-font-family:Calibri;\nmso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:\nminor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin\">修改</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">sockfd</span><span style=\"font-size:16.0pt;\nfont-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;\nmso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:\nCalibri;mso-hansi-theme-font:minor-latin\">上要处理的事件为</span><span lang=\"EN-US\" style=\"font-size:16.0pt\">EPOLLOUT<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epoll_ctl(epfd,\nEPOLL_CTL_MOD, fd, &amp;ev);<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>\n\n<p class=\"MsoNormal\"><span lang=\"EN-US\" style=\"font-size:16.0pt\">}<o:p></o:p></span></p>\n\n<!--EndFragment-->"
    }
  ]
}
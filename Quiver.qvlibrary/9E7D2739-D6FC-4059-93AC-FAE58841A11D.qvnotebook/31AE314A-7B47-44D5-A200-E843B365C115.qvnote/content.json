{
  "title": "在CentOS 7.2下升级gcc6.2编译器的版本",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　默认情况下，CentOS 7.2预装的gcc版本是4.8.x，通过执行命令&nbsp;<span class=\"cnblogs_code\"><span style=\"color: rgb(0, 0, 255);\">gcc</span>&nbsp;-v</span>&nbsp;可以看到，一般情况下这个版本的编译器已经满足需要了，但是某些特殊的时候为了支持C++更高的特性，需要对gcc编译器的版本进行升级，比如安装最新的Mariadb 10的时候，就需要使用高版本的gcc，具体升级过程如下：</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　 　首先去官网下载gcc的高版本安装包，镜像列表是：<a href=\"https://gcc.gnu.org/mirrors.html\">https://gcc.gnu.org/mirrors.html</a>&nbsp;进入后选择其中的镜像站，下载gcc即可，我这里要从4.8升级到4.9，所以这里下载的版本是4.9.3 下载地址是：<a href=\"http://fr.mirror.babylon.network/gcc/releases/gcc-4.9.3/\">http://fr.mirror.babylon.network/gcc/releases/gcc-4.9.3/</a>&nbsp;下载其中的包为：gcc-4.9.3.tar.bz2</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　 　下载之后上传至Linux准备安装，如果此时直接进行编译安装，此时gcc会报出错误：configure: error: Building GCC requires GMP 4.2+, MPFR 2.4.0+ and MPC 0.8.0+. 也就是说安装该版本的GCC 需要GMP 版本 &gt;= 4.2 MPFR版本 &gt;= 2.4.0 MPC版本 &gt;= 0.8.0 这3个依赖缺一不可，并且这3个依赖之间也具有相互依赖关系，即gmp独立安装，mpfr依赖于gmp，mpc依赖于gmp和mpfr，虽然执行gcc目 录下的：&nbsp;<span class=\"cnblogs_code\">./contrib/download_prerequisites</span>&nbsp;可以解决依赖问题，但是一般国内下载速度比较慢，所以这里手动安装如下三个依赖：</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　这三个依赖分别是：gmp,mpfr和mpc，下载地址分别如下：</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　　　gmp：http://<a href=\"http://ftp.gnu.org/gnu/gmp/\">ftp.gnu.org/gnu/gmp/</a></span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　　　mpfr(GNU镜像)：<a href=\"http://ftp.gnu.org/gnu/mpfr/\">http://ftp.gnu.org/gnu/mpfr/</a>&nbsp;或者官网:<a href=\"http://www.mpfr.org/mpfr-current/\">http://www.mpfr.org/mpfr-current/</a></span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　　　mpc：http://<a href=\"http://ftp.gnu.org/gnu/mpc/\">ftp.gnu.org/gnu/mpc/</a></span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　三个软件包具体版本分别是：gmp-5.0.1.tar.gz，mpfr-3.1.5.tar.gz，mpc-1.0.3.tar.gz</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　首先安装gmp，命令如下：</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div><pre><span style=\"color: rgb(0, 0, 255);\">tar</span> -xvzf gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span>.<span style=\"color: rgb(0, 0, 255);\">tar</span><span style=\"color: rgb(0, 0, 0);\">.gz\ncd gmp</span>-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span>/\n<span style=\"color: rgb(0, 0, 255);\">mkdir</span><span style=\"color: rgb(0, 0, 0);\"> temp\ncd temp</span>/<span style=\"color: rgb(0, 0, 0);\">\n..</span>/configure --prefix=/usr/local/gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span> <span style=\"color: rgb(0, 0, 255);\">install</span></pre><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　这样就安装好了，注意：编译时建议指定安装位置，以便后面加载依赖，这里是/usr/local下</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; color: rgb(128, 0, 128); font-size: 18px;\">如果之前已经安装了这三个依赖库，但是没有指定位置，虽然可以安装成功，但是会在随后安装gcc6.2时出现错误，这时就需要重新安装，先进入安装文件执行make distclean,再安装。</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; color: rgb(128, 0, 128); font-size: 18px;\">eg：</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(128, 0, 128); font-size: 18px;\"><span style=\"color: rgb(128, 0, 128); font-family: 'Microsoft YaHei';\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cd gmp-6.1.2</span>&nbsp;&amp;&amp; make distclean</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(128, 0, 128); font-size: 18px;\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mkdir temp</span></p><pre style=\"color: rgb(0, 0, 0); font-size: 14px;\"><span style=\"color: rgb(128, 0, 128); font-size: 18px;\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cd temp/\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ../configure --prefix=/usr/local/gmp-6.1.2\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; make\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; make install</span></pre><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　然后安装mpfr，命令如下:</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div><pre><span style=\"color: rgb(0, 0, 255);\">tar</span> -xvzf mpfr-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span>.<span style=\"color: rgb(0, 0, 255);\">tar</span><span style=\"color: rgb(0, 0, 0);\">.gz\ncd mpfr</span>-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span>/\n<span style=\"color: rgb(0, 0, 255);\">mkdir</span><span style=\"color: rgb(0, 0, 0);\"> temp\ncd temp</span>/<span style=\"color: rgb(0, 0, 0);\">\n..</span>/configure --prefix=/usr/local/mpfr-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span> --with-gmp=/usr/local/gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span> <span style=\"color: rgb(0, 0, 255);\">install</span></pre><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　到这里mpfr安装完毕，并且必须添加--with-gmp导入gmp依赖，如果不加这个参数也会安装成功，但是后面安装GCC会报一个内部依赖的错误，如果这里不加会很麻烦，然后再安装mpc，命令如下：</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div><pre><span style=\"color: rgb(0, 0, 255);\">tar</span> -xvzf mpc-<span style=\"color: rgb(128, 0, 128);\">1.0</span>.<span style=\"color: rgb(128, 0, 128);\">3</span>.<span style=\"color: rgb(0, 0, 255);\">tar</span><span style=\"color: rgb(0, 0, 0);\">.gz\ncd mpc</span>-<span style=\"color: rgb(128, 0, 128);\">1.0</span>.<span style=\"color: rgb(128, 0, 128);\">3</span>/\n<span style=\"color: rgb(0, 0, 255);\">mkdir</span><span style=\"color: rgb(0, 0, 0);\"> temp\ncd temp</span>/<span style=\"color: rgb(0, 0, 0);\">\n..</span>/configure --prefix=/usr/local/mpc-<span style=\"color: rgb(128, 0, 128);\">1.0</span>.<span style=\"color: rgb(128, 0, 128);\">3</span> --with-gmp=/usr/local/gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span> --with-mpfr=/usr/local/mpfr-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span>\n<span style=\"color: rgb(0, 0, 255);\">make</span> <span style=\"color: rgb(0, 0, 255);\">install</span></pre><div class=\"cnblogs_code_toolbar\"><span class=\"cnblogs_code_copy\"><a title=\"复制代码\"><img src=\"quiver-image-url/51E409B11AA51C150090697429A953ED.gif\" alt=\"复制代码\" width=\"20\" height=\"20\"></a></span></div></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　同样一定要加上依赖的参数，现在mpc也安装完毕，然后执行&nbsp;<span class=\"cnblogs_code\">vim /etc/profile</span>&nbsp;编辑环境变量配置文件，直接在文件最后添加一行下面的变量：</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><pre>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/mpc-<span style=\"color: rgb(128, 0, 128);\">1.0</span>.<span style=\"color: rgb(128, 0, 128);\">3</span>/lib:/usr/local/gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span>/lib:/usr/local/mpfr-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span>/lib</pre></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　上面的路径要和实际安装时编译的路径一致，保存并退出后，执行&nbsp;<span class=\"cnblogs_code\">source /etc/profile</span>&nbsp;使环境变量生效</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　最后就可以开始安装gcc了，安装过程如下：</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><pre><span style=\"color: rgb(0, 0, 255);\">tar</span> -jxvf <span style=\"color: rgb(0, 0, 255);\">gcc</span>-<span style=\"color: rgb(128, 0, 128);\">4.9</span>.<span style=\"color: rgb(128, 0, 128);\">3</span>.<span style=\"color: rgb(0, 0, 255);\">tar</span><span style=\"color: rgb(0, 0, 0);\">.bz2\ncd </span><span style=\"color: rgb(0, 0, 255);\">gcc</span>-<span style=\"color: rgb(128, 0, 128);\">4.9</span>.<span style=\"color: rgb(128, 0, 128);\">3</span>/\n<span style=\"color: rgb(0, 0, 255);\">mkdir</span><span style=\"color: rgb(0, 0, 0);\"> output\ncd output</span>/<span style=\"color: rgb(0, 0, 0);\">\n..</span>/configure --disable-multilib --enable-languages=c,c++ --with-gmp=/usr/local/gmp-<span style=\"color: rgb(128, 0, 128);\">5.0</span>.<span style=\"color: rgb(128, 0, 128);\">1</span> --with-mpfr=/usr/local/mpfr-<span style=\"color: rgb(128, 0, 128);\">3.1</span>.<span style=\"color: rgb(128, 0, 128);\">5</span> --with-mpc=/usr/local/mpc-<span style=\"color: rgb(128, 0, 128);\">1.0</span>.<span style=\"color: rgb(128, 0, 128);\">3</span></pre></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　然后开始编译并且安装：</span></p><div class=\"cnblogs_code\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><pre><span style=\"color: rgb(0, 0, 255);\">make</span> -<span style=\"color: rgb(0, 0, 0);\">j4\n</span><span style=\"color: rgb(0, 0, 255);\">make</span> <span style=\"color: rgb(0, 0, 255);\">install</span></pre></div><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　make过程时间非常长，根据计算机配置不同，时间有所差别，一般来说半个小时到一个多小时都是正常的，因为gcc编译器相对来说还是比较庞大的一个项目的，安装成功之后执行&nbsp;<span class=\"cnblogs_code\"><span style=\"color: rgb(0, 0, 255);\">gcc</span>&nbsp;-v</span>&nbsp;或者&nbsp;<span class=\"cnblogs_code\"><span style=\"color: rgb(0, 0, 255);\">gcc</span>&nbsp;--version</span>&nbsp;查看新的版本信息如下：</span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　<img src=\"quiver-image-url/333B29F9D1A39F8DA73F667B4FDFB4A4.png\" alt=\"\" style=\"width: 634px;\" width=\"858\" height=\"195\"></span></p><p style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-family: 'Microsoft YaHei'; font-size: 16px;\">　　可以看到，新的gcc版本4.9.3已经生效了，现在gcc升级就完成了</span></p>"
    }
  ]
}
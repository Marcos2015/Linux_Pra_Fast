{
  "title": "Docker pull下来的镜像文件、创建出来的容器文件都存在本地的什么地方了？",
  "cells": [
    {
      "type": "text",
      "data": "<embed id=\"xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd\" type=\"application/thunder_download_plugin\" height=\"0\" width=\"0\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">非常好的问题，正好之前看到过一篇</span><a href=\"http://liubin.org/2014/03/10/about-docker-images-storage/\" target=\"_blank\" style=\"font-size: 14px; box-sizing: border-box; color: rgb(21, 95, 170); text-decoration: none; cursor: pointer; font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px; background-position: 0px 0px;\">翻译的文章</a><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">，我把其中的相关内容贴一下：</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">我们首先来看看 /var/lib/docker/这个文件夹下的内容。打开这个文件夹下的 repositories 文件，你将会看到类似下面这样的JSON 文件：</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><pre class=\"prettyprint\" style=\"font-size: 14px; box-sizing: border-box; overflow: hidden; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; padding: 16px; margin-top: 0px; margin-bottom: 10px; line-height: 20px; color: rgb(51, 51, 51); word-break: break-all; background-color: rgb(247, 247, 247); border: none; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;\">$&nbsp;sudo&nbsp;cat&nbsp;/var/lib/docker/repositories&nbsp;|&nbsp;python&nbsp;-mjson.tool\n{\n“Repositories”:&nbsp;{\n“ubuntu”:&nbsp;{\n“12.04″:&nbsp;“8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c”,\n“12.10″:&nbsp;“b750fe79269d2ec9a3c593ef05b4332b1d1a02a62b4accb2c21d589ff2f5f2dc”,\n“latest”:&nbsp;“8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c”,\n“precise”:&nbsp;“8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c”,\n“quantal”:&nbsp;“b750fe79269d2ec9a3c593ef05b4332b1d1a02a62b4accb2c21d589ff2f5f2dc”\n}\n}\n}\n</pre><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">看看，是不是正好和docker images的内容一致呢。</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><pre class=\"prettyprint\" style=\"font-size: 14px; box-sizing: border-box; overflow: hidden; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; padding: 16px; margin-top: 0px; margin-bottom: 10px; line-height: 20px; color: rgb(51, 51, 51); word-break: break-all; background-color: rgb(247, 247, 247); border: none; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;\">REPOSITORY&nbsp;TAG&nbsp;IMAGE&nbsp;ID&nbsp;CREATED&nbsp;SIZE\nubuntu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8dbd9e392a96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;months&nbsp;ago&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131.3&nbsp;MB&nbsp;(virtual&nbsp;131.3&nbsp;MB)\nubuntu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8dbd9e392a96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;months&nbsp;ago&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131.3&nbsp;MB&nbsp;(virtual&nbsp;131.3&nbsp;MB)\nubuntu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precise&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8dbd9e392a96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;months&nbsp;ago&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131.3&nbsp;MB&nbsp;(virtual&nbsp;131.3&nbsp;MB)\nubuntu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b750fe79269d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;months&nbsp;ago&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24.65&nbsp;kB&nbsp;(virtual&nbsp;179.7&nbsp;MB)\nubuntu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quantal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b750fe79269d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;months&nbsp;ago&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24.65&nbsp;kB&nbsp;(virtual&nbsp;179.7&nbsp;MB)\n</pre><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">接着，我们再来看看 /var/lib/docker/graph/这个文件夹：</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><pre class=\"prettyprint\" style=\"font-size: 14px; box-sizing: border-box; overflow: hidden; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; padding: 16px; margin-top: 0px; margin-bottom: 10px; line-height: 20px; color: rgb(51, 51, 51); word-break: break-all; background-color: rgb(247, 247, 247); border: none; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;\">$&nbsp;sudo&nbsp;ls&nbsp;-al&nbsp;/var/lib/docker/graph\ntotal&nbsp;24\ndrwx——&nbsp;6&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;.\ndrwx——&nbsp;5&nbsp;root&nbsp;root&nbsp;4096&nbsp;Dec&nbsp;13&nbsp;04:25&nbsp;..\ndrwxr-xr-x&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Dec&nbsp;13&nbsp;04:26&nbsp;27cf784147099545\ndrwxr-xr-x&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c\ndrwxr-xr-x&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;b750fe79269d2ec9a3c593ef05b4332b1d1a02a62b4accb2c21d589ff2f5f2dc\ndrwx——&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;_tmp\n</pre><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">这些输出结果可能有点晦涩（Not terribly friendly），但是从中我们可以看出Docker是使用repositories JSON文件来记述镜像信息的，此JSON文件包含了仓库名、标签、以及标签对应的镜像ID。</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">我们有两个来自ubuntu仓库的镜像，这其中标签为12.04，precise和latest都指向的是同一个镜像，其ID为 8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c (这个ID长度为64位，但是我们可以使用其12位的简短模式，比如8dbd9e392a96)。</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">那么这些以镜像ID命名的文件夹下面又保存了什么东西呢？</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><pre class=\"prettyprint\" style=\"font-size: 14px; box-sizing: border-box; overflow: hidden; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; padding: 16px; margin-top: 0px; margin-bottom: 10px; line-height: 20px; color: rgb(51, 51, 51); word-break: break-all; background-color: rgb(247, 247, 247); border: none; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;\">$&nbsp;sudo&nbsp;ls&nbsp;-al&nbsp;/var/lib/docker/graph/8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c\ntotal&nbsp;20\ndrwxr-xr-x&nbsp;&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;.\ndrwx——&nbsp;&nbsp;6&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;..\n-rw——-&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;&nbsp;437&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;json\ndrwxr-xr-x&nbsp;22&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;layer\n-rw——-&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;layersize\n</pre><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"font-size: 14px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">这个文件夹下的内容如下：</span><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><ul style=\"font-size: 14px; box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 32px; list-style-position: initial; list-style-image: initial; line-height: 30px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif;\"><li style=\"box-sizing: border-box; line-height: 25px;\">json -保存着关于这个镜像的元数据</li><li style=\"box-sizing: border-box; line-height: 25px;\">layersize – 一个整数，表示layer的大小。</li><li style=\"box-sizing: border-box; line-height: 25px;\">layer/ – 子文件夹，保存着rootfs该容器的镜像</li></ul><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><pre class=\"prettyprint\" style=\"font-size: 14px; box-sizing: border-box; overflow: hidden; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; padding: 16px; margin-top: 0px; margin-bottom: 10px; line-height: 20px; color: rgb(51, 51, 51); word-break: break-all; background-color: rgb(247, 247, 247); border: none; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;\">$&nbsp;sudo&nbsp;cat&nbsp;/var/lib/docker/graph/8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c/json&nbsp;|&nbsp;python&nbsp;-mjson.tool\n{\n“comment”:&nbsp;“Imported&nbsp;from&nbsp;-“,\n“container_config”:&nbsp;{\n“AttachStderr”:&nbsp;false,\n“AttachStdin”:&nbsp;false,\n“AttachStdout”:&nbsp;false,\n“Cmd”:&nbsp;null,\n“Env”:&nbsp;null,\n“Hostname”:&nbsp;“”,\n“Image”:&nbsp;“”,\n“Memory”:&nbsp;0,\n“MemorySwap”:&nbsp;0,\n“OpenStdin”:&nbsp;false,\n“PortSpecs”:&nbsp;null,\n“StdinOnce”:&nbsp;false,\n“Tty”:&nbsp;false,\n“User”:&nbsp;“”\n},\n“created”:&nbsp;“2013-04-11T14:13:15.57812-07:00″,\n“docker_version”:&nbsp;“0.1.4″,\n“id”:&nbsp;“8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c”\n}\n\n$&nbsp;sudo&nbsp;cat&nbsp;/var/lib/docker/graph/8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c/layersize\n131301903\n\n$&nbsp;sudo&nbsp;ls&nbsp;-al&nbsp;/var/lib/docker/graph/8dbd9e392a964056420e5d58ca5cc376ef18e2de93b5cc90e868a1bbc8318c1c/layer\ntotal&nbsp;88\ndrwxr-xr-x&nbsp;22&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;.\ndrwxr-xr-x&nbsp;&nbsp;3&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:52&nbsp;..\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;bin\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;19&nbsp;&nbsp;2012&nbsp;boot\ndrwxr-xr-x&nbsp;&nbsp;4&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;dev\ndrwxr-xr-x&nbsp;41&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;etc\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;19&nbsp;&nbsp;2012&nbsp;home\ndrwxr-xr-x&nbsp;11&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;lib\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;lib64\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;media\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;19&nbsp;&nbsp;2012&nbsp;mnt\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;opt\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;19&nbsp;&nbsp;2012&nbsp;proc\ndrwx——&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;root\ndrwxr-xr-x&nbsp;&nbsp;4&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;run\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;sbin\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Mar&nbsp;&nbsp;5&nbsp;&nbsp;2012&nbsp;selinux\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;srv\ndrwxr-xr-x&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;14&nbsp;&nbsp;2012&nbsp;sys\ndrwxrwxrwt&nbsp;&nbsp;2&nbsp;root&nbsp;root&nbsp;4096&nbsp;Apr&nbsp;11&nbsp;&nbsp;2013&nbsp;tmp\ndrwxr-xr-x&nbsp;10&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;usr\ndrwxr-xr-x&nbsp;11&nbsp;root&nbsp;root&nbsp;4096&nbsp;Nov&nbsp;22&nbsp;06:51&nbsp;var\n</pre><br style=\"font-size: 14px; box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><div style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">看到这里你应该有些顿悟了吧，这就是我们为什么即使我们不和远程索引或者注册表交互也能通过仓库名来使用一个镜像的原理了。因为一旦你将镜像从远程下载到本地，Docker可以通过仓库名称来使用它们。当你创建自己的Dockerfile的时候也不例外。</span></div><div style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br></span></div><div style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br></span></div><div style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">@Dockerone 文章是去年3月份的，引用之前最好与现在版本对一下变动.其次，讨论存储最好说明底层的driver时什么</span><br style=\"box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br style=\"box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">我这边对devicemapper了解不多，主要说说aufs的</span><br style=\"box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><br style=\"box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><span style=\"color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\">镜像的存储结构主要分两部分，一是镜像ID之间的关联，一是镜像ID与镜像名称之间的关联，前者的结构体叫Graph，后者叫TagStore.</span><br style=\"box-sizing: border-box; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif; line-height: 25.200000762939453px;\"><ol style=\"box-sizing: border-box; margin: 0px; padding: 0px 0px 0px 32px; list-style-position: initial; list-style-image: initial; line-height: 30px; color: rgb(102, 102, 102); font-family: 'Helvetica Neue', STHeiti, 'Microsoft YaHei', Helvetica, Arial, sans-serif;\"><li style=\"box-sizing: border-box; line-height: 25px;\">/var/lib/graph/&lt;image id&gt;&nbsp;下面没有layer目录，只有每个镜像的json描述文件和layersize大小</li><li style=\"box-sizing: border-box; line-height: 25px;\">/var/lib/docker/repositories-aufs&nbsp;TagStore的存储地方，里面有image id与reponame ，tag之间的映射关系. aufs是driver名</li><li style=\"box-sizing: border-box; line-height: 25px;\">/var/lib/docker/aufs/diff/&lt;image id or container id&gt;&nbsp;每层layer与其父layer之间的文件差异，有的为空，有的有一些文件(镜像实际存储的地方)</li><li style=\"box-sizing: border-box; line-height: 25px;\">/var/lib/docker/aufs/layers/&lt;image id or container id&gt;&nbsp;每层layer一个文件，记录其父layer一直到根layer之间的ID，每个ID一行。大部分文件的最后一行都一样，表示继承自同一个layer.</li><li style=\"box-sizing: border-box; line-height: 25px;\">/var/lib/docker/aufs/mnt/&lt;image id or container id&gt;&nbsp;有容器运行时里面有数据(容器数据实际存储的地方,包含整个文件系统数据)，退出时里面为空</li></ol></div>"
    }
  ]
}
{
  "title": "用fpga做高频交易是不是要在fpga中实现从mac到tcp/ip层的所有协议(精简的)?",
  "cells": [
    {
      "type": "text",
      "data": "<blockquote style=\"margin-top: 10px; margin-bottom: 10px; padding: 5px 10px 5px 40px; border-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-color: rgb(235, 235, 235); outline: 0px; font-size: 12px; vertical-align: baseline; background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/quotebg.gif); background-color: rgb(247, 247, 247); quotes: none; line-height: 1.5em; color: rgb(255, 125, 0); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: 10px 10px; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; font-style: inherit; line-height: 2em; font-family: inherit; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">个人理解,fpga用来做高频交易应该是网路直接接入fpga(光口或者乙太网口),在fpga里面实现所有的网路层协议(mac,tcp/ip等等可能是根据实际情况精简了),以及上层应用层的行情以及交易埠协议,还有最终的交易演算法决策以及委托下单等等.</font></p><font style=\"vertical-align: inherit;\">在上面的基础上,如果板子是连接在电脑上的pcie口的,那么fpga会将最终的交易结果等等信息发送给电脑,电脑只是作为一个交易结果信息接收以及控制fpga运行参数和状态的存在,并不实际参与任何网路协议解包以及策略演算法交易计算.不知道业内是不是这么做的.很想了解.</font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; font-style: inherit; line-height: 2em; font-family: inherit; background-position: initial initial; background-repeat: initial initial;\"></p></blockquote><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">FPGA 最基本的用处就是在里面实现了网路协议栈，用来处理网路包。</font><font style=\"vertical-align: inherit;\">网路协议栈和常见的金融协议，现在都已经有了比较成熟的实现。</font><font style=\"vertical-align: inherit;\">很多小公司就是买来直接用。</font></font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">当网卡收到包含行情数据的新的包。</font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><ol style=\"margin: 0px 0px 0px 40px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 1.5em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; list-style: none; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><li style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; font-family: inherit; text-align: left; line-height: 2em; list-style-type: decimal; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">如果没有FPGA，数据要复制到内存中，由CPU 处理。</font><font style=\"vertical-align: inherit;\">而复制过程发生在网卡收到完整的包以后，而CPU要等包完全复制到内存后，再开始解析网路协议，金融协议。</font><font style=\"vertical-align: inherit;\">整个过程，从数据包到达网卡，到获得数据，用了kernel bypass 以后，需要几百纳秒的时间。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; line-height: 2em; font-family: inherit; background-position: initial initial; background-repeat: initial initial;\"></p></li><li style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; font-family: inherit; text-align: left; line-height: 2em; list-style-type: decimal; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">用了FPGA 的话，网卡从开始接收数据包，FPGA 卡就可以开始解析了。</font><font style=\"vertical-align: inherit;\">而网路包传递完毕，数据也解析完毕了。</font><font style=\"vertical-align: inherit;\">这一过程是几十纳秒时间。</font></font></li></ol><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">当解析完金融数据：</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><ol style=\"margin: 0px 0px 0px 40px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 1.5em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; list-style: none; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><li style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; font-family: inherit; text-align: left; line-height: 2em; list-style-type: decimal; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">可以再复制到user space 供应用程序使用，生成交易信号以后，交易情况比较复杂，但是发送网路包的实现相对简单，使用kernel bypass + 网卡底层的API，发一个正常的FIX 协议的包，也就一两百纳秒，所以很多时候就不走FPGA 了。</font></li><li style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; font-family: inherit; text-align: left; line-height: 2em; list-style-type: decimal; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">对于比较简单的策略，可以完全在FPGA 中实现，生成交易指令，再从FPGA 对接的网卡直接发去交易所。</font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; font-style: inherit; line-height: 2em; font-family: inherit; background-position: initial initial; background-repeat: initial initial;\"></p></li></ol><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">算tick to trade 的时间，需要数据进入内存CPU 处理的，要大几百纳秒，标准差10-20 ns，完全FPGA 处理的是大几十纳秒，标准差5-10 ns。</font><font style=\"vertical-align: inherit;\">具体数据还和策略有关。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">FPGA一般只用于最后对接交易所的部分，不会涉及策略层面。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">有一个例外，就是在事件驱动的策略里，FPGA可以用于接受市场信息发出信号，也可以用于接受信号并做出相应反应，比如说市场异动那么立刻撤单，这就不需要走策略了。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">交易数据主要通过UDP与TCP两种方式进行网路传输，下面以UDP包为例，（TCP 更复杂些，但原理差不多），简单来介绍下交易数据在电脑内的传输、解析。</font><font style=\"vertical-align: inherit;\">交易数据到达网卡后，通过PCI Express 或HyperPort介面，再传到操作系统的内核（OS Kernel）进行TCP/IP 协议栈的解析，再把解析后的数据内容通过socket 介面，推送到用户程序即策略中。</font><font style=\"vertical-align: inherit;\">然后用户程序再对数据按照规定的格式进行解析，然后应用在策略逻辑中，进行分析，下单等动作。</font><font style=\"vertical-align: inherit;\">以上的这种方式主要是基于现有电脑的结构的基本做法，配置好的快些，但总的来说整个过程的处理时间，数量级在两位数微秒（us，百万分之一秒）左右。</font><font style=\"vertical-align: inherit;\">数据量多的时候，操作系统内核对TCP/IP 的解析所用CPU也消耗很多，处理速度会加速下降。</font><font style=\"vertical-align: inherit;\">一般来说，1G 的数据需要一个GHZ的CPU进行解析，一般的CPU的速度也就是2-3GHZ，这个比例在数据量大时是相当大的。</font><font style=\"vertical-align: inherit;\">在整个交易数据内部传递与解析的过程中，能够做文章的主要是TCP/IP 协议栈的解析和业务数据的解析。</font><font style=\"vertical-align: inherit;\">因为策略逻辑的多样性，对策略逻辑的普遍加速的可能性不大。</font><font style=\"vertical-align: inherit;\">TCP/IP 协议栈的解析（TOE，TCP/IP offload engine）和业务数据的解析主要由专用的网卡来做。</font><font style=\"vertical-align: inherit;\">目前有两种方法来实现，一种是在网卡附带的CPU上进行处理；另一种是网卡+FPGA的形式，用FPGA来做TCP/IP的解析和业务数据的解析。</font><font style=\"vertical-align: inherit;\">FPGA 因为全部是硬体，速度会更快些。</font><font style=\"vertical-align: inherit;\">理论上来说，用ASIC会更快些，但是这个市场是个小众市场，用ASIC并不划算，目前还没有人这么做。</font><font style=\"vertical-align: inherit;\">通过以上的这些硬体加速的方法，基本上能达到个位数微秒（us）的延迟。</font><font style=\"vertical-align: inherit;\">用硬体做的好处除了延迟小外，在处理的容量和稳定性方面上也有诸多好处。</font></font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">不是。</font><font style=\"vertical-align: inherit;\">一般FPGA仅用来实现order flow，下接正常网卡。</font><font style=\"vertical-align: inherit;\">因为策略algo可能的修改太多，不写入FPGA。</font></font></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">另外很少策略是真的需要FPGA。</font><font style=\"vertical-align: inherit;\">见过的几个，其实整体瓶颈都在其他方面，让FPGA的提升甚为鸡肋。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">同关注，本人觉得tcp的协议栈在fpga中实现起来方便，因为他是标准的；但是策略那块就不好说了，本人也不是很了解；再加上策略频繁更新，fpga开发相对软体时间周期长，或许fpga策略的开发有更简易的方法，只是我还没了解到。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">深圳有公司就是用的全FPGA方案，TCP/IP协议，交易管理，行情处理，策略都是放在FPGA内部实现的，伺服器主要用作运维，采用国产的TOE方案，也是深圳一家叫欧亿芯科技的，网路延时处理大概在200ns左右，加上行情解析与分发，账户与风控检查，FPGA策略耗时，tick-to-trader的延时大概在1.5us，同样的策略，原系统的撤单率在20-30%左右，全FPGA系统降低到了10%以下，基本上根据策略产生的订单都能撮合成功了，所以这种系统基本就是在考验策略演算法的效率了</font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">明显不是</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">fpga和tcp并无关系，不过可以先说说为什么经常把两者联系起来。</font><font style=\"vertical-align: inherit;\">这是因为目前架构体系下PCI实在太慢了，如果把网路数据先拷到host上，在转到fpga上做你想要的计算，那么传输的成本可能高于fpga带来的速度提升。</font><font style=\"vertical-align: inherit;\">简单说，把tcp也做在fpga上仅仅是一个无奈的优化策略，深度的pipeline并不是一个理想的解决方案。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><center style=\"margin: 0px auto; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></center><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">fpga的优势是在于并行处理，tcp本身是stateful的东西，逻辑上就不该放在一起</font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">fpga不需要实现所有的网路层协议(mac,tcp/ip等等），可以采用fpga+网路协议晶元（如W5300晶元）的方案。</font><font style=\"vertical-align: inherit;\">个人感觉用fpga来实现开发周期长，使用网路协议晶元比较方便，可以不用详细了解协议层面知识。</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"><font style=\"vertical-align: inherit;\">貌似深圳有公司实现了简单tcp stack IN FPGA了，并发数很受限制的。</font></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><hr style=\"height: 50px; border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(226, 223, 223); background-image: url(file:///Users/zhaofeng/Downloads/Quiver.app/Contents/Resources/dist/images/fg-.png); background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: no-repeat no-repeat;\"><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">不是</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">udp multicast和tcp</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\">Tcp的话很多人是不处理tcp stack的都东西的</font></font><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><p style=\"margin: 0px 0px 20px; padding: 0px; border: 0px; outline: 0px; font-size: 20px; vertical-align: baseline; background-color: rgb(255, 255, 255); line-height: 2em; font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2; background-position: initial initial; background-repeat: initial initial;\"></p><div><font style=\"color: rgb(51, 51, 51); font-family: 微软雅黑, Verdana, Arial, Helvetica, sans-serif; font-size: 20px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); vertical-align: inherit;\"><font style=\"vertical-align: inherit;\"><br></font></font></div>"
    }
  ]
}
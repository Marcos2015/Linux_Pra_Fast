{
  "title": "man epoll的惊喜",
  "cells": [
    {
      "type": "text",
      "data": "<div id=\"meta_content\" class=\"rich_media_meta_list\">\n                                                            <em id=\"post-date\" class=\"rich_media_meta rich_media_meta_text\">2016-03-04</em>\n\n                                        <a class=\"rich_media_meta rich_media_meta_link rich_media_meta_nickname\" href=\"https://mp.weixin.qq.com/s?__biz=MzA3OTY3OTE1MQ==&amp;mid=403411440&amp;idx=1&amp;sn=6b97e84761fc3e9e301cb623e98b213f&amp;scene=21##\" id=\"post-user\">架构说</a>\n                    \n\n                    \n                </div>\n                \n                \n                \n                \n                                                \n                                                                \n                \n                <div class=\"rich_media_content \" id=\"js_content\">\n                    \n\n                    \n\n                    \n                    \n                    <p><br></p><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\"><span style=\"color: rgb(255, 169, 0);\">今日问题：&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">0.1ms socket a 过来一起个请求 a&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">0.2ms socket b 过来一起个请求 b&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">epoll_wait 返回结果是什么&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">我不懂epoll原理呀 不知道如果回答 和ET有关系吗?</span></p><h3 style=\"box-sizing: border-box; font-family: inherit; line-height: 1.6; color: inherit; margin-top: 1.2em; margin-bottom: 0.6em; font-size: 1.7em; outline: none !important;\">解决方式 man epoll&nbsp;</h3><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">1 ET方式什么情况下进行下次能触发</p><blockquote style=\"box-sizing: border-box; padding: 15px 20px; margin-bottom: 1.1em; border-left-width: 10px; border-left-color: rgba(102, 128, 153, 0.0745098); border-top-right-radius: 5px; border-bottom-right-radius: 5px; outline: none !important; background-color: rgba(102, 128, 153, 0.0470588);\"><p style=\"box-sizing: border-box; font-size: 1em; line-height: 1.6; outline: none !important;\">当前socket的缓冲区&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">可读如果做（你发送过来数据起我完全读完）&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">可写如何做（我这次发送数据必须发送完毕）</p></blockquote><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">2 为什么ET一般采用 非舒塞模式</p><blockquote style=\"box-sizing: border-box; padding: 15px 20px; margin-bottom: 1.1em; border-left-width: 10px; border-left-color: rgba(102, 128, 153, 0.0745098); border-top-right-radius: 5px; border-bottom-right-radius: 5px; outline: none !important; background-color: rgba(102, 128, 153, 0.0470588);\"><p style=\"box-sizing: border-box; font-size: 1em; line-height: 1.6; outline: none !important;\">在epoll_wait返回之后为了满足上面#1要求&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">必须读完或者写完，不然就就阻塞哪里&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">影响其他业务</p></blockquote><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">3 If more than one event occurs between epoll_wait(2) calls, are they combined or reported separately?</p><blockquote style=\"box-sizing: border-box; padding: 15px 20px; margin-bottom: 1.1em; border-left-width: 10px; border-left-color: rgba(102, 128, 153, 0.0745098); border-top-right-radius: 5px; border-bottom-right-radius: 5px; outline: none !important; background-color: rgba(102, 128, 153, 0.0470588);\"><p style=\"box-sizing: border-box; font-size: 1em; line-height: 1.6; outline: none !important;\">A7 They will be combined.&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">在epoll_wait返回之后 处理业务期间 之后会触发的将会合并</p></blockquote><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">4&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">如何解决业务处理时间长导致&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">看Q9&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">Do I need to continuously read/write a file descriptor until EAGAIN&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">when using the EPOLLET flag (edge-trig- gered behavior) ?</p><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\"><img data-s=\"300,640\" data-type=\"png\" data-src=\"http://mmbiz.qpic.cn/mmbiz/2H3gcc9GEbvzStAdKlialSLfaDPTWtGuvGUJBrhVHFQCpeH3BYBSKHT81lFqDrMUj24Zzic5s4hQOfw8S95EiaGtQ/0?wx_fmt=png\" style=\"line-height: 1.6; width: auto !important; visibility: visible !important;\" data-ratio=\"0.18884892086330934\" data-w=\"\" class=\"\" src=\"quiver-image-url/FF63AB70E0A9D83694D090A24AF3DC29.png\" data-fail=\"0\" width=\"480\" height=\"90\"><br></p><h3 style=\"box-sizing: border-box; font-family: inherit; line-height: 1.6; color: inherit; margin-top: 1.2em; margin-bottom: 0.6em; font-size: 1.7em; outline: none !important;\">英文说明</h3><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">epoll - I/O event notification facility</p><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">epoll\n is a variant of poll(2) that can be used either as an edge-triggered or\n a level-triggered interface and scales well to large numbers of watched\n file descriptors.</p><p><img data-s=\"300,640\" data-type=\"png\" data-src=\"http://mmbiz.qpic.cn/mmbiz/2H3gcc9GEbvzStAdKlialSLfaDPTWtGuv6Wicib7YXurx5On2CSN0hia4mkYYysSemh5vcm5icfH5jh0Zh60gaSmBdg/0?wx_fmt=png\" style=\"width: auto !important; visibility: visible !important;\" data-ratio=\"0.3776978417266187\" data-w=\"\" class=\"\" src=\"quiver-image-url/E5EA88464ACD6962FD809CCFE1A3A81A.png\" data-fail=\"0\" width=\"480\" height=\"181\"><img data-s=\"300,640\" data-type=\"png\" data-src=\"http://mmbiz.qpic.cn/mmbiz/2H3gcc9GEbvzStAdKlialSLfaDPTWtGuvCve1CZjViaY899PxYalzS3JW6aY3aiazu4EXaNGUK40gg3I4qAsOAfvw/0?wx_fmt=png\" style=\"line-height: 1.6; width: auto !important; visibility: visible !important;\" data-ratio=\"0.2589928057553957\" data-w=\"\" class=\"\" src=\"quiver-image-url/F34744B4FC4903F9C17A3C94D0F31CBD.png\" data-fail=\"0\" width=\"480\" height=\"124\"></p><p><br></p><h3 style=\"box-sizing: border-box; font-family: inherit; line-height: 1.6; color: inherit; margin-top: 1.2em; margin-bottom: 0.6em; font-size: 1.7em; outline: none !important;\">总结</h3><blockquote style=\"box-sizing: border-box; padding: 15px 20px; margin-bottom: 1.1em; border-left-width: 10px; border-left-color: rgba(102, 128, 153, 0.0745098); border-top-right-radius: 5px; border-bottom-right-radius: 5px; outline: none !important; background-color: rgba(102, 128, 153, 0.0470588);\"><p style=\"box-sizing: border-box; font-size: 1em; line-height: 1.6; outline: none !important;\">suggested way to use epoll as&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">an edge-triggered (EPOLLET) interface is as follows:&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">i with non-blocking file descriptors; and&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">ii by waiting for an event only after read(2) or write(2) return EAGAIN.</p></blockquote><h3 style=\"box-sizing: border-box; font-family: inherit; line-height: 1.6; color: inherit; margin-top: 1.2em; margin-bottom: 0.6em; font-size: 1.7em; outline: none !important;\">答案</h3><blockquote style=\"box-sizing: border-box; padding: 15px 20px; margin-bottom: 1.1em; border-left-width: 10px; border-left-color: rgba(102, 128, 153, 0.0745098); border-top-right-radius: 5px; border-bottom-right-radius: 5px; outline: none !important; background-color: rgba(102, 128, 153, 0.0470588);\"><p style=\"box-sizing: border-box; font-size: 1em; line-height: 1.6; outline: none !important;\">有个各种可能</p></blockquote><p style=\"box-sizing: border-box; margin-bottom: 1.1em; line-height: 1.6; outline: none !important;\">1 如果 epoll_wait触发一次，在处理业务中，&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">然后请求a，b 最终一块返回 2&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">2 如果请求a触发了一次，&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">epoll返回1， 然后在返回1&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">3 如果在read中 处理a有问题&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\">可能后面就不在触发了了&nbsp;<br style=\"box-sizing: border-box; outline: none !important;\"><span style=\"color: rgb(255, 76, 0);\">上面提问有问题 没有正确答案</span></p></div>"
    }
  ]
}
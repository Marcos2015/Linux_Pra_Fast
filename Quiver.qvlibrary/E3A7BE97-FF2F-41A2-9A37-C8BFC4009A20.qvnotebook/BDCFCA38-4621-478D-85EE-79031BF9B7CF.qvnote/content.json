{
  "title": "服务器端编程心得（六）—— 关于网络编程的一些实用技巧和细节",
  "cells": [
    {
      "type": "text",
      "data": "<article style=\"box-sizing: inherit; outline: 0px; position: relative; padding-top: 16px; color: rgb(51, 51, 51); font-family: &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div id=\"article_content\" class=\"article_content csdn-tracking-statistics\" data-pid=\"blog\" data-mod=\"popu_307\" data-dsm=\"post\" style=\"box-sizing: inherit; outline: 0px; padding: 0px; margin: 0px; word-break: break-all;\"><div class=\"htmledit_views\" style=\"box-sizing: inherit; outline: 0px; padding: 0px; margin: 0px; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; word-break: break-all;\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">这些年，接触了形形色色的项目，写了不少网络编程的代码，从windows到linux，跌进了不少坑，由于网络编程涉及很多细节和技巧，一直想写篇文章来总结下这方面的心得与经验，希望对来者有一点帮助，那就善莫大焉了。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">&nbsp; &nbsp; &nbsp; 本文涉及的平台包括windows和linux，下面开始啦。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">一、非阻塞的的connect()函数如何编写</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">&nbsp; &nbsp; &nbsp; &nbsp;我们知道用connect()函数默认是阻塞的，直到三次握手建立之后，或者实在连不上超时返回，期间程序执行流一直阻塞在那里。那么如何利用connect()函数编写非阻塞的连接代码呢？</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">&nbsp; &nbsp; &nbsp; 无论在windows还是linux平台都可以采取以下思路来实现：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">1. 创建socket时，将socket设置成非阻塞模式，具体如何设置可参考我这个系列的文章《<a href=\"http://blog.csdn.net/analogous_love/article/details/53033102\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; color: rgb(0, 0, 0); text-decoration: none; cursor: pointer; word-break: break-all; font-family: &quot;Microsoft YaHei&quot;; line-height: 30px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 12px;\">服务器编程心得（四）—— 如何将socket设置为非阻塞模式</span></a>》；</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">2. 接着调用connect()进行连接，如果connect()能立即连接成功，则返回0；如果此刻不能立即连接成功，则返回-1（windows上返回SOCKET_ERROR也等于-1），这个时候错误码是WSAEWOULDBLOCK（windows平台），或者是EINPROGRESS（linux平台），表明立即暂时不能完成。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">3. 接着调用select()函数在指定的时间内检测socket是否可写，如果可写表明connect()连接成功。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">需要注意的是：linux平台上connect()暂时不能完成返回-1，错误码可能是EINPROGRESS，也可能是由于被信号给中断了，这个时候错误码是：EINTR。这种情况也要考虑到；而在windows平台上除了用select()函数去检测socket是否可写，也可以使用windows平台自带的函数WSAAsyncSelect或WSAEventSelect来检测。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">下面是代码：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 980px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_1\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_1\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=1&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 980px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_17\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_17\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=17&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">/**&nbsp;</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;*@param&nbsp;timeout&nbsp;连接超时时间，单位为秒</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;*@return&nbsp;连接成功返回true，反之返回false</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;**/</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">bool</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;CSocket::Connect(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;timeout)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//windows将socket设置成非阻塞的方式</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;on&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(::ioctlsocket(m_hSocket,&nbsp;FIONBIO,&nbsp;&amp;on)&nbsp;&lt;&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//linux将socket设置成非阻塞的方式</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//将新socket设置为non-blocking</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">/*</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;oldflag&nbsp;=&nbsp;::fcntl(newfd,&nbsp;F_GETFL,&nbsp;0);</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;newflag&nbsp;=&nbsp;oldflag&nbsp;|&nbsp;O_NONBLOCK;</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(::fcntl(m_hSocket,&nbsp;F_SETFL,&nbsp;newflag)&nbsp;==&nbsp;-1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockaddr_in&nbsp;addrSrv&nbsp;=&nbsp;{&nbsp;0&nbsp;};&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;addrSrv.sin_family&nbsp;=&nbsp;AF_INET;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;addrSrv.sin_addr&nbsp;=&nbsp;htonl(addr);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;addrSrv.sin_port&nbsp;=&nbsp;htons((u_short)m_nPort);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;ret&nbsp;=&nbsp;::connect(m_hSocket,&nbsp;(</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockaddr*)&amp;addrSrv,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(addrSrv));&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ret&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//windows下检测WSAEWOULDBLOCK</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ret&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;WSAGetLastError()&nbsp;!=&nbsp;WSAEWOULDBLOCK)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//linux下需要检测EINPROGRESS和EINTR</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">/*</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ret&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;(errno&nbsp;!=&nbsp;EINPROGRESS&nbsp;||&nbsp;errno&nbsp;!=&nbsp;EINTR))</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;fd_set&nbsp;writeset;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;FD_ZERO(&amp;writeset);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;FD_SET(m_hSocket,&nbsp;&amp;writeset);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;timeval&nbsp;tv;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;tv.tv_sec&nbsp;=&nbsp;timeout;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//可以利用tv_usec做更小精度的超时设置</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;tv.tv_usec&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(::select(m_hSocket&nbsp;+&nbsp;1,&nbsp;NULL,&nbsp;&amp;writeset,&nbsp;NULL,&nbsp;&amp;tv)&nbsp;!=&nbsp;1)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">二、非阻塞socket下如何正确的收发数据</span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">&nbsp; &nbsp; &nbsp;这里不讨论阻塞模式下，阻塞模式下send和recv函数如果tcp窗口太小或没有数据的话都是阻塞在send和recv调用处的。对于收数据，一般的流程是先用select（windows和linux平台皆可）、<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">WSAAsyncSelect()或WSAEventSelect()（windows平台）、poll或epoll_wait（linux平台）检测socket有数据可读，然后进行收取。对于发数据，；linux平台下epoll模型存在水平模式和边缘模式两种情形，如果是边缘模式一定要一次性把socket上的数据收取干净才行，也就是一定要循环到recv函数出错，错误码是EWOULDBLOCK。而linux下的水平模式或者windows平台上可以根据业务一次性收取固定的字节数，或者收完为止。还有个区别上文也说过，就是<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">windows下发数据的代码稍微有点不同的就是不需要检测错误码是EINTR，只需要检测是否是WSAEWOULDBLOCK。</span>代码如下：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">用于windows或linux水平模式下收取数据，这种情况下收取的数据可以小于指定大小，总之一次能收到多少是多少：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2229px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_2\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_2\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=2&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2229px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_18\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_18\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=18&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">bool</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;TcpSession::Recv()&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//每次只收取256个字节</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;buff[256];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//memset(buff,&nbsp;0,&nbsp;sizeof(buff));</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;nRecv&nbsp;=&nbsp;::recv(clientfd_,&nbsp;buff,&nbsp;256,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(nRecv&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;inputBuffer_.add(buff,&nbsp;(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">size_t</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)nRecv);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div>如果是linux epoll边缘模式（ET），则一定要一次性收完：<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2552px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_3\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_3\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=3&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2552px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_19\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_19\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=19&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">bool</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;TcpSession::RecvEtMode()&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//每次只收取256个字节</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;buff[256];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">while</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//memset(buff,&nbsp;0,&nbsp;sizeof(buff));</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;nRecv&nbsp;=&nbsp;::recv(clientfd_,&nbsp;buff,&nbsp;256,&nbsp;0);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(nRecv&nbsp;==&nbsp;-1)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(errno&nbsp;==&nbsp;EWOULDBLOCK&nbsp;||&nbsp;errno&nbsp;==&nbsp;EINTR)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//对端关闭了socket</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(nRecv&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputBuffer_.add(buff,&nbsp;(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">size_t</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)nRecv);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">用于linux平台发送数据：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3115px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_4\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_4\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=4&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3115px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_20\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_20\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=20&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">bool</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;TcpSession::Send()&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">while</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;n&nbsp;=&nbsp;::send(clientfd_,&nbsp;buffer_,&nbsp;buffer_.length(),&nbsp;0);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(n&nbsp;==&nbsp;-1)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//tcp窗口容量不够,&nbsp;暂且发不出去,下次再发</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(errno&nbsp;==&nbsp;EWOULDBLOCK)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">break</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//被信号中断，继续发送</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(errno&nbsp;==&nbsp;EINTR)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">continue</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//对端关闭了连接</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(n&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">false</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer_.erase(n);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//全部发送完毕</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(buffer_.length()&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">break</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></p>另外，收发数据还有个技巧是设置超时时间，除了用setsocketopt函数设置send和recv的超时时间以外，还可以自定义整个收发数据过程中的超时时间，思路是开始收数据前记录下时间，收取完毕后记录下时间，如果这个时间差大于超时时间，则认为超时，代码分别是：<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3772px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_5\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_5\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=5&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3772px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_21\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_21\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=21&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;tmSend&nbsp;=&nbsp;3*1000L;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;tmRecv&nbsp;=&nbsp;3*1000L;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">setsockopt(m_hSocket,&nbsp;IPPROTO_TCP,&nbsp;TCP_NODELAY,(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">LPSTR</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&amp;noDelay,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">));&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">setsockopt(m_hSocket,&nbsp;SOL_SOCKET,&nbsp;&nbsp;SO_SNDTIMEO,(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">LPSTR</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&amp;tmSend,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">));&nbsp;&nbsp;</span></span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3937px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_6\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_6\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=6&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 3937px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_22\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_22\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=22&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;httpclientsocket::RecvData(string&amp;&nbsp;outbuf,</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&amp;&nbsp;pkglen)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(m_fd&nbsp;==&nbsp;-1)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;-1;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;pkglen&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;buf[4096];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">time_t</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;tstart&nbsp;=&nbsp;time(NULL);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">while</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">true</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;ret&nbsp;=&nbsp;::recv(m_fd,buf,4096,0);&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(ret&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close();&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;0;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//对方关闭socket了</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(ret&nbsp;&lt;&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(errno&nbsp;==&nbsp;EAGAIN&nbsp;||&nbsp;errno&nbsp;==EWOULDBLOCK&nbsp;||&nbsp;errno&nbsp;==&nbsp;EINTR)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(time(NULL)&nbsp;-&nbsp;tstart&nbsp;&gt;&nbsp;m_timeout)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close();&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;0;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">continue</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close();&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;ret;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//接收出错</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outbuf.append(buf,buf+ret);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pkglen&nbsp;=&nbsp;GetBufLen(outbuf.data(),outbuf.length());&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(pkglen&nbsp;&lt;=&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//接收的数据有问题</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;pkglen;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">else</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(pkglen&nbsp;&lt;=&nbsp;(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)outbuf.length())&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">break</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//收够了</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;pkglen;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//返回该完整包的长度</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">三、如何获取当前socket对应的接收缓冲区中有多少数据可读</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">Windows上可以使用ioctlsocket()这个函数，代码如下：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 4882px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_7\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_7\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=7&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 4882px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_23\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_23\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=23&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">ulong&nbsp;bytesToRecv;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ioctlsocket(clientsock,&nbsp;FIONREAD,&nbsp;&amp;bytesToRecv)&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//在这里，bytesToRecv的值即是当前接收缓冲区中数据字节数目</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(26, 26, 26); font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: pre-wrap; background-color: rgb(255, 255, 255);\">linux平台我没找到类似的方法。可以采用我上面说的通用方法《<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">非阻塞socket下如何正确的收发数据</span>》来做。当然有人说可以这么写（我在linux man手册ioctl函数栏目上并没有看到这个函数可以使用FIONREAD这样的标志，不同机器可能也有差异，具体可不可以得需要你根据你的linux系统去验证）：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(26, 26, 26); font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: pre-wrap; background-color: rgb(255, 255, 255);\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 5117px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_8\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_8\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=8&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 5117px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_24\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_24\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=24&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">ulong&nbsp;bytesToRecv;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ioctl(clientsock,&nbsp;FIONREAD,&nbsp;&amp;bytesToRecv)&nbsp;==&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//在这里，bytesToRecv的值即是当前接收缓冲区中数据字节数目</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">四、上层业务如何解析和使用收到的数据包？</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">&nbsp; &nbsp; &nbsp; &nbsp; 这个话题实际上是继上一个话题讨论的。这个问题也可以回答常用的面试题：如何解决数据的丢包、粘包、包不完整的问题。首先，因为tcp协议是可靠的，所以不存在丢包问题，也不存在包顺序错乱问题（udp会存在这个问题，这个时候需要自己使用序号之类的机制保证了，这里只讨论tcp）。一般的做法是先收取一个固定大小的包头信息，接着根据包头里面指定的包体大小来收取包体大小（这里“收取”既可以从socket上收取，也可以在已经收取的数据缓冲区里面拿取）。举个例子：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 5420px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_9\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_9\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=9&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 5420px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_25\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_25\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=25&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#pragma&nbsp;pack(push,&nbsp;1)</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;msg&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;cmd;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//协议号</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;seq;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//包序列号（同一个请求包和应答包的序列号相同）</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;packagesize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//包体大小</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;reserved1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//保留字段，在应答包中内容保持不变</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;reserved2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//保留字段，在应答包中内容保持不变</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">};&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">/**&nbsp;</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;*&nbsp;心跳包协议</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;**/</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;msg_heartbeat_req&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;header;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">};&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;msg_heartbeat_resp&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;header;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">};&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">/**&nbsp;</span>&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;*&nbsp;&nbsp;登录协议</span>&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">&nbsp;**/</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;msg_login_req&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user[32];&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password[32];&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clienttype;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//客户端类型</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">};&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;msg_login_resp&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user[32];&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;int32_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userid;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">};&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#pragma&nbsp;pack(pop)</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p>看上面几个协议，拿登录请求来说，每次可以先收取一个包头的大小，即sizeof(msg)，然后根据msg.packagesize的大小再收取包体的大小sizeof(msg_login_req) - sizeof(msg)，这样就能保证一个包完整了，如果包头或包体大小不够，则说明数据不完整，继续等待更多的数据的到来。<br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">因为tcp协议是流协议，对方发送10个字节给你，你可能先收到5个字节，再收到5个字节；或者先收到2个字节，再收到8个字节；或者先收到1个字节，再收到9个字节；或者先收到1个字节，再收到7个字节，再收到2个字节。总之，你可能以这10个字节的任意组合方式收取到。所以，一般在正式的项目中的做法是，先检测socket上是否有数据，有的话就收一下（至于收完不收完，上文已经说了区别），收好之后，在收到的字节中先检测够不够一个包头大小，不够下次收数据后再检测；如果够的话，再看看够不够包头中指定的包体大小，不够下次再处理；如果够的话，则取出一个包的大小，解包并交给上层业务逻辑。注意，这个时候还要继续检测是否够下一个包头和包体，如此循环下去，直到不够一个包头或者包体大小。这种情况很常见，尤其对于那些对端连续发数据包的情况下。<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; line-height: 20.006px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">五、nagle算法</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">nagle算法的是操作系统网络通信层的一种发送数据包机制，如果开启，则一次放入网卡缓冲区中的数据（利用send或write等）较小时，可能不会立即发出去，只要当多次send或者write之后，网卡缓冲区中的数据足够多时，才会一次性被协议栈发送出去，操作系统利用这个算法减少网络通信次数，提高网络利用率。对于实时性要求比较高的应用来说，可以禁用nagle算法。这样send或write的小数据包会立刻发出去。系统默认是开启的，禁用方法如下：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 6701px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_10\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_10\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=10&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 6701px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_26\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_26\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=26&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;noDelay&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">setsockopt(m_hSocket,&nbsp;IPPROTO_TCP,&nbsp;TCP_NODELAY,(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">LPSTR</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">)&amp;noDelay,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">));&nbsp;&nbsp;</span></span></li></ol></div>noDelay为1禁用nagle算法，为0启用nagle算法。<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">六、select函数的第一个参数问题</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">select函数的原型是：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 6952px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_11\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_11\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=11&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 6952px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_27\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_27\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=27&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;select(&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nfds,&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_Inout_&nbsp;fd_set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*readfds,&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_Inout_&nbsp;fd_set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*writefds,&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_Inout_&nbsp;fd_set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*exceptfds,&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">const</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;timeval&nbsp;*timeout&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">);&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">使用示例：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\"></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 7171px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_12\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_12\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=12&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 7171px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_28\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_28\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=28&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">fd_set&nbsp;writeset;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">FD_ZERO(&amp;writeset);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">FD_SET(m_hSocket,&nbsp;&amp;writeset);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;timeval&nbsp;tv;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">tv.tv_sec&nbsp;=&nbsp;3;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">tv.tv_usec&nbsp;=&nbsp;100;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">select(m_hSocket&nbsp;+&nbsp;1,&nbsp;NULL,&nbsp;&amp;writeset,&nbsp;NULL,&nbsp;&amp;tv)&nbsp;&nbsp;</span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 20.006px;\">无论linux还是windows，这个函数都源于<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px;\">Berkeley 套接字。其中readfds、writefds和exceptfds都是一个含有socket描述符句柄数组的结构体。在linux下，第一个参数必须设置成这三个参数中，所有socket描述符句柄中的最大值加1；windows虽然不使用这个参数，却为了保持与<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\">Berkeley 套接字兼容，保留了这个参数，所以windows平台上这个参数可以填写任意值。</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">七、关于bind函数的绑定地址</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\">使用bind函数时，我们需要绑定一个地址。示例如下：</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"></span></span></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 7574px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_13\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_13\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=13&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 7574px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_29\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_29\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=29&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockaddr_in&nbsp;servaddr;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">memset(&amp;servaddr,&nbsp;0,&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(servaddr));&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">servaddr.sin_family&nbsp;=&nbsp;AF_INET;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">servaddr.sin_addr.s_addr&nbsp;=&nbsp;inet_addr(ip_.c_str());&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">servaddr.sin_port&nbsp;=&nbsp;htons(port_);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">bind(listenfd_,&nbsp;(sockaddr&nbsp;*)&amp;servaddr,&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(servaddr));&nbsp;&nbsp;</span></span></li></ol></div>这里的ip地址，我们一般写0.0.0.0（即windows上的宏INADDR_ANY），或者127.0.0.1。这二者还是有什么区别？如果是前者，那么bind会绑定该机器上的任意网卡地址（特别是存在多个网卡地址的情况下），如果是后者，只会绑定本地回环地址<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px;\">127.0.0.1。这样，使用前者绑定，可以使用connect去连接任意一个本地的网卡地址，而后者只能连接127.0.0.1。举个例子：</span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><img src=\"quiver-image-url/5D086AF26D5753850E131320E898B8A7.png\" alt=\"\" style=\"box-sizing: border-box; outline: 0px; margin: 0px; word-break: break-all; cursor: zoom-in;\" width=\"641\" height=\"901\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\">上文中，机器有三个网卡地址，如果使用bind到0.0.0.0上的话，则可以使用192.168.27.19或&nbsp;192.168.56.1或&nbsp;192.168.247.1任意地址去connect，如果bind到127.0.0.1，则只能使用<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\">127.0.0.1这个地址去connect。</span></span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">八、关于SO_REUSEADDR和SO_REUSEPORT</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">使用方法如下：</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"></span></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 8931px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_14\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_14\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=14&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 8931px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_30\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_30\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=30&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;on&nbsp;=&nbsp;1;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">setsockopt(listenfd_,&nbsp;SOL_SOCKET,&nbsp;SO_REUSEADDR,&nbsp;(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;*)&amp;on,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(on));&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">setsockopt(listenfd_,&nbsp;SOL_SOCKET,&nbsp;SO_REUSEPORT,&nbsp;(<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;*)&amp;on,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">sizeof</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">(on));&nbsp;&nbsp;</span></span></li></ol></div><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px;\">这两个socket选项，一般服务器程序用的特别多，主要是为了解决一个socket被系统回收以后，在一个最大存活期（MSL，大约2分钟）内，该socket绑定的地址和端口号不能被重复利用的情况。tcp断开连接时，需要进行四次挥手，为了保证最后一步处于time_wait状态的socket能收到ACK应答，操作系统将socket的生命周期延长至一个MSL。但是这对于服务器程序来说，尤其是重启的情况下，由于重启之后，该地址和端口号不能立刻被使用，导致bind函数调用失败。所以开发者要不变更地址和端口号，要不等待几分钟。这其中任意一个选择都无法承受的。所以可以设置这个选项来避免这个问题。</span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp;但是windows上和linux上实现稍有差别，windows上是一个socket回收后，在MSL期间内，其使用的地址和端口号组合其他进程不可以使用，但本进程可以继续重复利用；而linux实现是所有进程在MSL期间内都不能使用，包括本进程。<br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">九、心跳包机制</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp; 为了维持一个tcp连接的正常，通常一个连接长时间没有数据来往会被系统的防火墙关闭。这个时候，如果再想通过这个连接发送数据就会出错，所以需要通过心跳机制来维持。虽然tcp协议栈有自己的keepalive机制，但是，我们应该更多的通过应用层心跳包来维持连接存活。那么多长时间发一次心跳包合适呢？在我的过往项目经验中，真是众说纷纭啊，也因此被坑了不少次。后来，我找到了一种比较科学的时间间隔：</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp;先假设每隔30秒给对端发送一个心跳数据包，这样需要开启一个定时器，定时器是每过30秒发送一个心跳数据包。</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp;除了心跳包外，与对端也会有正常的数据来往（非心跳包数据包），那么记下这些数据的send和recv时刻。也就是说，如果最近的30秒内，发送过或者收到过非心跳包外的数据包，那么30秒后就不要发心跳包数据。也就是说，心跳包发送一定是在两端没有数据来往后的30秒才需要发送。这样不仅可以减轻服务器的压力，同时也减少了网络通信流量，尤其对于流量昂贵的移动设备。</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp; 当然，心跳包不仅可以用来维持连接正常，也可以携带一些数据，比如定期得到某些数据的最新值，这个时候，上面的方案可能就不太合适了，还是需要每隔30秒发送一次。具体采取哪种，可以根据实际的项目需求来决定。</span></span></p>&nbsp; &nbsp; &nbsp;另外，需要补充一点的时，心跳包一般由客户端发给服务器端，也就是说客户端检测自己是否保持与服务器连接，而不是服务器主动发给客户端。用程序的术语来讲就是调用connect函数的一方发送心跳包，调用listen的一方接收心跳包。<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp; 拓展一下，这种思路也可以用于保持与数据库的连接。比如在30秒内没有执行数据库操作后，定期执行一条sql，用以保持连接不断开，比如一条简单的sql：select 1 from user;</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 18px;\">十、重连机制</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp;在我早些年的软件开发生涯中，我用connect函数连接一个对端，如果连接不上，那么我会再次重试，如果还是连接不上，会接着重试。如此一直反复下去，虽然这种重连动作放在一个专门的线程里面（对于客户端软件，千万不要放在UI线程里面，不然你的界面将会卡死）。但是如果对端始终连不上，比如因为网络断开。这种尝试其实是毫无意义的，不如不做。其实最合理的重连方式应该是结合下面的两种方案：</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">1. 如果connect连接不上，那么n秒后再重试，如果还是连接不上2n秒之后再重试，以此类推，4n，8n，16n......</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">但是上述方案，也存在问题，就是如果当重试间隔时间变的很长，网络突然畅通了，这个时候，需要很长时间才能连接服务器，这个时候，就应该采取方法2。</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">2. 在网络状态发生变化时，尝试重连。比如一款通讯软件，由于网络故障现在处于掉线状态，突然网络恢复了，这个时候就应该尝试重连。windows下检测网络状态发生变化的API是IsNetworkAlive。示例代码如下：</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"></span></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 10163px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_15\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_15\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=15&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 10163px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_31\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_31\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=31&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">BOOL</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;IUIsNetworkAlive()&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">DWORD</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;dwFlags;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//上网方式&nbsp;&nbsp;&nbsp;</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">BOOL</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;bAlive&nbsp;=&nbsp;TRUE;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//是否在线&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;bAlive&nbsp;=&nbsp;::IsNetworkAlive(&amp;dwFlags);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;bAlive;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">十一、关于错误码EINTR<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">&nbsp; &nbsp; &nbsp;这个错误码是linux平台下的。对于很多linux网络函数，如connect、send、recv、epoll_wait等，当这些函数出错时，一定要检测错误是不是EINTR，因为如果是这种错误，其实只是被信号中断了，函数调用并没用出错，这个时候要么重试，如<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\">send、recv、epoll_wait，要么利用其他方式检测完成情况，如利用select检测connect是否成功。千万不要草草认定这些调用失败，而做出错误逻辑判断。</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">十二、尽量减少系统调用</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">对于高性能的服务器程序来说，尽量减少系统调用也是一个值得优化的地方。每一次系统调用就意味着一次从用户空间到内核空间的切换。例如，在libevent网络库，在主循环里面，对于时间的获取是一次获取后就立刻缓存下来，以后如果需要这个时间，就取缓存的。但是有人说，在x86机器上gettimeofday不是系统调用，所以libevent没必要这么做。有没有必要，我们借鉴一下这个减少系统调用的思想而已。</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\">十三、忽略linux信号SIGPIPE</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\">SIGPIPE</span>这个信号针对linux平台的，什么情况下会产生这个信号呢？当一个侦听socket被关闭以后，这个时候如果对端向本端发送数据（调用send或write）之后，再次调用send或write向本端发送数据，这个时候，本端该进程将产生<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\">SIGPIPE信号，这个信号默认处理是终止进程。但是一般程序尤其是服务器程序肯定不希望要这种默认行为，因为不能因为客户端给我们乱发数据导致我们自己崩溃退出。所以应该忽略掉这个信号，代码如下：</span></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); line-height: 26px;\"></span></span></span></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/60761528#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 10890px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_16\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_16\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=16&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 10890px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_32\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_32\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=32&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">signal(SIGPIPE,&nbsp;SIG_IGN);&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">关于<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: Arial; line-height: 26px;\">SIGPIPE具体情况可以参考这篇文章：<a href=\"http://blog.csdn.net/lmh12506/article/details/8457772\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; word-break: break-all;\">http://blog.csdn.net/lmh12506/article/details/8457772</a></span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">暂且就整理这么多吧，欢迎交流，欢迎指出文中错乱之处。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">更新记录：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">zhangyl 于 2017.04.05 增加条款十一。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\">zhangyl 于 2018.02.01 增加条款三。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; color: rgb(51, 51, 51);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 26px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p></div></div></article><div class=\"article-bar-bottom\" style=\"box-sizing: inherit; outline: 0px; padding: 0px 0px 16px; margin: 36px 0px 0px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(227, 227, 227); color: rgb(51, 51, 51); font-family: &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"article-copyright\" style=\"box-sizing: inherit; outline: 0px; padding: 0px; margin: 0px; font-size: 12px; color: rgb(153, 153, 153);\">版权声明：欢迎访问我的个人网站：http://www.hootina.org\thttps://blog.csdn.net/analogous_love/article/details/60761528</div><div class=\"tags-box\" style=\"box-sizing: inherit; outline: 0px; padding: 0px; margin: 18px 0px 8px; font-size: 12px;\"><span class=\"label\" style=\"box-sizing: inherit; outline: 0px; color: rgb(77, 77, 77);\">个人分类：</span>&nbsp;<a class=\"tag-link\" href=\"https://blog.csdn.net/analogous_love/article/category/6503557\" target=\"_blank\" style=\"box-sizing: inherit; outline: 0px; color: rgb(200, 131, 38); text-decoration: none; cursor: pointer; display: inline-block; margin-right: 24px; word-break: break-all;\">服务器端编程心得</a></div><div class=\"tags-box\" style=\"box-sizing: inherit; outline: 0px; padding: 0px; margin: 0px; font-size: 12px;\"><span class=\"label\" style=\"box-sizing: inherit; outline: 0px; color: rgb(77, 77, 77);\">所属专栏：</span>&nbsp;<a class=\"tag-link\" href=\"https://blog.csdn.net/column/details/15825.html\" target=\"_blank\" style=\"box-sizing: inherit; outline: 0px; color: rgb(200, 131, 38); text-decoration: none; cursor: pointer; display: inline-block; margin-right: 24px; word-break: break-all;\">高性能服务器编程实现细节详解</a></div></div>"
    }
  ]
}
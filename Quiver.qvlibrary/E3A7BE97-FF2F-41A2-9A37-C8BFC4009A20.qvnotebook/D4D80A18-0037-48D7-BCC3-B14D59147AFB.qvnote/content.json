{
  "title": "服务器编程心得（四）—— 如何将socket设置为非阻塞模式",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">1. windows平台上无论利用socket()函数还是WSASocket()函数创建的socket都是阻塞模式的：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 410px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_1\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_1\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=1&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 410px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_8\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_8\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=8&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">SOCKET&nbsp;WSAAPI&nbsp;socket(&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;af,&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;type,&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;protocol&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">SOCKET&nbsp;WSASocket(&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;af,&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type,&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol,&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;LPWSAPROTOCOL_INFO&nbsp;lpProtocolInfo,&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;GROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">DWORD</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwFlags&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">);&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">linux平台上可以在利用socket()函数创建socket时指定创建的socket是异步的：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 815px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_2\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_2\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=2&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 815px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_9\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_9\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=9&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;socket(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;domain,&nbsp;</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;type,&nbsp;</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;protocol);&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">在type的参数中设置SOCK_NONBLOCK标志即可，例如：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 948px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_3\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_3\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=3&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 948px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_10\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_10\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=10&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;s&nbsp;=&nbsp;socket(AF_INET,&nbsp;SOCK_STREAM&nbsp;|&nbsp;SOCK_NONBLOCK,&nbsp;IPPROTO_TCP);&nbsp;&nbsp;</span></span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><span style=\"color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">2. 另外，windows和linux平台上accept()函数返回的socekt也是阻塞的，linux另外提供了一个accept4()函数，可以直接将返回的socket设置为非阻塞模式：</span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1119px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_4\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_4\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=4&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1119px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_11\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_11\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=11&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;accept(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockfd,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockaddr&nbsp;*addr,&nbsp;socklen_t&nbsp;*addrlen);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;accept4(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockfd,&nbsp;</span><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">struct</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;sockaddr&nbsp;*addr,&nbsp;socklen_t&nbsp;*addrlen,&nbsp;</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;flags);&nbsp;&nbsp;</span></span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">只要将accept4()最后一个参数flags设置成SOCK_NONBLOCK即可。</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">3. 除了创建socket时，将socket设置成非阻塞模式，还可以通过以下API函数来设置：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">linux平台上可以调用fcntl()或者ioctl()函数，实例如下：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1414px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_5\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_5\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=5&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1414px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_12\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_12\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=12&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">fcntl(sockfd,&nbsp;F_SETFL,&nbsp;fcntl(sockfd,&nbsp;F_GETFL,&nbsp;0)&nbsp;|&nbsp;O_NONBLOCK);&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">ioctl(sockfd,&nbsp;FIONBIO,&nbsp;1);&nbsp;&nbsp;<span class=\"comment\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 130, 0);\">//1:非阻塞&nbsp;0:阻塞</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li></ol></div><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">参考：&nbsp;<a href=\"http://blog.sina.com.cn/s/blog_9373fc760101i72a.html\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; word-break: break-all;\">http://blog.sina.com.cn/s/blog_9373fc760101i72a.html</a></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">但是网上也有文章说（文章链接：<a href=\"http://blog.csdn.net/haoyu_linux/article/details/44306993\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; word-break: break-all;\">http://blog.csdn.net/haoyu_linux/article/details/44306993</a>），linux下如果调用fcntl()设置socket为非阻塞模式，不仅要设置O_NONBLOCK模式，还需要<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 28px; font-family: Arial; font-size: 14px;\">在接收和发送数据时，需要使用MSG_DONTWAIT标志，</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 28px; font-family: Arial; font-size: 14px;\">即</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; line-height: 28px; font-family: Arial; font-size: 14px;\">在recv，recvfrom和send，sendto数据时，将flag设置为MSG_DONTWAIT。是否有要进行这种双重设定的必要，笔者觉得没有这个必要。因为linux man手册上recv()函数的说明中关于MSG_DONTWAIT说明如下：</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">Enables nonblocking operation; if the operation would block, the call fails with the error EAGAIN or EWOULDBLOCK (this can also be enabled using the O_NONBLOCK flag &nbsp;with&nbsp;the F_SETFL fcntl(2)).<br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">通过这段话我觉得要么通过设置recv()函数的flags标识位为<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: Arial; font-size: 14px; line-height: 28px;\">MSG_DONTWAIT，要么通过fcntl()函数设置O_NONBLOCK标识，而不是要同时设定。</span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><span style=\"color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">windows上可调用ioctlsocket函数：</span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1907px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_6\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_6\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=6&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 1907px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_13\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_13\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=13&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;ioctlsocket(&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;&nbsp;SOCKET&nbsp;s,&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_In_&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;cmd,&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;_Inout_&nbsp;u_long&nbsp;*argp&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">);&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">将cmd参数设置为</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); color: rgb(69, 69, 69); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; line-height: 20.006px;\">FIONBIO，*argp=0即设置成阻塞模式，而*argp非0即可设置成非阻塞模式。但是windows平台需要注意一个地方，如果你对一个socket调用了WSAAsyncSelect()或WSAEventSelect()函数后，你再调用ioctlsocket()函数将该socket设置为非阻塞模式，则会失败，你必须先调用<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">WSAAsyncSelect()通过设置<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">lEvent参数为0或调用WSAEventSelect()通过设置<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">lNetworkEvents参数为0来分别禁用<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">WSAAsyncSelect()或<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">WSAEventSelect()。再次调用ioctlsocket()</span></span></span></span>将该socket设置成阻塞模式才会成功。因为调用<span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(69, 69, 69); line-height: 20.006px;\">WSAAsyncSelect()或WSAEventSelect()函数会自动将socket设置成非阻塞模式。msdn上的原话是：</span></span></span><span style=\"color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></span><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; color: rgb(69, 69, 69);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 20.006px;\">The WSAAsyncSelect and WSAEventSelect functions automatically set a socket to nonblocking mode. If WSAAsyncSelect or WSAEventSelect has been issued on a socket, then any attempt to use ioctlsocket to set the socket back to blocking mode will fail with WSAEINVAL.</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; color: rgb(69, 69, 69);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 20.006px;\"><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">To set the socket back to blocking mode, an application must first disable WSAAsyncSelect by calling WSAAsyncSelect with the lEvent parameter equal to zero, or disable WSAEventSelect by calling WSAEventSelect with the lNetworkEvents parameter equal to zero.</span></span></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; color: rgb(69, 69, 69);\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; font-size: 14px; line-height: 20.006px;\">网址：<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms738573(v=vs.85).aspx\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; word-break: break-all;\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms738573(v=vs.85).aspx</a><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></span><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">4. 在看实际项目中以前一些前辈留下来的代码中，通过在一个循环里面调用fcntl()或者ioctlsocket()函数来socket的非阻塞模式的，代码如下：</p><p style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"></p><div class=\"dp-highlighter bg_cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 1px 0px 0px; margin: 0px 0px 24px; position: relative; overflow-y: hidden; overflow-x: auto; font-family: Consolas, &quot;Courier New&quot;, Courier, mono, serif; font-size: 12px; background-color: rgb(231, 229, 220); width: 843.469px; word-break: break-all; color: rgb(51, 51, 51); font-variant-ligatures: normal; orphans: 2; widows: 2;\"><div class=\"bar\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 0px 0px 45px; margin: 0px; word-break: break-all;\"><div class=\"tools\" style=\"box-sizing: border-box; outline: 0px; padding: 3px 8px 10px 10px; margin: 0px; word-break: break-all; font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; background-color: rgb(248, 248, 248); border-left-width: 3px; border-left-style: solid; border-left-color: rgb(108, 226, 108); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(231, 229, 220);\"><b style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">[cpp]</b>&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"ViewSource\" title=\"view plain\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_plain.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">view plain</a><span data-mod=\"popu_168\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\">&nbsp;<a href=\"https://blog.csdn.net/analogous_love/article/details/53033102#\" class=\"CopyToClipboard\" title=\"copy\" style=\"box-sizing: border-box; outline: 0px; color: rgb(103, 149, 181); text-decoration: none; cursor: pointer; background-image: url(https://csdnimg.cn/release/phoenix/images/ico_copy.gif); border: none; padding: 1px; margin: 0px 10px 0px 0px; word-break: break-all; display: inline-block; width: 16px; height: 16px; text-indent: -2000px; background-position: left top; background-repeat: no-repeat no-repeat;\">copy</a><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2546px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_7\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_7\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=7&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div><div style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px; word-break: break-all; position: absolute; left: 565px; top: 2546px; width: 16px; height: 16px; z-index: 99;\"><embed id=\"ZeroClipboardMovie_14\" src=\"https://csdnimg.cn/public/highlighter/ZeroClipboard.swf\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"16\" height=\"16\" name=\"ZeroClipboardMovie_14\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"id=14&amp;width=16&amp;height=16\" wmode=\"transparent\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></div></span><span data-mod=\"popu_169\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all;\"></span></div></div><ol start=\"1\" class=\"dp-cpp\" style=\"box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 24px; list-style-position: initial; list-style-image: initial; border-style: none solid none none; border-right-width: 1px; border-right-color: rgb(231, 229, 220); background-color: rgb(255, 255, 255); color: rgb(92, 92, 92); word-break: break-all;\"><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">for</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(;;)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#ifdef&nbsp;UNIX</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;on=1;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ioctlsocket(id,&nbsp;FIONBIO,&nbsp;(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;*)&amp;on)&nbsp;&lt;&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#endif</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#ifdef&nbsp;WIN32</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">long</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;on_windows=1;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ioctlsocket(id,&nbsp;FIONBIO,&nbsp;&amp;on_windows)&nbsp;&lt;&nbsp;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#endif</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#ifdef&nbsp;VOS</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">int</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;off=0;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(ioctlsocket(id,&nbsp;FIONBIO,&nbsp;(</span><span class=\"datatypes\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(46, 139, 87); font-weight: bold;\">char</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;*)&amp;off)&nbsp;&lt;0)&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\"><span class=\"preprocessor\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: gray;\">#endif</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">if</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;(GET_LAST_SOCK_ERROR()&nbsp;==&nbsp;EINTR)&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">continue</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAISE_RUNTIME_ERROR(<span class=\"string\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: blue;\">\"Can&nbsp;not&nbsp;set&nbsp;FIONBIO&nbsp;for&nbsp;socket\"</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">);&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closesocket(id);&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">return</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;NULL;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=\"alt\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(255, 255, 255); color: inherit; line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\" style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: rgb(0, 102, 153); font-weight: bold;\">break</span><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">;&nbsp;&nbsp;</span></span></li><li class=\"\" style=\"box-sizing: border-box; outline: 0px; padding: 0px 3px 0px 10px !important; margin-top: 8px; margin-right: 0px !important; margin-bottom: 0px !important; margin-left: 40px; border-top: none; border-right: none; border-bottom: none; border-left: 3px solid rgb(108, 226, 108); border-image: initial; list-style-type: decimal; list-style-image: initial; background-color: rgb(248, 248, 248); color: rgb(92, 92, 92); line-height: 18px; list-style-position: outside !important; word-break: break-all;\"><span style=\"box-sizing: border-box; outline: 0px; word-break: break-all; margin: 0px; padding: 0px; border: none; color: black;\">}&nbsp;&nbsp;</span></li></ol></div><br style=\"box-sizing: border-box; outline: 0px; word-break: break-all; color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(51, 51, 51); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">是否有必要这样做，有待考证。</span>"
    }
  ]
}
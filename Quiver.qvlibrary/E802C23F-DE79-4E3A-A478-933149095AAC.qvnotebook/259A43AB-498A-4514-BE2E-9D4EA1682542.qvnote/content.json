{
  "title": "终极Shell——Zsh",
  "cells": [
    {
      "type": "text",
      "data": "<div style=\"color: rgb(0, 0, 0); line-height: 1.7; font-size: 14px; font-family: Arial;\"><br><p class=\"postmeta\" style=\"margin: 0px; padding: 0px; font-size: 11px; line-height: normal; font-family: Arial, PMingLiU, sans-serif; color: rgb(119, 119, 119);\">2008-08-05&nbsp;<a href=\"https://linuxtoy.org/archives/author/kardinal\" title=\"由 Kardinal 发布\" rel=\"author\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(187, 85, 0);\">Kardinal</a>&nbsp;Posted in&nbsp;<a href=\"https://linuxtoy.org/category/apps\" title=\"查看 Apps 中的全部文章\" rel=\"category tag\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(187, 85, 0);\">Apps</a>,&nbsp;<a href=\"https://linuxtoy.org/category/cli\" title=\"查看 Cli 中的全部文章\" rel=\"category tag\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(187, 85, 0);\">Cli</a>Tagged as&nbsp;<a href=\"https://linuxtoy.org/tag/shell\" rel=\"tag\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(187, 85, 0);\">Shell</a>,&nbsp;<a href=\"https://linuxtoy.org/tag/zsh\" rel=\"tag\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(187, 85, 0);\">Zsh</a><span class=\"rss\" title=\"comment RSS of this post\"><a href=\"https://linuxtoy.org/archives/zsh.html/feed\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(255, 102, 0); font-weight: bold; font-family: verdana, sans-serif;\">RSS</a></span><span class=\"rss\"><a href=\"https://linuxtoy.org/archives/zsh.html/trackback\" title=\"copy this URI and ping to this post from ur own site\" style=\"margin: 0px 3px; text-decoration: none; color: rgb(255, 102, 0); font-weight: bold; font-family: verdana, sans-serif;\">Trackback</a></span></p><div class=\"entry\" style=\"font-size: 1.15em; line-height: 1.4em; font-family: tahoma, sans-serif;\"><p>[撰文/Kardinal]</p><blockquote style=\"background-color: rgb(248, 248, 243); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; border-width: 1px 1px 1px 15px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-color: rgb(234, 234, 218); font-size: 12px; padding: 5px; margin-left: 30px;\">子曾经曰过，zsh: The last shell you’ll ever need! Z是最后一个字母，所以它是终极Shell。<p></p><p>我曾经搜索到一个比较各种Shell的文章，Zsh交互性是A+级别的，远高于其它Shell。在编程方面，Zsh是A级的吧，也是最高的。只是不知道出于什么原因，Zsh被严重的低估了。</p></blockquote><span id=\"more-2227\"></span><p></p><p>大多数的Linux用户比较偏爱Bash，因为大多数的发行版默认的就是它。平心而论，Bash确实比Csh之流的好用多了。不过Bash也有很多地方不尽人意，像自动补全的功能不够强大，定位较长路径不够方便等。</p><p>后来我使用Zsh。如果不调整一些必要的配置的话，Zsh甚至还不如Bash好用。这也是很多人尝试过并放弃过的原因。</p><p><a href=\"http://i.linuxtoy.org/i/2008/08/zshrctar.gz\" style=\"text-decoration: none; color: rgb(187, 85, 0);\">Zsh配置文件试用</a>&nbsp;(内附讲解)</p><p>不熟悉Zsh的人，对Zsh最深刻的印象应该就是它的命令提示符了。它支持右侧对齐的提示符，并且可以配置成这个样子的：</p><p><a href=\"http://i.linuxtoy.org/i/2008/08/zsh1.gif\" style=\"text-decoration: none; color: rgb(187, 85, 0);\"><img src=\"http://i.linuxtoy.org/i/2008/08/zsh1-thumb.gif\" alt=\"zsh1-thumb.gif\" style=\"padding: 3px; border: 1px solid rgb(187, 187, 187); color: rgb(0, 119, 0); font-style: italic; font-size: 11px; line-height: normal;\"></a></p><p>不过我还是喜欢比较简单的样式。</p><p>Zsh的<strong>自动补全功能</strong>十分的强大，如图所示：</p><p><a href=\"http://i.linuxtoy.org/i/2008/08/zsh2.gif\" style=\"text-decoration: none; color: rgb(187, 85, 0);\"><img src=\"http://i.linuxtoy.org/i/2008/08/zsh2-thumb.gif\" alt=\"zsh2-thumb.gif\" style=\"padding: 3px; border: 1px solid rgb(187, 187, 187); color: rgb(0, 119, 0); font-style: italic; font-size: 11px; line-height: normal;\"></a></p><p>它可以自动补全命令、参数、文件名、进程、用户名、变量、权限符等。</p><p>Zsh还有一个贴心的功能：<strong>路径别名</strong>。假设有一个很长的路径，例如/home/lighttpd/html，可以把这个路径命名为 ~WWW。</p><p><a href=\"http://i.linuxtoy.org/i/2008/08/zsh3.gif\" style=\"text-decoration: none; color: rgb(187, 85, 0);\"><img src=\"http://i.linuxtoy.org/i/2008/08/zsh3-thumb.gif\" alt=\"zsh3-thumb.gif\" style=\"padding: 3px; border: 1px solid rgb(187, 187, 187); color: rgb(0, 119, 0); font-style: italic; font-size: 11px; line-height: normal;\"></a></p><p>Zsh可以使用<strong>Emacs风格的键绑定</strong>，习惯Bash键绑定的朋友无需重新适应。Zsh兼容大多数主流Shell，像Bash、Csh等。</p><p><strong>错误校正</strong></p><p><strong><img src=\"http://i.linuxtoy.org/i/2008/08/crct11.jpg\" alt=\"\" style=\"padding: 3px; border: 1px solid rgb(187, 187, 187); color: rgb(0, 119, 0); font-style: italic; font-weight: normal; font-size: 11px; line-height: normal;\"></strong>-- directory -- 是补全类型提示</p><div>/etc/x11 [tab] 后被修正为 /etc/X11</div><div><img src=\"quiver-image-url/8A9E97183AE4E5E3759DB4106D815BE8.jpg\" alt=\"\" style=\"color: rgb(0, 119, 0); font-style: italic; font-size: 11px; line-height: normal;\" width=\"599\" height=\"48\">&nbsp;补全类型提示变成了 -- corrections --</div><div>&nbsp;</div><div>请注意，这个功能不是单纯的修正大小写，而是各种拼写错误 比如说上面的例子，如果输入的是11或者s11，它一样会修正为X11</div>有一个前提，就是每次修正，只允许有一处字符错误 两个以上的错误，除非可以匹配其它的选项，否则就不能修正 12 就不能修正为X11 ，除非候选里有 X12、Y12、Z12……<div>&nbsp;</div><div>在配置文件里找到这一行，修改容错字数</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zstyle ':completion:<em>:approximate:</em>' max-errors 1 numeric</div>当然可以把容错字数改大一些，不过太大了也没有意义了 随便输点什么，就可以匹配所有的，和没有一样<div>&nbsp;</div><div><strong>强大的重定向功能</strong></div><div>同时重定向stdout和stderr到file: command |&amp; &gt;file 同时重定向到多个文件: command &gt;file.1 &gt;file.2</div>比如装系统的时候，可以用这个命令<table border=\"0\" cellspacing=\"1\" cellpadding=\"3\" width=\"90%\" align=\"center\" style=\"border: 1px solid rgb(187, 187, 187);\"><tbody><tr><td style=\"border-collapse: collapse; border-color: rgb(187, 187, 187);\"><strong></strong></td></tr><tr><td style=\"border-collapse: collapse; border-color: rgb(187, 187, 187);\">&nbsp;blkid &gt;&gt; /boot/grub/menu.lst &gt;&gt; /etc/fstab</td></tr></tbody></table><div>&nbsp;</div><div><strong>补全类型控制</strong></div><div>例如： compctl -g '<em>.tar.gz *.gz</em>.tgz' + -g '*(-/)' tar zxvf 过滤候选项</div>tar zxvf [tab] 候选菜单中只出现扩展名为 .tar.gz .gz .tgz 的文件<p></p><p>不过这个功能比较复杂，容易引起混乱，通常需要脚本配合</p><table border=\"0\" cellspacing=\"1\" cellpadding=\"3\" width=\"90%\" align=\"center\" style=\"border: 1px solid rgb(187, 187, 187);\"><tbody><tr><td style=\"border-collapse: collapse; border-color: rgb(187, 187, 187);\"><strong>代码:</strong></td></tr><tr><td style=\"border-collapse: collapse; border-color: rgb(187, 187, 187);\">compctl -g '<em>.tar.bz2 *.tar.gz *.bz2 *.gz *.jar *.rar *.tar *.tbz2 *.tgz *.zip *.Z' + -g '</em>(-/)' extractextract() { &nbsp; &nbsp;if [[ -z \"$1\" ]] ; then &nbsp; &nbsp; &nbsp; &nbsp;print -P \"usage: \\e[1;36mextract\\e[1;0m &lt; filename &gt;\" &nbsp; &nbsp; &nbsp; &nbsp;print -P \"&nbsp; &nbsp; &nbsp; &nbsp;Extract the file specified based on the extension\" &nbsp; &nbsp;elif [[ -f $1 ]] ; then &nbsp; &nbsp; &nbsp; &nbsp;case ${(L)1} in &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.tar.bz2)&nbsp; tar -jxvf $1&nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>.tar.gz)&nbsp; &nbsp;tar -zxvf $1&nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.bz2)&nbsp; &nbsp; &nbsp; bunzip2 $1&nbsp; &nbsp; &nbsp; &nbsp;;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>.gz)&nbsp; &nbsp; &nbsp; &nbsp;gunzip $1&nbsp; &nbsp; &nbsp; &nbsp;;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.jar)&nbsp; &nbsp; &nbsp; unzip $1&nbsp; &nbsp; &nbsp; &nbsp;;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>.rar)&nbsp; &nbsp; &nbsp; unrar x $1&nbsp; &nbsp; &nbsp; &nbsp;;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.tar)&nbsp; &nbsp; &nbsp; tar -xvf $1&nbsp; &nbsp; &nbsp; &nbsp;;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>.tbz2)&nbsp; &nbsp; &nbsp;tar -jxvf $1&nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.tgz)&nbsp; &nbsp; &nbsp; tar -zxvf $1&nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>.zip)&nbsp; &nbsp; &nbsp; unzip $1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em>.Z)&nbsp; &nbsp; &nbsp; &nbsp; uncompress $1&nbsp; &nbsp; ;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</em>)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo \"Unable to extract '$1' :: Unknown extension\" &nbsp; &nbsp; &nbsp; &nbsp;esac &nbsp; &nbsp;else &nbsp; &nbsp; &nbsp; &nbsp;echo \"File ('$1') does not exist!\" &nbsp; &nbsp;fi }</td></tr></tbody></table>考虑到使用的不多，配置又麻烦，我没有配置这个功能 不过我想肯定有人愿意在这上面花点时间<div>&nbsp;</div><div>&nbsp;</div><div><strong>将Zsh设置为默认Shell</strong>(不建议更改root用户的默认shell)</div><div>usermod -s /usr/local/bin/zsh</div><a href=\"http://i.linuxtoy.org/i/2008/08/zshrctar.gz\" style=\"text-decoration: none; color: rgb(187, 85, 0);\"></a><p></p><p><strong>Read More:</strong></p><ul class=\"entrylist\" style=\"list-style: none; margin: 0px 0px 10px; padding: 0px;\"><li>» No related posts</li></ul></div></div><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><br style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span title=\"neteasefooter\" style=\"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px;\"><span id=\"netease_mail_footer\"><div id=\"netease_mail_footer\"><div style=\"border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); padding: 10px 5px; color: rgb(102, 102, 102); line-height: 22px;\">来自网易手机号码邮箱<a id=\"mobile_set\" sys=\"1\" log=\"1\" logid=\"free_sms_20120504\" href=\"http://shouji.163.com/\" target=\"_blank\" style=\"color: rgb(0, 0, 255);\">了解更多</a></div></div></span></span>"
    }
  ]
}
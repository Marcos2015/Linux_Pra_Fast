{
  "title": "linux 多线程函数 pthread_cond_wait 及pthread_cond_wait()用法分析",
  "cells": [
    {
      "type": "text",
      "data": "<embed id=\"xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd\" type=\"application/thunder_download_plugin\" height=\"0\" width=\"0\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">最近找到一篇很好的文章将linux多线程函数pthread_cond_wait，是我茅塞顿开，豁然开朗，决定转载过来，以便经常复习记忆。&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">条件变量的结构为pthread_cond_t，函数pthread_cond_init（）被用来初始化一个条件变量。它的原型为：&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">extern int pthread_cond_init __P ((pthread_cond_t *__cond,__const pthread_condattr_t *__cond_attr));&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">其中cond是一个指向结构pthread_cond_t的指针，cond_attr是一个指向结构pthread_condattr_t的指针。结构 pthread_condattr_t是条件变量的属性结构，和互斥锁一样我们可以用它来设置条件变量是进程内可用还是进程间可用，默认值是 PTHREAD_ PROCESS_PRIVATE，即此条件变量被同一进程内的各个线程使用。注意初始化条件变量只有未被使用时才能重新初始化或被释放。释放一个条件变量的函数为pthread_cond_destroy（pthread_cond_t cond）。　&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">也可以静态的初始化条件变量&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">pthread_cond_t my_condition = PTHREAD_COND_INITIALIZER;&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">函数pthread_cond_wait（）使线程阻塞在一个条件变量上。它的函数原型为：&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">extern int pthread_cond_wait __P ((pthread_cond_t *__cond,pthread_mutex_t *__mutex));&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">调用这个函数时,线程解开mutex指向的锁并被条件变量cond阻塞。线程可以被函数pthread_cond_signal和函数 pthread_cond_broadcast唤醒线程被唤醒后，它将重新检查判断条件是否满足，如果还不满足，一般说来线程应该仍阻塞在这里，被等待被下一次唤醒。这个过程一般用while语句实现。&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">通过下面的程序来理解:&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">__________________华丽的CODE分割线_________________________&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">pthreadCondWait.c&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;pthread.h&gt;&nbsp;&nbsp; #include &lt;unistd.h&gt; pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER; /*初始化互斥锁*/ pthread_cond_t cond = PTHREAD_COND_INITIALIZER;&nbsp;&nbsp;//初始化条件变量 void *thread1(void *); void *thread2(void *); int i=1; int main(void) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_t t_a; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_t t_b; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_create(&amp;t_a,NULL,thread1,(void *)NULL);/*创建进程t_a*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_create(&amp;t_b,NULL,thread2,(void *)NULL); /*创建进程t_b*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_join(t_b, NULL);/*等待进程t_b结束*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_mutex_destroy(&amp;mutex); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_cond_destroy(&amp;cond); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(0); } void *thread1(void *junk) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=1;i&lt;=9;i++) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_mutex_lock(&amp;mutex);// &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(i%3==0) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_cond_signal(&amp;cond);/*条件改变，发送信号，通知t_b进程*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(\"thead1:%d\\n\",i); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_mutex_unlock(&amp;mutex);//*解锁互斥量*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(\"Up Unlock Mutex\\n\");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(1); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} } void *thread2(void *junk) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(i&lt;9) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_mutex_lock(&amp;mutex); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i%3!=0) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pthread_cond_wait(&amp;cond,&amp;mutex);/*等待*/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(\"thread2:%d\\n\",i); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_mutex_unlock(&amp;mutex); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(\"Down Ulock Mutex\\n\"); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(1); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} }&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">___________________至关重要的绚烂的结果分割线_________________&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">[root@iZ25dcp92ckZ testdemo]# vi pthreadCondWait.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">[root@iZ25dcp92ckZ testdemo]# gcc pthreadCondWait.c -lpthread -o pthreadCondWaitStudy&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">[root@iZ25dcp92ckZ testdemo]# ./pthreadCondWaitStudy&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:1&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:2&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2:3&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Down Ulock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2:3&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Down Ulock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:4&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:5&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2:6&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Down Ulock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2:6&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Down Ulock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:7&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thead1:8&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Up Unlock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2:9&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">Down Ulock Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">_________________HOW IT WORKS________&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">i不是三的倍数的时候.&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2条件变量阻塞,释放Mutex&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread1加锁,打印thread1:i,释放锁,打印\"Up Unlock Mutex\"&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">i为3的倍数的时候,&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread1,加锁,条件变量通知,唤醒条件变量阻塞线程,打印\"Up Unlock Mutex\"&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">thread2,被唤醒,加锁,打印\"thread2:i\",释放锁,打印\"Down Ulock Mutex\"&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">&nbsp;&nbsp;&nbsp;&nbsp;所以说函数pthread_cond_wait()调用时,不仅对条件变量起作用,还对互斥锁有作用!&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">++++++++++++++++唯美的好书推荐线++++++++++++&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">\"Beiginning Linux Programming\" by Neil Matthrew &amp; Richard Stones&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">You can choose the English version or Chinese version, but I recommend the English one. Maybe it' easier to understand what the authers say than the Chinese one ,&nbsp;&nbsp;even if you're Chinese.&nbsp;</span><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><br style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\"><span style=\"font-size: 14px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 28px; text-align: justify;\">原文地址：<a href=\"http://blogold.chinaunix.net/u1/53448/showart_431857.html\">http://blogold.chinaunix.net/u1/53448/showart_431857.html</a>&nbsp;</span>"
    }
  ]
}
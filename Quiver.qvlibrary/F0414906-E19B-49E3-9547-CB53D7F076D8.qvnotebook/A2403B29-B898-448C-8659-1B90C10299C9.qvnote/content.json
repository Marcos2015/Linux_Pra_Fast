{
  "title": "Linux 有问必答：如何在 Linux 中统计一个进程的线程数",
  "cells": [
    {
      "type": "text",
      "data": "<embed id=\"xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd\" type=\"application/thunder_download_plugin\" height=\"0\" width=\"0\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><strong style=\"color: rgb(196, 15, 15); font-family: Tahoma, Helvetica, SimSun, sans-serif; font-size: 14px; word-wrap: break-word;\">问题</strong><span style=\"font-family: Tahoma, Helvetica, SimSun, sans-serif; font-size: 14px;\">: 我正在运行一个程序，它在运行时会派生出多个线程。我想知道程序在运行时会有多少线程。在 Linux 中检查进程的线程数最简单的方法是什么？</span><div class=\"d\" style=\"color: rgb(0, 0, 0); font-size: 14px; word-wrap: break-word; margin: 15px 15px 15px 0px; min-height: 100px; line-height: 1.8; font-family: Tahoma, Helvetica, SimSun, sans-serif;\"><div id=\"article_content\" style=\"word-wrap: break-word; vertical-align: top; min-height: 700px; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; padding: 15px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(205, 205, 205); border-right-width: 1px; border-right-style: solid; border-right-color: rgb(205, 205, 205);\"><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">如果你想看到 Linux 中每个进程的线程数，有以下几种方法可以做到这一点。</p><a id=\"3_362\" class=\"target-fix ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); position: relative; top: -40px; display: block; height: 0px; overflow: hidden;\"></a><h3 id=\"toc_1\" style=\"word-wrap: break-word; margin: 6px 0px 3px; padding: 0px; font-size: 1.1em; font-family: 'Microsoft YaHei', 'Hiragino Sans GB', STHeiti, Tahoma, SimHei, sans-serif; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(47, 47, 47); width: 714.59375px;\">方法一: /proc</h3><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">proc 伪文件系统，它驻留在 /proc 目录，这是最简单的方法来查看任何活动进程的线程数。 /proc 目录以可读文本文件形式输出，提供现有进程和系统硬件相关的信息如 CPU、中断、内存、磁盘等等.</p><pre class=\"prettyprint linenums prettyprinted\" style=\"background-color: rgb(51, 51, 51); border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; color: rgb(238, 238, 238); margin: 10px; padding: 1em 1em 1em 2em; border: 2px solid rgb(0, 170, 255);\"><ol class=\"linenums\" style=\"word-wrap: break-word; padding: 1px; border-left-width: 2px; border-left-style: solid; border-left-color: rgb(0, 153, 0); color: rgb(174, 174, 174); background-color: rgb(52, 52, 52); margin: 1em !important;\"><li class=\"L0\" style=\"word-wrap: break-word; margin: 0px; padding: 0px; list-style-type: decimal; line-height: 1.5em !important;\"><code style=\"word-wrap: break-word; color: rgb(238, 238, 238); background-image: none; padding-top: 0px !important; padding-bottom: 0px !important; padding-left: 10px !important; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; margin-top: 1em !important; margin-bottom: 1em !important; border: none !important;\"><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">$ </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">cat</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">proc</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/&lt;</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">pid</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&gt;/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">status</span></code></li></ol></pre><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">上面的命令将显示进程 &lt;pid&gt; 的详细信息，包括过程状态（例如, sleeping, running)，父进程 PID，UID，GID，使用的文件描述符的数量，以及上下文切换的数量。输出也包括<strong style=\"word-wrap: break-word; color: rgb(196, 15, 15);\">进程创建的总线程数</strong>如下所示。</p><pre class=\"prettyprint linenums prettyprinted\" style=\"background-color: rgb(51, 51, 51); border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; color: rgb(238, 238, 238); margin: 10px; padding: 1em 1em 1em 2em; border: 2px solid rgb(0, 170, 255);\"><ol class=\"linenums\" style=\"word-wrap: break-word; padding: 1px; border-left-width: 2px; border-left-style: solid; border-left-color: rgb(0, 153, 0); color: rgb(174, 174, 174); background-color: rgb(52, 52, 52); margin: 1em !important;\"><li class=\"L0\" style=\"word-wrap: break-word; margin: 0px; padding: 0px; list-style-type: decimal; line-height: 1.5em !important;\"><code style=\"word-wrap: break-word; color: rgb(238, 238, 238); background-image: none; padding-top: 0px !important; padding-bottom: 0px !important; padding-left: 10px !important; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; margin-top: 1em !important; margin-bottom: 1em !important; border: none !important;\"><span class=\"typ\" style=\"word-wrap: break-word; color: rgb(137, 189, 255);\">Threads</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">:</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&lt;</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">N</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&gt;</span></code></li></ol></pre><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">例如，检查 PID 20571进程的线程数：</p><pre class=\"prettyprint linenums prettyprinted\" style=\"background-color: rgb(51, 51, 51); border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; color: rgb(238, 238, 238); margin: 10px; padding: 1em 1em 1em 2em; border: 2px solid rgb(0, 170, 255);\"><ol class=\"linenums\" style=\"word-wrap: break-word; padding: 1px; border-left-width: 2px; border-left-style: solid; border-left-color: rgb(0, 153, 0); color: rgb(174, 174, 174); background-color: rgb(52, 52, 52); margin: 1em !important;\"><li class=\"L0\" style=\"word-wrap: break-word; margin: 0px; padding: 0px; list-style-type: decimal; line-height: 1.5em !important;\"><code style=\"word-wrap: break-word; color: rgb(238, 238, 238); background-image: none; padding-top: 0px !important; padding-bottom: 0px !important; padding-left: 10px !important; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; margin-top: 1em !important; margin-bottom: 1em !important; border: none !important;\"><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">$ </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">cat</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">proc</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/</span><span class=\"lit\" style=\"word-wrap: break-word; color: rgb(51, 135, 204);\">20571</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">status</span></code></li></ol></pre><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\"><img src=\"quiver-image-url/3D951E4745360B4FFAFA0DF44F4FFAD3.jpg\" alt=\"\" style=\"word-wrap: break-word; max-width: 95%; margin: 10px 15px; width: 734px; cursor: pointer;\" width=\"751\" height=\"557\"></p><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">输出表明该进程有28个线程。</p><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">或者，你可以在 /proc//task 中简单的统计子目录的数量，如下所示。</p><pre class=\"prettyprint linenums prettyprinted\" style=\"background-color: rgb(51, 51, 51); border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; color: rgb(238, 238, 238); margin: 10px; padding: 1em 1em 1em 2em; border: 2px solid rgb(0, 170, 255);\"><ol class=\"linenums\" style=\"word-wrap: break-word; padding: 1px; border-left-width: 2px; border-left-style: solid; border-left-color: rgb(0, 153, 0); color: rgb(174, 174, 174); background-color: rgb(52, 52, 52); margin: 1em !important;\"><li class=\"L0\" style=\"word-wrap: break-word; margin: 0px; padding: 0px; list-style-type: decimal; line-height: 1.5em !important;\"><code style=\"word-wrap: break-word; color: rgb(238, 238, 238); background-image: none; padding-top: 0px !important; padding-bottom: 0px !important; padding-left: 10px !important; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; margin-top: 1em !important; margin-bottom: 1em !important; border: none !important;\"><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">$ </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">ls</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">proc</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">/&lt;</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">pid</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&gt;/</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">task </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">|</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">wc</span></code></li></ol></pre><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">这是因为，对于一个进程中创建的每个线程，在&nbsp;<code style=\"word-wrap: break-word; background-color: rgb(51, 51, 51); padding: 2px 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; margin-right: 4px; margin-left: 4px; color: rgb(238, 238, 238);\">/proc/&lt;pid&gt;/task</code>&nbsp;中会创建一个相应的目录，命名为其线程 ID。由此在&nbsp;<code style=\"word-wrap: break-word; background-color: rgb(51, 51, 51); padding: 2px 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; margin-right: 4px; margin-left: 4px; color: rgb(238, 238, 238);\">/proc/&lt;pid&gt;/task</code>&nbsp;中目录的总数表示在进程中线程的数目。</p><a id=\"3_1858\" class=\"target-fix ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); position: relative; top: -40px; display: block; height: 0px; overflow: hidden;\"></a><h3 id=\"toc_2\" style=\"word-wrap: break-word; margin: 6px 0px 3px; padding: 0px; font-size: 1.1em; font-family: 'Microsoft YaHei', 'Hiragino Sans GB', STHeiti, Tahoma, SimHei, sans-serif; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(47, 47, 47); width: 714.59375px;\">方法二: ps</h3><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">如果你是功能强大的 ps 命令的忠实用户，这个命令也可以告诉你一个进程（用“H”选项）的线程数。下面的命令将输出进程的线程数。“h”选项需要放在前面。</p><pre class=\"prettyprint linenums prettyprinted\" style=\"background-color: rgb(51, 51, 51); border-top-left-radius: 8px; border-top-right-radius: 8px; border-bottom-right-radius: 8px; border-bottom-left-radius: 8px; color: rgb(238, 238, 238); margin: 10px; padding: 1em 1em 1em 2em; border: 2px solid rgb(0, 170, 255);\"><ol class=\"linenums\" style=\"word-wrap: break-word; padding: 1px; border-left-width: 2px; border-left-style: solid; border-left-color: rgb(0, 153, 0); color: rgb(174, 174, 174); background-color: rgb(52, 52, 52); margin: 1em !important;\"><li class=\"L0\" style=\"word-wrap: break-word; margin: 0px; padding: 0px; list-style-type: decimal; line-height: 1.5em !important;\"><code style=\"word-wrap: break-word; color: rgb(238, 238, 238); background-image: none; padding-top: 0px !important; padding-bottom: 0px !important; padding-left: 10px !important; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; margin-top: 1em !important; margin-bottom: 1em !important; border: none !important;\"><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">$ </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">ps</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> hH p </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&lt;</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">pid</span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">&gt;</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">|</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"kwd\" style=\"word-wrap: break-word; color: rgb(226, 137, 100);\">wc</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\"> </span><span class=\"pun\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">-</span><span class=\"pln\" style=\"word-wrap: break-word; color: rgb(255, 255, 255);\">l</span></code></li></ol></pre><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">如果你想监视一个进程的不同线程消耗的硬件资源（CPU &amp; memory），请参阅<a href=\"https://linux.cn/article-5633-1.html\" style=\"word-wrap: break-word; color: rgb(247, 110, 110); text-decoration: none;\">此教程</a>。</p><hr style=\"word-wrap: break-word; clear: both; margin: 0px 10px;\"><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">via:&nbsp;<a href=\"http://ask.xmodulo.com/number-of-threads-process-linux.html\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">http://ask.xmodulo.com/number-of-threads-process-linux.html</a></p><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">作者：<a href=\"http://ask.xmodulo.com/author/nanni\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">Dan Nanni</a>&nbsp;译者：<a href=\"https://github.com/strugglingyouth\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">strugglingyouth</a>&nbsp;校对：<a href=\"https://github.com/wxy\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">wxy</a></p><p style=\"word-wrap: break-word; margin: 10px 0px; padding: 0px; line-height: 2em;\">本文由&nbsp;<a href=\"https://github.com/LCTT/TranslateProject\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">LCTT</a>&nbsp;原创翻译，<a href=\"https://linux.cn/article-6240-weibo.html\" style=\"word-wrap: break-word; color: rgb(247, 110, 110); text-decoration: none;\">Linux中国</a>&nbsp;荣誉推出</p><p class=\"copyright\" style=\"word-wrap: break-word; margin: 10px 0px; padding: 5px 10px; color: rgb(153, 153, 153); line-height: 2em; font-size: 12px; border: 1px solid rgb(238, 238, 238); border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; background-color: rgba(24, 241, 24, 0.0980392);\"><span class=\"z\" style=\"word-wrap: break-word; float: left;\">原文：<a href=\"http://ask.xmodulo.com/number-of-threads-process-linux.html\" target=\"_blank\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">http://ask.xmodulo.com/number-of-threads-process-linux.html</a></span><span class=\"y\" style=\"word-wrap: break-word; float: right; padding-left: 5px;\">作者： Dan Nanni</span><br class=\"clear\" style=\"word-wrap: break-word; clear: both;\"><span class=\"z\" style=\"word-wrap: break-word; float: left;\">译文：<a href=\"http://lctt.github.io/\" target=\"_blank\" class=\"ext\" rel=\"external nofollow\" style=\"word-wrap: break-word; color: rgb(77, 138, 216); text-decoration: none;\">LCTT</a>&nbsp;&nbsp;<a href=\"https://linux.cn/article-6240-1.html\" target=\"_blank\" style=\"word-wrap: break-word; color: rgb(247, 110, 110); text-decoration: none;\">https://linux.cn/article-6240-1.html</a></span><span class=\"y\" style=\"word-wrap: break-word; float: right; padding-left: 5px;\">译者： strugglingyouth</span></p></div></div>"
    }
  ]
}
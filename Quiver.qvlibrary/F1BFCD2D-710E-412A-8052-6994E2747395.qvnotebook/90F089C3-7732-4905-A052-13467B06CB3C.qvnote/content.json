{
  "title": "如何在 Linux 中搭建 FTP 服务",
  "cells": [
    {
      "type": "text",
      "data": "<embed id=\"xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd\" type=\"application/thunder_download_plugin\" height=\"0\" width=\"0\" style=\"color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;\"><span style=\"font-size: 14px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">在本教程中，我将会介绍如何搭建你自己的FTP服务。但是，首先我们应该来的学习一下FTP是什么。</span><h2 style=\"margin: 30px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 18px; font-family: 'microsoft yahei'; line-height: 25px;\">FTP是什么？</h2><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><a href=\"https://en.wikipedia.org/wiki/File_Transfer_Protocol\" target=\"_blank\" style=\"color: rgb(0, 136, 219); text-decoration: none; cursor: pointer;\">FTP</a>&nbsp;是文件传输协议（File Transfer Protocol）的缩写。顾名思义，FTP用于计算机之间通过网络进行文件传输。你可以通过FTP在计算机账户间进行文件传输，也可以在账户和桌面计算机之间传输文件，或者访问在线软件归档。但是，需要注意的是多数的FTP站点的使用率非常高，可能需要多次重连才能连接上。</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">FTP地址和HTTP地址（即网页地址）非常相似，只是FTP地址使用<a href=\"ftp://xn--http-fb5f58tb42bcr5b67b//\">ftp://前缀而不是http://</a></p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><img class=\"aligncenter\" src=\"quiver-image-url/6C62C6436B31EA19D8CC3EF5748010CC.jpg\" alt=\"如何在 linux 中搭建 FTP 服务\" style=\"margin: 0px auto; padding: 5px; border: 1px solid rgb(230, 230, 230); max-width: 628px; display: block; text-align: center;\" width=\"525\" height=\"300\"></p><h2 style=\"margin: 30px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 18px; font-family: 'microsoft yahei'; line-height: 25px;\">FTP服务器是什么？</h2><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">通常，拥有FTP地址的计算机是专用于接收FTP连接请求的。一台专用于接收FTP连接请求的计算机即为FTP服务器或者FTP站点。</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">现在，我们来开始一个特别的冒险，我们将会搭建一个FTP服务用于和家人、朋友进行文件共享。在本教程，我们将以<a href=\"https://security.appspot.com/vsftpd.html\" target=\"_blank\" style=\"color: rgb(0, 136, 219); text-decoration: none; cursor: pointer;\">vsftpd</a>作为ftp服务。</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">VSFTPD是一个自称为最安全的FTP服务端软件。事实上VSFTPD的前两个字母表示“非常安全的（very secure）”。该软件的构建绕开了FTP协议的漏洞。</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">尽管如此，你应该知道还有更安全的方法进行文件管理和传输，如：SFTP（使用<a href=\"http://www.openssh.com/\" target=\"_blank\" style=\"color: rgb(0, 136, 219); text-decoration: none; cursor: pointer;\">OpenSSH</a>）。FTP协议对于共享非敏感数据是非常有用和可靠的。</p><h3 style=\"margin: 0px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 14px; font-family: 'microsoft yahei'; line-height: 25px;\">使用 rpm 安装VSFTPD：</h3><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">你可以使用如下命令在命令行界面中快捷的安装VSFTPD：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">dnf -y install vsftpd</pre><h3 style=\"margin: 0px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 14px; font-family: 'microsoft yahei'; line-height: 25px;\">使用 deb 安装VSFTPD：</h3><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">你可以使用如下命令在命令行界面中快捷的安装VSFTPD：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">sudo apt-get install vsftpd</pre><h3 style=\"margin: 0px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 14px; font-family: 'microsoft yahei'; line-height: 25px;\">在Arch 中安装VSFTPD：</h3><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">你可以使用如下命令在命令行界面中快捷的安装VSFTPD：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">sudo apt-get install vsftpd</pre><h3 style=\"margin: 0px 0px 14px; padding: 0px 0px 5px; color: rgb(34, 34, 34); border-bottom-color: rgb(238, 238, 238); border-bottom-width: 1px; border-bottom-style: solid; font-size: 14px; font-family: 'microsoft yahei'; line-height: 25px;\">配置FTP服务</h3><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">多数的VSFTPD配置项都在/etc/vsftpd.conf配置文件中。这个文件本身已经有非常良好的文档说明了，因此，在本节中，我只强调一些你可能进行修改的重要选项。使用man页面查看所有可用的选项和基本的 文档说明：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">man vsftpd.conf</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">根据文件系统层级标准，FTP共享文件默认位于/srv/ftp目录中。</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><strong style=\"margin: 0px; padding: 0px;\">允许上传：</strong></p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">为了允许ftp用户可以修改文件系统的内容，如上传文件等，“write_enable”标志必须设置为 YES。</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">write_enable=YES</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><strong style=\"margin: 0px; padding: 0px;\">允许本地（系统）用户登录：</strong></p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">为了允许文件/etc/passwd中记录的用户可以登录ftp服务，“local_enable”标记必须设置为YES。</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">local_enable=YES</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><strong style=\"margin: 0px; padding: 0px;\">匿名用户登录</strong></p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">下面配置内容控制匿名用户是否允许登录：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\"># 允许匿名用户登录\nanonymous_enable=YES\n# 匿名登录不需要密码（可选）\nno_anon_password=YES\n# 匿名登录的最大传输速率，Bytes/second（可选）\nanon_max_rate=30000\n# 匿名登录的目录（可选）\nanon_root=/example/directory/</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\"><strong style=\"margin: 0px; padding: 0px;\">根目录限制（Chroot Jail）</strong></p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">（ LCTT 译注：chroot jail是类unix系统中的一种安全机制，用于修改进程运行的根目录环境，限制该线程不能感知到其根目录树以外的其他目录结构和文件的存在。详情参看<a href=\"https://zh.wikipedia.org/wiki/Chroot\" target=\"_blank\" style=\"color: rgb(0, 136, 219); text-decoration: none; cursor: pointer;\">chroot jail</a>）</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">有时我们需要设置根目录（chroot）环境来禁止用户离开他们的家（home）目录。在配置文件中增加/修改下面配置开启根目录限制（Chroot Jail）:</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">chroot_list_enable=YES \nchroot_list_file=/etc/vsftpd.chroot_list</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">“chroot_list_file”变量指定根目录限制所包含的文件/目录（ LCTT 译注：即用户只能访问这些文件/目录）</p><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">最后你必须重启ftp服务，在命令行中输入以下命令：</p><pre style=\"margin: 15px auto; padding: 10px 15px; word-break: break-all; font-size: 12px; line-height: 20px; font-family: 'courier new'; border-width: 1px 1px 1px 4px; border-style: solid; border-color: rgb(221, 221, 221); background-color: rgb(251, 251, 251); color: rgb(68, 68, 68);\">sudo systemctl restart vsftpd</pre><p style=\"font-size: 14px; margin: 0px 0px 15px; padding: 0px; color: rgb(68, 68, 68); font-family: 'microsoft yahei'; line-height: 25px;\">到此为止，你的ftp服务已经搭建完成并且启动了。</p>"
    }
  ]
}
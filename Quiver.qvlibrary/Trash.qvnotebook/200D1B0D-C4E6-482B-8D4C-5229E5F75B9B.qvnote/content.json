{
  "title": "Untitled Note",
  "cells": [
    {
      "type": "text",
      "data": "D:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\n/*\nclass.cpp\n1、从文本文件中导入班级学生信息：学号、姓名、性别、籍贯\n2、将学号重复的删除\n3、显示导入的学生信息\n4、按学号、姓名、性别、籍贯相等和不相等查找\n5、多次查找\n6、查找结果写入文件\n7、VC++6.0编译通过\n******************\n文件尾部有class.txt 班级信息\n*/\n#include <stdio.h>\n#include <malloc.h>\n#include <conio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <math.h>\n#define CLRSCR system(\"cls\")\n#define PRINT_TITLE \"\\n序号\\t学号\\t\\t姓名\\t性别 \\t籍贯\\n\"\n#define PRINT_FORMAT\n\"%d\\t%s\\t%s\\t%s\\t%s\\n\",i,p-&gt;stu.num,p-&gt;stu.name,p-&gt;stu.sex,p-&gt;stu.hometown\n#define WRITE_FORMAT\n\"%s\\t%s\\t%s\\t%s\\n\",p-&gt;stu.num,p-&gt;stu.name,p-&gt;stu.sex,p-&gt;stu.hometown\n#define READ_FORMAT \"%s %s %s %s\",&amp;p-&gt;stu.num,&amp;p-&gt;stu.name,&amp;p-&gt;stu.sex,&amp;p-&gt;stu.hometown\n//定义学生结构体\nstruct student\n{\nchar num[9];\nchar name[7];\n//三个汉字长度为6个字节，如果不多定义一个字节来存放字符串结束符'\\0'，当输出name时会\n把sex和hometown也输出\nchar sex[3];\nchar hometown[7];\n};\n//定义单链表结点\ntypedef struct listnode\n{\nstruct student stu;\nstruct listnode *next;\n}node;\nint MySelect(node * head,node *temp) //返回查找到符合条件的项目数\n{\nint equal,N;\n-1-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\nchar CHAR[10];\nprintf(\"----------------------------------------------\\n\\n\");\nprintf(\"查找模式:1是相等查找,0是不相等查找\\n\");\nprintf(\"列名编号:1是学号,2是姓名,3是性别,4是籍贯\\n\");\nprintf(\"\\n--------------------------------------------\\n\");\ndo\n{\nprintf(\"\\n选择查找模式:\");//用scanf时输入字母会错误 改用getche，不用scanf\nequal=getche();\nif((equal!='1')&amp;&amp;(equal!='0'))\nprintf(\"\\n\\t输入错误\\n\");\n}\nwhile((equal!='1')&amp;&amp;(equal!='0'));\nequal=equal-48;\ndo\n{\nprintf(\"\\n输入列名编号:\");\nN=getche();\nif(N!='1'&amp;&amp;N!='2'&amp;&amp;N!='3'&amp;&amp;N!='4')\nprintf(\"\\n\\t输入错误\\n\");\n}\nwhile(N!='1'&amp;&amp;N!='2'&amp;&amp;N!='3'&amp;&amp;N!='4');\nswitch(N)\n{\ncase '1': N=0;break;\ncase '2': N=9;break;\ncase '3': N=16;break;\ncase '4': N=19;break;\n}\nprintf(\"\\n输入关键字:\");\nscanf(\"%s\",CHAR);\nint i=0,flag;\nnode *p,*tp=temp;\np=head-&gt;next;\nwhile (NULL!=p)\n{\nflag=strcmp((char *)p+N,CHAR);\nif((abs(flag)+equal)==1)//当equal为1时是相等查找,为0时是不相等查找\n{\nnode *end;\nend = (node *)malloc(sizeof(node));\ntp-&gt;next=end;\ntp=end;\n-2-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\ntp-&gt;next=NULL;\ntp-&gt;stu=p-&gt;stu;\nif(i==0)\nprintf (PRINT_TITLE);\ni++;\nprintf(PRINT_FORMAT);\n}\np=p-&gt;next;\n}\nif(i==0)\nprintf(\"\\n\\t没有查找到符合条件的信息\\n\");\nreturn i;\n}\nvoid InsertSort(node *head)//学号从小到大排序\n{\nnode *p,*q,*r,*u;\np=head-&gt;next;\nhead-&gt;next=NULL;\nwhile(p!=NULL)\n{\nr=head;\nq=head-&gt;next;\nwhile(q!=NULL&amp;&amp; strcmp(q-&gt;stu.num,p-&gt;stu.num)&lt;0) //成立则基点向后移\n{\nr=q;\nq=q-&gt;next;\n}\nu=p-&gt;next;\np-&gt;next=r-&gt;next; //p-&gt;stu.num比q-&gt;stu.num小，放到q-&gt;stu.num前面\nr-&gt;next=p;\np=u;//下一上节点与基点进行比较\n}\n}\nvoid CheckNum(node *head)\n{\n/*删除学号重复的条目*/\nnode *release,*p;\np=head-&gt;next;\nint m=0;\nwhile(NULL!=p-&gt;next)\n-3-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\n{\nnode *p2=p;\nwhile(NULL!=p2-&gt;next)\n{\nif(0==strcmp(p-&gt;stu.num,p2-&gt;next-&gt;stu.num))\n{ m++;\nif(m==1)\nprintf(\"\\t\\t以下条目因学号与前面的信息冲突而没有导入\\n\");\nprintf (\"%d\\t%s\\t%s\\t%s\\t%s\\n\",m,p2-&gt;next-&gt;stu.num,p2-&gt;next-&gt;stu.\nname,\\\np2-&gt;next-&gt;stu.sex,p2-&gt;next-&gt;stu.hometown);\nrelease=p2-&gt;next;\np2-&gt;next=p2-&gt;next-&gt;next;\nfree(release);\n}\np2=p2-&gt;next;\n}\np=p-&gt;next;\n}\n}\nvoid FscanfFromFile(node *head)\n{\nchar file[15];\nprintf(\"输入待导入的文件名:\");\nscanf(\"%s\",file);\nFILE *fp;\nif((fp=fopen(file,\"r\"))==NULL)\n{\nprintf(\"\\n\\t文件打开失败，按任意键退出\\n\");\ngetch();\nexit(0);\n}\nnode *p=head;\nwhile(!feof(fp))\n{\nnode *end;\nend = (node *)malloc(sizeof(node));\np-&gt;next=end;\np=end;\np-&gt;next=NULL;\nfscanf(fp,READ_FORMAT);\n-4-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\n}\nprintf(\"\\n\\t信息导入成功\\n\");\nfclose(fp);\nvoid CheckNum(node *head);\nvoid InsertSort(node *head);\nCheckNum(head);\nInsertSort(head);\n}\nvoid ShowList(node *head)//带头结点的链表\n{\nnode *p=head-&gt;next;\nint i=0;\nprintf (PRINT_TITLE);\nwhile(NULL!=p )//*****************NULL!=p 不是NULL!=p-&gt;next\n{ i++;\nprintf (PRINT_FORMAT);\np=p-&gt;next;\n}\n}\nvoid FprintfToFile(node *head)\n{\nchar file[15];\nprintf(\"\\n输入要写入的文件名:\");\nscanf(\"%s\",file);\nFILE *fp;\nif((fp=fopen(file,\"w+\"))==NULL)\n{\nprintf(\"\\n\\t文件创建失败\\n\");\nexit(0);\n}\nnode *p=head-&gt;next;\nwhile(NULL!=p)\n{\nif(p-&gt;next==NULL)//不要最后一行的回车，这样的话导入该文件时就不会有末尾的乱码\nfprintf(fp,\"%s\\t%s\\t%s\\t%s\",p-&gt;stu.num,p-&gt;stu.name,p-&gt;stu.sex,p-&gt;stu.\nhometown);\nelse\nfprintf(fp,WRITE_FORMAT);\np=p-&gt;next;\n}\nfclose(fp);\nprintf(\"\\n\\t数据写入成功\\n\",file);//printf输出双引号要用转义字\\\"\n}\n-5-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\nnode *ClearList(node *head)\n{\nnode *p=head-&gt;next;\nwhile(NULL!=p)\n{\nnode *tp=p-&gt;next;\nfree(p);\np=tp;\n}\nreturn head-&gt;next=NULL;\n}\nint AddStu(node *head)\n{\nnode *p,*p2=head,*p3;\np=(node *)malloc(sizeof(node));\nprintf(\"依次输入学生的学号、姓名、性别和籍贯（用空格隔开）：\\n\");\nscanf(\"%s %s %s %s\",p-&gt;stu.num,p-&gt;stu.name,p-&gt;stu.sex,p-&gt;stu.hometown);\nint flag=0;\nwhile(NULL!=p2-&gt;next)\n{ /*找出第一个比新学生的学号大的位置，将新信息放在它前面*/\nif((flag=strcmp(p-&gt;stu.num,p2-&gt;next-&gt;stu.num))&lt;0)\n{\np3=p2-&gt;next;\np2-&gt;next=p;\np-&gt;next=p3;\nbreak;//*******\n}\np2=p2-&gt;next;\n}\n/*如果新添加学生的学号比已有的都大，放置最末尾*/\nif(flag&gt;0)\n{\np2-&gt;next=p;\np-&gt;next=NULL;\n}\nvoid CheckNum(node *head);\nCheckNum(head);\nprintf(\"信息添加成功\\n\");\nprintf(\"\\t按任意键返回\\n\");\ngetche();\nreturn 1;\n}\n-6-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\nint DeleteByNum(node *head)\n{ char num[9];\nint flag=1;\nnode *p=head,*p2;\nprintf(\"输入要删除信息的学号：\");\nscanf(\"%s\",num);\nwhile(NULL!=p-&gt;next)\n{\nif((flag=strcmp(p-&gt;next-&gt;stu.num,num))==0)\n{\np2=p-&gt;next;\np-&gt;next=p-&gt;next-&gt;next;\nfree(p2);\nprintf(\"删除成功\\n\");\nbreak;//***************\n}\np=p-&gt;next;\n}\nif(flag!=0)\nprintf(\"你输入的学号不存在\\n\");\nprintf(\"\\t按任意键返回\\n\");\ngetche();\nreturn 1;\n}\nint main()\n{\nnode *head;\nint i=0;\nhead = (node *)malloc(sizeof(node));\nstrcpy(head-&gt;stu.num,\" \");\nstrcpy(head-&gt;stu.hometown,\" \");\nstrcpy(head-&gt;stu.name,\" \");\nstrcpy(head-&gt;stu.sex,\" \");\nnode *temp= (node *)malloc(sizeof(node));//保存查找结果的头结点\nprintf(\"欢迎使用\\n\");\nprintf(\"\\n----------------------------------------------\\n\");\nFscanfFromFile(head);\n-7-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\nchar charget;\ndo\n{\nprintf(\"\\n----------------------------------------------\\n\");\nprintf(\"\\n[1]信息显示\\n\");\nprintf(\"[2]信息查找\\n\");\nprintf(\"[3]添加信息\\n\");\nprintf(\"[4]删除信息\\n\");\nprintf(\"[5]退出程序\\n\");\ndo\n{\ncharget=getch();\n}\nwhile((charget!='1')&amp;&amp;(charget!='2')&amp;&amp;(charget!='3')&amp;&amp;(charget!='4')&amp;&amp;(charget\n!='5'));\nswitch(charget)\n{\ncase '1': ShowList(head);\nprintf(\"\\n按任意键显示上层操作菜单\\n\");\ngetch();\nbreak;\ncase '2': if(0!=MySelect(head,temp))\n//查找结束不为空则进行下面的操作，为空则返回上层菜单\n{\nchar charget2;\ndo\n{\nprintf(\"\\n[1]在此基础上继续查找\\n\");\nprintf(\"[2]将查找结果写入文件\\n\");\nprintf(\"[3]退出本次查找\\n\");\ndo\n{\ncharget2=getch();\n}\nwhile((charget2!='1')&amp;&amp;(charget2!='2')&amp;&amp;(charget2!='3'));\nswitch(charget2)\n{\ncase '1': if(0==MySelect(temp,temp))\n{\nprintf(\"\\n按任意键结束本次查找\\n\");\ngetch();\ncharget2='3';\n}\nbreak;\ncase '2': FprintfToFile(temp);\ncharget2='3';//数据写入后，自动结束本次查找\n-8-\nD:\\TDDOWNLOAD\\myclass2\\class.cpp 2011年12月7日 16:03\nbreak;\ncase '3': ClearList(temp);\n//结束查找，释放暂存查找结果的链表\nbreak;\n}//end switch，结束本次查找\n}\nwhile(charget2!='3');\n//如果charget2也用charget的话，在查找中按键3会直接退出程序\n}//end if\nbreak;\ncase '3': AddStu(head);break;\ncase '4': DeleteByNum(head);break;\n}//end switch，结束操作\n}\nwhile(charget!='5');\nreturn 0;\n}\n/*\nclass.txt\n*/\n20054879 耿同学 男 江西\n20057502 王同学 男 北京\n20057508 肖同学 男 北京\n20057524 王同学 男 北京\n20057554 谢同学 男 北京\n20067049 李同学 女 北京\n20067054 王同学 男 北京\n20067055 张同学 男 北京\n20067061 刘同学 男 北京\n20067049 杨同学 女 北京\n20051020 赵同学 男 北京\n20051080 周同学 女 北京\n20051262 吴同学 女 北京\n20052672 徐同学 女 北京\n20052993 孙同学 女 黑龙江\n20053728 朱同学 男 北京\n-9-\nD\n:\n\\\nTDDOW\nNLO\nA\nD\n\\\nm\ny\nc\nlass2\n\\\nc\nlass\n.\ncpp 2011\n年12\n月\n7\n日 16\n:03\n20054864 马同\n学\n女 北京\n20054865 胡同\n学\n女 甘肃\n20054866 郭同\n学\n女 广东\n20054867 林同\n学\n女 广西\n20054868 何同\n学\n女 陕西\n20054869 高同\n学\n女 北京\n20054870 梁同\n学\n女 北京\n20054871 郑同\n学\n女 北京\n20054872 罗同\n学\n女 北京\n20054873 宋同\n学\n女 北京\n20054874 谢同\n学 男 福\n建\n20054876 唐同\n学\n男 黑龙江\n20054877 韩同\n学\n男 湖北\n20054878 曹同\n学\n男 湖南\n20054879 许同\n学\n男 江西\n20054880 邓同\n学\n男 辽宁\n20054881 傅同\n学\n男 宁夏\n20054882 馮同\n学\n男 山东\n20054883 曾同\n学\n男 北京\n20054884\n程\n同\n学\n男 北京\n20054885 蔡同\n学\n男 北京\n20054886 彭同\n学\n男 北京\n20054887 藩同\n学\n男 北京\n20054888 袁同\n学\n男 北京\n20054889 于同\n学\n男 北京\n20054890 董同\n学\n男 北京\n20054891 余同\n学\n男 北京\n20054892 苏同\n学\n男 北京\n20054893 叶同\n学\n男 北京\n20054894 吕同\n学\n男 北京\n20054895 魏同\n学\n男 北京\n20054896 蒋同\n学\n男 北京\n20054897 田同\n学\n男 北京\n20054898 杜同\n学\n男 北京\n20054899 丁同\n学\n男 天津\n20054900 沈同\n学\n男 浙江\n20055235 姜同\n学\n男 北京\n20055658 唐同\n学\n男 北京\n20056057 王同\n学\n女 北京\n20056060 穆同\n学\n男 北京\n20056098 陈同\n学\n女 北京\n20056101 王同\n学\n女 北京\n20056120 黄同\n学\n女 北京\n20057391 魏同\n学\n男 北京\n20057499 丁同\n学\n男 北京\n-10-</math.h></string.h></stdlib.h></conio.h></malloc.h></stdio.h>"
    }
  ]
}